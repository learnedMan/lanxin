(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-028e037a"],{"10a6":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"radioTV",staticStyle:{padding:"30px"}},[a("el-form",[a("el-form-item",{attrs:{label:"所属产品："}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.product_id,callback:function(t){e.product_id=t},expression:"product_id"}},e._l(e.productList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"电视频道",name:"page_a"}},[a("pagea",{attrs:{productId:e.product_id,productList:e.productList}})],1),a("el-tab-pane",{attrs:{label:"电视直播",name:"page_b"}},[a("pageb",{ref:"page_b",attrs:{productId:e.product_id}})],1),a("el-tab-pane",{attrs:{label:"电视点播",name:"page_c"}},[a("pagec",{ref:"page_c",attrs:{productId:e.product_id}})],1),a("el-tab-pane",{attrs:{label:"广播频道",name:"page_d"}},[a("paged",{attrs:{productId:e.product_id,productList:e.productList}})],1),a("el-tab-pane",{attrs:{label:"广播直播",name:"page_e"}},[a("pagee",{ref:"page_e",attrs:{productId:e.product_id}})],1),a("el-tab-pane",{attrs:{label:"广播点播",name:"page_f"}},[a("pagef",{ref:"page_f",attrs:{productId:e.product_id}})],1)],1)],1)},s=[],l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_a"},[a("el-form",{ref:"queryForm",attrs:{model:e.queryParams,inline:!0}},[a("el-form-item",[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:e.adddata}},[e._v("新增")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},border:"",data:e.dataList}},[a("el-table-column",{attrs:{label:"ID",align:"center",prop:"id"}}),a("el-table-column",{attrs:{label:"频道logo",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{staticStyle:{"max-height":"50px","max-width":"50px"},attrs:{src:e.row.extra.logo}})]}}])}),a("el-table-column",{attrs:{label:"频道名称",align:"center",prop:"name","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"权重",align:"center",prop:"sort","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"频道状态",align:"center",prop:"status","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(a){return e.statuschange(t.row)}},model:{value:t.row.status,callback:function(a){e.$set(t.row,"status",a)},expression:"scope.row.status"}},e._l(e.statusoptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)]}}])}),a("el-table-column",{attrs:{label:"模板状态",align:"center",prop:"extra.template.type||'未启用'","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("formattemplate")(t.row.extra.template)))])]}}])}),a("el-table-column",{attrs:{label:"节目模板",align:"center",prop:"en_name","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{size:"mini",type:"primary"},on:{click:function(a){return e.program(t.row)}}},[e._v("模板管理")])]}}])}),a("el-table-column",{attrs:{label:"创建时间",align:"center",prop:"created_at","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{width:"150px",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("Iconbutton",{attrs:{icontype:"xg",label:"修改"},on:{fatherMethod:function(a){return e.editdata(t.row)}}}),a("Iconbutton",{attrs:{icontype:"sc",label:"删除"},on:{fatherMethod:function(a){return e.deldata(t.row)}}})]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.page,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"page",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}}),a("el-dialog",{attrs:{width:"700px","close-on-click-modal":!1,title:e.dialogTitle,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"dataForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{"label-width":"120px",label:"频道名称",prop:"name"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{autocomplete:"off",placeholder:"请输入频道名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"权重",prop:"sort"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{autocomplete:"off",placeholder:"请输入权重(排序)"},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"所属产品",prop:"product_id"}},[a("el-select",{attrs:{disabled:"edit"==e.dialogType,placeholder:"请选择"},model:{value:e.form.product_id,callback:function(t){e.$set(e.form,"product_id",t)},expression:"form.product_id"}},e._l(e.productList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{"label-width":"120px",label:"频道LOGO：",prop:"extra.logo"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.VUE_APP_BASE_API+"/api/upload/image",headers:e.importHeaders,name:"image","show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.form.extra.logo?a("img",{staticClass:"avatar",attrs:{src:e.form.extra.logo}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{attrs:{"label-width":"120px",label:"适用于",prop:"forway"}},[a("el-checkbox-group",{on:{change:function(t){return e.$forceUpdate()}},model:{value:e.form.forway,callback:function(t){e.$set(e.form,"forway",t)},expression:"form.forway"}},[a("el-checkbox",{attrs:{label:"直播"}}),a("el-checkbox",{attrs:{label:"点播"}})],1)],1),e.form.forway.indexOf("直播")>-1?a("el-form-item",{attrs:{"label-width":"120px",label:"流地址"}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入内容"},model:{value:e.form.extra.stream_urls[0].url,callback:function(t){e.$set(e.form.extra.stream_urls[0],"url",t)},expression:"form.extra.stream_urls[0].url"}},[a("template",{slot:"prepend"},[e._v("超清")])],2),a("el-input",{staticStyle:{width:"400px",margin:"15px 0"},attrs:{placeholder:"请输入内容"},model:{value:e.form.extra.stream_urls[1].url,callback:function(t){e.$set(e.form.extra.stream_urls[1],"url",t)},expression:"form.extra.stream_urls[1].url"}},[a("template",{slot:"prepend"},[e._v("高清")])],2),a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入内容"},model:{value:e.form.extra.stream_urls[2].url,callback:function(t){e.$set(e.form.extra.stream_urls[2],"url",t)},expression:"form.extra.stream_urls[2].url"}},[a("template",{slot:"prepend"},[e._v("标清")])],2)],1):e._e(),a("el-form-item",{attrs:{"label-width":"120px",label:"简介",prop:"extra.intro"}},[a("el-input",{staticStyle:{width:"400px"},attrs:{autosize:{minRows:4},type:"textarea",autocomplete:"off",placeholder:"请输入简介"},model:{value:e.form.extra.intro,callback:function(t){e.$set(e.form.extra,"intro",t)},expression:"form.extra.intro"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"是否启用",prop:"status"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},e._l(e.statusoptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:e.closeDialog}},[e._v("取 消")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:e.enterDialog}},[e._v("确 定")])],1)],1),a("Pagedialog",{ref:"Pagedialog"})],1)},r=[],o=a("8955"),n=(a("513c"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_a_dialog"},[e.dialogFormVisible?a("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.importLoading,expression:"importLoading"}],attrs:{width:"1200px","show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1,visible:e.dialogFormVisible,"element-loading-text":"模板导入中..."},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("span",{staticClass:"el-dialog__title",attrs:{slot:"title"},slot:"title"},[a("span",[e._v("编辑节目单模板")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],staticStyle:{"margin-left":"20px"},attrs:{type:"primary",size:"small"},on:{click:e.downProgramme}},[e._v("下载节目单模板")]),a("el-upload",{staticClass:"upload-demo",attrs:{name:"excel",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-exce",action:e.actionUrl,data:e.actionData,headers:e.uploadHeader,"on-success":e.handleAvatarSuccess,"on-error":e.handleAvatarError,"before-upload":e.beforeAvatarUpload,"show-file-list":!1}},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{size:"small",type:"primary"}},[e._v("导入模板")])],1)],1),a("el-dialog",{attrs:{width:"540px",title:e.dialogTitle,"show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1,visible:e.innerVisible,"append-to-body":""},on:{"update:visible":function(t){e.innerVisible=t}}},[a("el-form",{ref:"dataForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{"label-width":"120px",label:"节目名称:",prop:"name"}},[a("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"请输入节目名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"开始时间:",prop:"time"}},[a("el-time-picker",{attrs:{"value-format":"HH:mm:ss",placeholder:"请选择时间"},model:{value:e.form.time,callback:function(t){e.$set(e.form,"time",t)},expression:"form.time"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"是否允许回看:",prop:"extra.allow_replay"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.extra.allow_replay,callback:function(t){e.$set(e.form.extra,"allow_replay",t)},expression:"form.extra.allow_replay"}},e._l(e.statusoptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:e.innercloseDialog}},[e._v("取 消")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:e.innerenterDialog}},[e._v("确 定")])],1)],1),a("span",[e._v("直播节日模板：")]),a("el-radio-group",{on:{change:e.chooseradio},model:{value:e.data.extra.template.type,callback:function(t){e.$set(e.data.extra.template,"type",t)},expression:"data.extra.template.type"}},[a("el-radio",{attrs:{label:"daily"}},[e._v("每日重复(创建单日节目单模板，每日重复)")]),a("el-radio",{attrs:{label:"weekly"}},[e._v("每周重复(创建周一至周日节目单模板，每周循环)")]),a("el-radio",{attrs:{label:"none"}},[e._v("不启用模板")])],1),a("div",{staticStyle:{"min-height":"500px"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:"daily"==e.data.extra.template.type||"weekly"==e.data.extra.template.type,expression:"data.extra.template.type=='daily'||data.extra.template.type=='weekly'"}],staticStyle:{"margin-top":"30px",display:"flex"}},[a("el-tabs",{directives:[{name:"show",rawName:"v-show",value:"weekly"==e.data.extra.template.type,expression:"data.extra.template.type=='weekly'"}],staticClass:"left",staticStyle:{height:"500px","margin-right":"10px",width:"100px"},attrs:{"tab-position":"left"},on:{"tab-click":e.changeweek},model:{value:e.weekday,callback:function(t){e.weekday=t},expression:"weekday"}},[a("el-tab-pane",{attrs:{label:"周一",name:"1"}}),a("el-tab-pane",{attrs:{label:"周二",name:"2"}}),a("el-tab-pane",{attrs:{label:"周三",name:"3"}}),a("el-tab-pane",{attrs:{label:"周四",name:"4"}}),a("el-tab-pane",{attrs:{label:"周五",name:"5"}}),a("el-tab-pane",{attrs:{label:"周六",name:"6"}}),a("el-tab-pane",{attrs:{label:"周日",name:"7"}})],1),a("div",{staticClass:"right",staticStyle:{"flex-grow":"1"}},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],staticStyle:{"margin-bottom":"20px"},attrs:{type:"primary",size:"mini"},on:{click:e.adddata}},[e._v("新增")]),e.tableflag?a("el-table",{attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},border:"",data:e.dataList}},[a("el-table-column",{attrs:{label:"节目名称",align:"center",prop:"name","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"开始时间",align:"center",prop:"time","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"播放时长",align:"center",prop:"extra.duration","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"允许回看",align:"center","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("formatallow_replay")(t.row.extra.allow_replay))+" ")]}}],null,!1,1769245459)}),a("el-table-column",{attrs:{width:"150px",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("Iconbutton",{attrs:{icontype:"xg",label:"修改"},on:{fatherMethod:function(a){return e.editdata(t)}}}),a("Iconbutton",{attrs:{icontype:"sc",label:"删除"},on:{fatherMethod:function(a){return e.deldata(t)}}})]}}],null,!1,593115993)})],1):e._e()],1)],1)]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:e.closeDialog}},[e._v("取 消")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:e.enterDialog}},[e._v("确 定")])],1)],1):e._e()],1)}),c=[],d=(a("053b"),a("ea69"),a("08d5"),a("0fea")),p=a("61f7"),u={name:"page_a_dialog",data:function(){return{dialogFormVisible:!1,innerVisible:!1,dialogTitle:"",form:{},rules:{time:[{required:!0,message:"请选择时间",trigger:"blur"}],"extra.allow_replay":[{required:!0,message:"请选择是否允许回看",trigger:"blur"}]},dialogType:"add",editIndex:"",dataList:[],dayList:[],weekList:{},tableflag:!0,weekday:"1",statusoptions:[{value:1,label:"是"},{value:2,label:"否"}],data:"",importLoading:!1}},filters:{formatallow_replay:function(e){return 1==e?"是":"否"}},created:function(){this.initForm()},computed:{actionUrl:function(){return this.xlsxUrl},uploadHeader:function(){var e=sessionStorage.getItem("token"),t=sessionStorage.getItem("TempZone")||"",a=sessionStorage.getItem("TempSite")||"";return{Authorization:e,TempZone:t,TempSite:a}},actionData:function(e){var t=e.data,a=void 0===t?{}:t;return{channel_id:a.id}}},methods:{getdata:function(e){this.data=JSON.parse(JSON.stringify(e))},changeweek:function(e,t){this.returndataList()},closeDialog:function(){this.dialogFormVisible=!1},enterDialog:function(){var e=this;if("weekly"!=this.data.extra.template.type||this.weekList["1"]&&this.weekList["1"].length>0&&this.weekList["2"]&&this.weekList["2"].length>0&&this.weekList["3"]&&this.weekList["3"].length>0&&this.weekList["4"]&&this.weekList["4"].length>0&&this.weekList["5"]&&this.weekList["5"].length>0&&this.weekList["6"]&&this.weekList["6"].length>0&&this.weekList["7"]&&this.weekList["7"].length>0){this.data.father=this.data.father.id;var t={list:{daily:[],weekly:{}},type:""};t.list.daily=this.dayList,t.list.weekly=this.weekList,t.type=this.data.extra.template.type,this.data.extra.template=t,Object(d["pb"])(this.data.id,this.data).then((function(t){e.$message({message:"修改成功",type:"success"}),e.dialogFormVisible=!1,e.$parent.getList(),e.weekday="1"}))}else this.$message({message:"选择每周重复，请保证每天至少有一个节目",type:"warning"})},initForm:function(){this.$refs.dataForm&&this.$refs.dataForm.resetFields(),this.form={name:"",time:"",extra:{duration:"",allow_replay:1}}},adddata:function(){this.initForm(),this.innerVisible=!0,this.dialogTitle="新增节目",this.dialogType="add"},editdata:function(e){this.initForm(),this.editIndex=e.$index,this.form=JSON.parse(JSON.stringify(e.row)),this.innerVisible=!0,this.dialogTitle="修改节目",this.dialogType="edit"},deldata:function(e){var t=this,a=e.row;this.editIndex=e.$index,this.$confirm("此操作将永久删除节目名称为"+a.name+"的节目, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){"daily"==t.data.extra.template.type?(t.dayList.splice(t.editIndex,1),t.datalistformat(t.dayList),t.dataList=t.dayList,t.innerVisible=!1,t.$message({message:"删除成功",type:"success"})):"weekly"==t.data.extra.template.type&&(t.weekList[t.weekday].splice(t.editIndex,1),t.datalistformat(t.weekList[t.weekday]),t.dataList=t.weekList[t.weekday],t.innerVisible=!1,t.$message({message:"删除成功",type:"success"}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},innercloseDialog:function(){this.innerVisible=!1},returntime:function(e,t){function a(e){return e<10?"0"+e:e}var i="1970/1/1 ",s=(e=e||"09:01:22",t=t||"22:22:22",new Date(i+e)),l=new Date(i+t),r=parseInt((l.getTime()-s.getTime())/1e3);Math.floor(r/86400/365);r%=31536e3;Math.floor(r/86400/30);r%=2592e3;Math.floor(r/86400);r%=86400;var o=Math.floor(r/3600);r%=3600;var n=Math.floor(r/60);r%=60;var c=r;return a(o)+":"+a(n)+":"+a(c)},datalistformat:function(e){e.sort((function(e,t){return t.time<e.time?1:-1}));for(var t=0;t<e.length;t++)t<e.length-1?e[t].extra.duration=this.returntime(e[t].time,e[t+1].time):e[t].extra.duration=this.returntime(e[t].time,"24:00:00");return e},innerenterDialog:function(){var e=this;this.$refs["dataForm"].validate((function(t){if(t){var a=JSON.parse(JSON.stringify(e.form));if("edit"==e.dialogType){if("daily"==e.data.extra.template.type){for(var i=0;i<e.dayList.length;i++)if(a.time==e.dayList[i].time&&i!=e.editIndex)return void e.$message({message:"开始时间重复，请修改",type:"warning"});e.dayList.splice(e.editIndex,1,a),e.datalistformat(e.dayList),e.dataList=e.dayList,e.innerVisible=!1}else if("weekly"==e.data.extra.template.type){for(i=0;i<e.weekList[e.weekday].length;i++)if(a.time==e.weekList[e.weekday][i].time&&i!=e.editIndex)return void e.$message({message:"开始时间重复，请修改",type:"warning"});e.weekList[e.weekday].splice(e.editIndex,1,a),e.datalistformat(e.weekList[e.weekday]),e.dataList=e.weekList[e.weekday],e.innerVisible=!1}}else if("daily"==e.data.extra.template.type){for(i=0;i<e.dayList.length;i++)if(a.time==e.dayList[i].time)return void e.$message({message:"开始时间重复，请修改",type:"warning"});e.dayList.push(a),e.datalistformat(e.dayList),e.dataList=e.dayList,e.innerVisible=!1}else if("weekly"==e.data.extra.template.type){if(Object(p["a"])(e.weekList[e.weekday])){for(i=0;i<e.weekList[e.weekday].length;i++)if(a.time==e.weekList[e.weekday][i].time)return void e.$message({message:"开始时间重复，请修改",type:"warning"});e.weekList[e.weekday].push(a)}else e.weekList[e.weekday]=[],e.weekList[e.weekday].push(a);e.datalistformat(e.weekList[e.weekday]),e.dataList=e.weekList[e.weekday],e.innerVisible=!1}}}))},chooseradio:function(){var e=this;this.tableflag=!1,this.$nextTick((function(){e.tableflag=!0})),this.returndataList()},returndataList:function(){if(this.dataList=[],!this.data.extra.template){var e={list:{daily:[],weekly:{}},type:"none"};this.data.extra.template=e}"daily"==this.data.extra.template.type?(this.dayList=this.data.extra.template.list.daily,this.dataList=this.dayList):"weekly"==this.data.extra.template.type?(this.weekList=this.data.extra.template.list.weekly,this.weekList||(this.weekList={},this.weekList[this.weekday]=[]),this.dataList=this.weekList[this.weekday]):this.dataList=[]},downProgramme:function(){var e=location.origin;window.location.href="".concat(e,"/api/channels/downloadProgramTemplate")},beforeAvatarUpload:function(){this.importLoading=!0},handleAvatarSuccess:function(e){e.status_code>=200&&e.status_code<300?(this.$message.success("导入成功!"),this.$parent.getList(),this.dialogFormVisible=!1):this.$message.error("导入失败!"),this.importLoading=!1},handleAvatarError:function(e){this.$message.error("导入失败, 服务故障!"),this.importLoading=!1}}},m=u,f=(a("10c1"),a("6b2c"),a("cba8")),h=Object(f["a"])(m,n,c,!1,null,"f7240c3c",null),g=h.exports,b={components:{Pagedialog:g},props:{productId:{type:Number,default:0},productList:{type:Array,default:[]}},name:"page_a",data:function(){var e,t=sessionStorage.getItem("token");return{importHeaders:{Authorization:t},queryParams:{page:1,pageSize:10,product_id:0,type:"tv_channel"},loading:!0,dataList:[],total:0,statusoptions:[{value:1,label:"启用"},{value:2,label:"禁用"}],dialogFormVisible:!1,form:{},rules:(e={name:[{required:!0,message:"请输入频道姓名",trigger:"blur"}],sort:[{required:!0,message:"请输入权重(排序)",trigger:"blur"}],product_id:[{required:!0,message:"请选择所属产品",trigger:"blur"}]},Object(o["a"])(e,"extra.logo",[{required:!0,message:"请选择频道logo",trigger:"blur"}]),Object(o["a"])(e,"forway",[{required:!0,message:"请选择适用场景",trigger:"blur"}]),Object(o["a"])(e,"status",[{required:!0,message:"请选择是否启用",trigger:"blur"}]),e),dialogType:"add",dialogTitle:""}},filters:{formattemplate:function(e){return e?"daily"==e.type?"每日循环":"weekly"==e.type?"每周循环":"未启用":"未启用"}},computed:{VUE_APP_BASE_API:function(){return this.imgurl2}},watch:{productId:function(e){this.queryParams.product_id=e,this.getList()}},created:function(){this.initForm()},methods:{program:function(e){this.$refs.Pagedialog.getdata(e),this.$refs.Pagedialog.dialogFormVisible=!0,this.$refs.Pagedialog.returndataList()},handleAvatarSuccess:function(e,t,a){this.form.extra.logo=e.path,this.$forceUpdate()},beforeAvatarUpload:function(e){var t=e.size/1024/1024<20;return t||this.$message.error("上传头像图片大小不能超过 20MB!"),t},handleQuery:function(){this.loading=!0,this.queryParams.page=1,this.getList()},getList:function(){var e=this;this.loading=!0;var t=JSON.parse(JSON.stringify(this.queryParams));Object(d["ec"])(t).then((function(t){e.loading=!1,e.dataList=t.data,e.total=t.total}))},statuschange:function(e){var t=this;e.father=e.father.id,Object(d["pb"])(e.id,e).then((function(e){t.$message({message:"修改成功",type:"success"}),t.getList()}))},adddata:function(){this.initForm(),this.dialogTitle="新增频道",this.dialogType="add",this.dialogFormVisible=!0},initForm:function(){this.$refs.dataForm&&this.$refs.dataForm.resetFields(),this.form={type:"tv_channel",father:0,name:"",sort:0,product_id:"",forway:[],extra:{has_live:"",has_replay:"",intro:"",logo:"",stream_urls:[{name:"超清",url:""},{name:"高清",url:""},{name:"标清",url:""}]},status:""}},editdata:function(e){var t=this;this.initForm(),this.dialogTitle="编辑频道",this.dialogType="edit",this.$nextTick((function(){t.form=JSON.parse(JSON.stringify(e)),t.form.forway=[],1==t.form.extra.has_replay&&t.form.forway.push("点播"),1==t.form.extra.has_live&&t.form.forway.push("直播"),console.log(t.form)})),this.dialogFormVisible=!0},deldata:function(e){var t=this;this.$confirm("此操作将永久删除id为"+e.id+"的频道, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(d["ab"])(e.id).then((function(e){t.$message({message:"删除成功",type:"success"}),t.getList()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},closeDialog:function(){this.initForm(),this.dialogFormVisible=!1},enterDialog:function(){var e=this;this.form.forway.indexOf("直播")>-1?this.form.extra.has_live=1:this.form.extra.has_live=0,this.form.forway.indexOf("点播")>-1?this.form.extra.has_replay=1:this.form.extra.has_replay=0,console.log(this.form),this.$refs["dataForm"].validate((function(t){if(t)if("edit"==e.dialogType){var a=JSON.parse(JSON.stringify(e.form));a.father=a.father.id,Object(d["pb"])(a.id,a).then((function(t){e.$message({message:"修改成功",type:"success"}),e.dialogFormVisible=!1,e.getList()}))}else Object(d["s"])(e.form).then((function(t){e.$message({message:"新建成功",type:"success"}),e.dialogFormVisible=!1,e.getList()}))}))}}},v=b,y=(a("c938"),a("a982"),Object(f["a"])(v,l,r,!1,null,"5b6ed803",null)),w=y.exports,_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_b"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.returntvList.length>0,expression:"returntvList.length > 0"}],staticClass:"pbox page_b",staticStyle:{"padding-top":"20px"}},[a("el-row",[a("el-col",{attrs:{span:3}},[a("el-tabs",{staticClass:"left",staticStyle:{height:"500px"},attrs:{"tab-position":"left"},on:{"tab-click":e.tabsClick},model:{value:e.queryParams.channel_id,callback:function(t){e.$set(e.queryParams,"channel_id",t)},expression:"queryParams.channel_id"}},e._l(e.returntvList,(function(e,t){return a("el-tab-pane",{attrs:{label:e.name,name:""+e.id}})})),1)],1),a("el-col",{attrs:{span:20}},[a("div",{staticClass:"right"},[a("div",[a("div",{staticClass:"top",staticStyle:{display:"inline"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions,placeholder:"选择日期"},on:{change:e.pickerdatechange},model:{value:e.queryParams.date,callback:function(t){e.$set(e.queryParams,"date",t)},expression:"queryParams.date"}})],1),a("el-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:e.pickerdatechange},model:{value:e.queryParams.date,callback:function(t){e.$set(e.queryParams,"date",t)},expression:"queryParams.date"}},[a("el-radio-button",{attrs:{label:e.nowDate(0)}},[e._v(e._s(e._f("dateformat")(e.nowDate(0),"today")))]),e._l(6,(function(t,i){return[a("el-radio-button",{attrs:{label:e.nowDate(t)}},[e._v(e._s(e._f("dateformat")(e.nowDate(t))))])]}))],2),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],staticStyle:{"margin-left":"20px"},attrs:{type:"primary",size:"small"},on:{click:e.adddata}},[e._v("新增")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"margin-top":"20px"},attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},border:"",data:e.dataList}},[a("el-table-column",{attrs:{label:"节目名称",align:"center",prop:"name","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"开始时间",align:"center",prop:"time","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"允许回看",align:"center","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("formatallow_replay")(t.row.extra.allow_replay))+" ")]}}])}),a("el-table-column",{attrs:{width:"150px",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("Iconbutton",{attrs:{icontype:"xg",label:"修改"},on:{fatherMethod:function(a){return e.editdata(t.row)}}}),a("Iconbutton",{attrs:{icontype:"sc",label:"删除"},on:{fatherMethod:function(a){return e.deldata(t.row)}}})]}}])})],1)],1)])],1)],1),a("el-dialog",{attrs:{width:"540px",title:e.dialogTitle,"show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1,visible:e.innerVisible},on:{"update:visible":function(t){e.innerVisible=t}}},[a("el-form",{ref:"dataForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{"label-width":"120px",label:"节目名称:",prop:"name"}},[a("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"请输入节目名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"开始时间:",prop:"time"}},[a("el-time-picker",{attrs:{"value-format":"HH:mm:ss",placeholder:"请选择时间"},model:{value:e.form.time,callback:function(t){e.$set(e.form,"time",t)},expression:"form.time"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"是否允许回看:",prop:"extra.allow_replay"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.extra.allow_replay,callback:function(t){e.$set(e.form.extra,"allow_replay",t)},expression:"form.extra.allow_replay"}},e._l(e.statusoptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:e.innercloseDialog}},[e._v("取 消")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:e.innerenterDialog}},[e._v("确 定")])],1)],1)],1)},x=[],k=(a("dbb3"),a("e18c"),a("1c2e"),{name:"page_b",props:{productId:{type:Number,default:0}},data:function(){var e=this.getDay(0);return{pickerOptions:{disabledDate:function(e){return e.getTime()-5184e5>Date.now()||e.getTime()+6048e5<Date.now()}},loading:!0,dataList:[],tvList:[],tvqueryParams:{page:1,pageSize:999,product_id:0,type:"tv_channel"},queryParams:{page:1,pageSize:999,channel_id:"",date:e},innerVisible:!1,dialogTitle:"",form:{},rules:{time:[{required:!0,message:"请选择时间",trigger:"blur"}],"extra.allow_replay":[{required:!0,message:"请选择是否允许回看",trigger:"blur"}]},dialogType:"add",statusoptions:[{value:"1",label:"是"},{value:"0",label:"否"}]}},created:function(){this.getList(),this.initForm()},watch:{productId:function(e){this.tvqueryParams.product_id=e,this.gettvList(),this.getList()}},filters:{dateformat:function(e,t){e=new Date(e);var a=e.getDay(),i=["(周日)","(周一)","(周二)","(周三)","(周四)","(周五)","(周六)"],s=i[a],l=e.getMonth()+1,r=String(e.getDate()<10?"0"+e.getDate():e.getDate());return t?l+"."+r+" (今天)":l+"."+r+" "+s},formatallow_replay:function(e){return 1==e?"是":"否"}},computed:{nowDate:function(){var e=this;return function(t){return e.getDay(t)}},returntvList:function(){return this.tvList.filter((function(e){return 1==e.status&&"1"==e.extra.has_live}))}},methods:{pickerdatechange:function(){this.getList()},getDay:function(e){var t=new Date,a=t.getTime()+864e5*e;t.setTime(a);var i=t.getFullYear(),s=t.getMonth(),l=t.getDate();return s=this.doHandleMonth(s+1),l=this.doHandleMonth(l),i+"-"+s+"-"+l},doHandleMonth:function(e){var t=e;return 1===e.toString().length&&(t="0"+e),t},getList:function(){var e=this;this.loading=!0;var t=JSON.parse(JSON.stringify(this.queryParams));Object(d["fc"])(t).then((function(t){e.loading=!1,e.dataList=t.data}))},gettvList:function(){var e=this,t=this.tvqueryParams;Object(d["ec"])(t).then((function(t){e.tvList=t.data,e.tvList=e.tvList.filter((function(e){return 1==e.status&&"1"==e.extra.has_live})),e.queryParams.channel_id=e.tvList[0]?""+e.tvList[0].id:"",e.getList()}))},tabsClick:function(){this.getList()},initForm:function(){this.$refs.dataForm&&this.$refs.dataForm.resetFields(),this.form={name:"",time:"",extra:{allow_replay:""}}},adddata:function(){this.initForm(),this.innerVisible=!0,this.dialogTitle="新增节目",this.dialogType="add"},editdata:function(e){var t=this;this.initForm(),this.dialogTitle="编辑节目",this.dialogType="edit",this.$nextTick((function(){t.form=JSON.parse(JSON.stringify(e))})),this.innerVisible=!0},deldata:function(e){var t=this;this.$confirm("此操作将永久删除节目名称为"+e.name+"的节目, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(d["W"])(e.id).then((function(e){t.$message({message:"删除成功",type:"success"}),t.getList()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},innercloseDialog:function(){this.innerVisible=!1},innerenterDialog:function(){var e=this;this.$refs["dataForm"].validate((function(t){if(t){var a={type:"1"};a.channel_id=e.queryParams.channel_id,a.date=e.queryParams.date;var i=Object.assign(a,e.form);"edit"==e.dialogType?Object(d["lb"])(i.id,i).then((function(t){e.$message({message:"修改成功",type:"success"}),e.innerVisible=!1,e.getList()})):Object(d["t"])(i).then((function(t){e.$message({message:"新建成功",type:"success"}),e.innerVisible=!1,e.getList()}))}}))}}}),L=k,$=(a("ed22"),Object(f["a"])(L,_,x,!1,null,null,null)),S=$.exports,P=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_c"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.returntvList.length>0,expression:"returntvList.length > 0"}],staticClass:"pbox page_c",staticStyle:{"padding-top":"20px"}},[a("el-row",[a("el-col",{attrs:{span:3}},[a("el-tabs",{staticClass:"left",staticStyle:{height:"500px","margin-right":"20px",width:"180px"},attrs:{"tab-position":"left"},on:{"tab-click":e.tabsClick},model:{value:e.queryParams.channel_id,callback:function(t){e.$set(e.queryParams,"channel_id",t)},expression:"queryParams.channel_id"}},e._l(e.returntvList,(function(e,t){return a("el-tab-pane",{attrs:{label:e.name,name:""+e.id}})})),1)],1),a("el-col",{attrs:{span:20}},[a("div",{staticClass:"right",staticStyle:{width:"1400px"}},[e.showlist?e._e():a("div",[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],staticStyle:{"margin-left":"20px"},attrs:{type:"primary",size:"small"},on:{click:e.adddata}},[e._v("新增")])],1),e.showlist?e._e():a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"margin-top":"20px"},attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},border:"",data:e.dataList}},[a("el-table-column",{attrs:{label:"id",align:"center",prop:"id","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"节目名称",align:"center",prop:"name","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"权重",align:"center",prop:"sort","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"状态",align:"center",prop:"name","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(a){return e.statuschange(t.row)}},model:{value:t.row.status,callback:function(a){e.$set(t.row,"status",a)},expression:"scope.row.status"}},e._l(e.statusoptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)]}}],null,!1,4181223627)}),a("el-table-column",{attrs:{label:"创建时间",align:"center",prop:"updated_at","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{width:"280px",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("Iconbutton",{attrs:{icontype:"dbjmd",label:"点播节目单"},on:{fatherMethod:function(a){return e.golist(t.row)}}}),a("Iconbutton",{attrs:{icontype:"xg",label:"修改"},on:{fatherMethod:function(a){return e.editdata(t.row)}}}),a("Iconbutton",{attrs:{icontype:"sc",label:"删除"},on:{fatherMethod:function(a){return e.deldata(t.row)}}})]}}],null,!1,3520136552)})],1),e.showlist?a("Pageclist",{attrs:{showlist:e.showlist,_channel_id:e._channel_id},on:{back:e.back}}):e._e()],1)])],1)],1),a("el-dialog",{attrs:{width:"540px",title:e.dialogTitle,"show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1,visible:e.innerVisible},on:{"update:visible":function(t){e.innerVisible=t}}},[a("el-form",{ref:"dataForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{"label-width":"120px",label:"节目名称:",prop:"name"}},[a("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"请输入节目名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"节目Logo/封面:",prop:"extra.cover[0].path"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.VUE_APP_BASE_API+"/api/upload/image",headers:e.importHeaders,name:"image","show-file-list":!1,"on-success":e.handleAvatarSuccess.bind(this,"cover"),"before-upload":e.beforeAvatarUpload}},[e.form.extra.cover[0].path?a("img",{staticClass:"avatar",attrs:{src:e.form.extra.cover[0].path}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{attrs:{"label-width":"120px",label:"权重(排序):",prop:"sort"}},[a("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"请输入权重"},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"绑定视频栏目",prop:"extra.vms_channel_type"}},[a("el-radio-group",{model:{value:e.form.extra.vms_channel_type,callback:function(t){e.$set(e.form.extra,"vms_channel_type",t)},expression:"form.extra.vms_channel_type"}},[a("el-radio",{attrs:{label:"cloud"}},[e._v("蓝云视频栏目")]),a("el-radio",{attrs:{label:"vms"}},[e._v("VMS视频栏目")])],1)],1),"cloud"==e.form.extra.vms_channel_type?a("el-form-item",{attrs:{"label-width":"120px",label:"蓝云视频栏目:",prop:"extra.vms_channel"}},[a("el-cascader",{key:"1",attrs:{props:{value:"code",label:"name",emitPath:!1},options:e.videocatalogoptions,"show-all-levels":!1},model:{value:e.form.extra.vms_channel,callback:function(t){e.$set(e.form.extra,"vms_channel",t)},expression:"form.extra.vms_channel"}})],1):e._e(),"vms"==e.form.extra.vms_channel_type?a("el-form-item",{attrs:{"label-width":"120px",label:"VMS视频栏目:",prop:"extra.vms_channel"}},[a("el-cascader",{key:"2",attrs:{props:{value:"id",label:"name",emitPath:!1},options:e.vmscatalogoptions,"show-all-levels":!1},model:{value:e.form.extra.vms_channel,callback:function(t){e.$set(e.form.extra,"vms_channel",t)},expression:"form.extra.vms_channel"}})],1):e._e(),a("el-form-item",{attrs:{"label-width":"120px",label:"是否启用:",prop:"status"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},e._l(e.statusoptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:e.innercloseDialog}},[e._v("取 消")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:e.innerenterDialog}},[e._v("确 定")])],1)],1)],1)},F=[],T=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_c_list"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:e.back}},[e._v("返回上一级")]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"margin-top":"20px"},attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},border:"",data:e.dataList}},[a("el-table-column",{attrs:{label:"id",align:"center",prop:"script.id","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"节目名称",align:"center",prop:"script.title","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"所属节目",align:"center",prop:"channel.name","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"状态",align:"center",prop:"script.status","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{disabled:"",placeholder:"请选择"},on:{change:function(a){return e.statuschange(t.row)}},model:{value:t.row.script.status,callback:function(a){e.$set(t.row.script,"status",a)},expression:"scope.row.script.status"}},e._l(e.statusoptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)]}}])}),a("el-table-column",{attrs:{label:"创建时间",align:"center",prop:"script.created_at","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{width:"200px",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("Iconbutton",{attrs:{icontype:"sc",label:"删除"},on:{fatherMethod:function(a){return e.deldata(t.row)}}})]}}])})],1),a("el-dialog",{attrs:{width:"740px",title:e.dialogTitle,"show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1,visible:e.innerVisible},on:{"update:visible":function(t){e.innerVisible=t}}},[a("el-form",{ref:"dataForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{"label-width":"120px",label:"点播节目单名称:",prop:"name"}},[a("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"请输入点播节目单名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"节目单封面:",prop:"cover"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.VUE_APP_BASE_API+"/api/upload/image",headers:e.importHeaders,name:"image","show-file-list":!1,"on-success":e.handleAvatarSuccess.bind(this,"name"),"before-upload":e.beforeAvatarUpload}},[e.form.name?a("img",{staticClass:"avatar",attrs:{src:e.form.name}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{attrs:{"label-width":"120px",label:"资源地址"}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入内容"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[a("template",{slot:"prepend"},[e._v("超清")])],2),a("el-input",{staticStyle:{width:"400px",margin:"15px 0"},attrs:{placeholder:"请输入内容"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[a("template",{slot:"prepend"},[e._v("高清")])],2),a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入内容"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[a("template",{slot:"prepend"},[e._v("标清")])],2)],1),a("el-form-item",{attrs:{"label-width":"120px",label:"播放时间:",prop:"play_time"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:e.form.play_time,callback:function(t){e.$set(e.form,"play_time",t)},expression:"form.play_time"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"基础点击量:",prop:"view_base_num"}},[a("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"请输入基础点击量"},model:{value:e.form.view_base_num,callback:function(t){e.$set(e.form,"view_base_num",t)},expression:"form.view_base_num"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"是否启用:",prop:"name"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},e._l(e.statusoptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:e.innercloseDialog}},[e._v("取 消")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:e.innerenterDialog}},[e._v("确 定")])],1)],1)],1)},V=[],O={name:"page_c_list",props:{_channel_id:{type:Number,default:0},showlist:{type:Boolean,default:!0}},data:function(){var e=sessionStorage.getItem("token");return{importHeaders:{Authorization:e},dataList:[],loading:!0,statusoptions:[{value:1,label:"启用"},{value:0,label:"禁用"}],dialogTitle:"",innerVisible:!1,form:{},rules:{}}},created:function(){this.getList()},computed:{VUE_APP_BASE_API:function(){return this.imgurl2}},methods:{handleAvatarSuccess:function(e,t){this.form.name=t.path,this.$forceUpdate()},beforeAvatarUpload:function(e){var t=e.size/1024/1024<20;return t||this.$message.error("上传头像图片大小不能超过 20MB!"),t},back:function(){this.$emit("back",!1)},getList:function(){var e=this;this.loading=!0;var t={channel_id:this._channel_id,type:"tv_replay"};Object(d["Fb"])(t).then((function(t){e.loading=!1,console.log(t),e.dataList=t.data}))},deldata:function(e){var t=this;this.$confirm("此操作将永久删除id为"+e.script.id+"的节目, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(d["X"])(e.script.id).then((function(e){t.$message({message:"删除成功",type:"success"}),t.getList()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},innercloseDialog:function(){this.innerVisible=!1},innerenterDialog:function(){this.innerVisible=!1},initForm:function(){this.$refs.dataForm&&this.$refs.dataForm.resetFields(),this.form={status:1,extra:{cover:[{path:"",intro:""}],title:"",stream:[{path:"http://cv.cztv.com/zrtg_mit/36bd6a3457514fd7b67fd44940cf7a63/36bd6a3457514fd7b67fd44940cf7a63_h264_128k_mp3.mp3",rate:"128",format:"mp3",video_id:"581e88ee8cb649fa9692a07d0726c889",file_name:"/lanyun/2021/05/08/视频.mp4_47296197#h264_128k_mp3.mp3"},{path:"http://cv.cztv.com/zrtg_mit/36bd6a3457514fd7b67fd44940cf7a63/36bd6a3457514fd7b67fd44940cf7a63_H264_1500K_MP4.mp4",rate:"1500",format:"mp4",video_id:"455d73bc95d14f6a9fbaba3f1b03eda4",file_name:"/lanyun/2021/05/08/视频.mp4_47296197#H264_1500K_MP4.mp4"},{path:"http://cv.cztv.com/zrtg_mit/36bd6a3457514fd7b67fd44940cf7a63/36bd6a3457514fd7b67fd44940cf7a63_H264_800K_MP4.mp4",rate:"800",format:"mp4",video_id:"ef2418a8e8b4480fa172668c8e82734e",file_name:"/lanyun/2021/05/08/视频.mp4_47296197#H264_800K_MP4.mp4"},{path:"http://cv.cztv.com/zrtg_mit/36bd6a3457514fd7b67fd44940cf7a63/36bd6a3457514fd7b67fd44940cf7a63_H264_450K_MP4.mp4",rate:"450",format:"mp4",video_id:"07df38e0829a480abef854674ee6685f",file_name:"/lanyun/2021/05/08/视频.mp4_47296197#H264_450K_MP4.mp4"}]}}},editdata:function(e){console.log(e),this.initForm(),this.dialogTitle="编辑节目",this.dialogType="edit",this.innerVisible=!0}}},N=O,q=(a("7e1d"),a("6c13"),Object(f["a"])(N,T,V,!1,null,"c9b4f36c",null)),D=q.exports,I={name:"page_c",props:{productId:{type:Number,default:0}},components:{Pageclist:D},data:function(){var e=sessionStorage.getItem("token");return{showlist:!1,_channel_id:"",importHeaders:{Authorization:e},loading:!0,dataList:[],tvList:[],videocatalogoptions:[],vmscatalogoptions:[],tvqueryParams:{page:1,pageSize:999,product_id:0,type:"tv_channel"},queryParams:{page:1,pageSize:999,channel_id:"",type:"tv_replay"},innerVisible:!1,dialogTitle:"",form:{},rules:{sort:[{required:!0,message:"请输入权重",trigger:"blur"}],status:[{required:!0,message:"请选择是否允许回看",trigger:"blur"}],"extra.cover[0].path":[{required:!0,message:"请选择节目Logo/封面",trigger:"blur"}]},dialogType:"add",statusoptions:[{value:1,label:"启用"},{value:0,label:"禁用"}]}},created:function(){this.getList(),this.initForm(),this.getvms_channels()},watch:{productId:function(e){this.tvqueryParams.product_id=e,this.gettvList()}},computed:{VUE_APP_BASE_API:function(){return this.imgurl2},returntvList:function(){return this.tvList.filter((function(e){return 1==e.status&&"1"==e.extra.has_replay}))}},methods:{back:function(e){this.showlist=e},golist:function(e){this._channel_id=e.id,this.showlist=!0},statuschange:function(e){var t=this;Object(d["cb"])(e.id,e).then((function(e){t.$message({message:"修改成功",type:"success"}),t.getList()}))},getvms_channels:function(){var e=this;Object(d["ic"])(1).then((function(t){e.videocatalogoptions=t})),Object(d["ic"])(0).then((function(t){function a(e){for(var t=0;t<e.length;t++)e[t].id=String(e[t].id),e[t].children&&a(e[t].children);return e}e.vmscatalogoptions=t,a(e.vmscatalogoptions)}))},handleAvatarSuccess:function(e,t){this.form.extra.cover[0].path=t.path,this.$forceUpdate()},beforeAvatarUpload:function(e){var t=e.size/1024/1024<20;return t||this.$message.error("上传头像图片大小不能超过 20MB!"),t},getList:function(){var e=this;this.showlist=!1,this.loading=!0;var t=this.queryParams.channel_id;t&&Object(d["wb"])(t).then((function(t){e.loading=!1,e.dataList=t}))},gettvList:function(){var e=this,t=this.tvqueryParams;Object(d["ec"])(t).then((function(t){e.tvList=t.data,e.tvList=e.tvList.filter((function(e){return 1==e.status&&"1"==e.extra.has_replay})),e.queryParams.channel_id=e.tvList[0]?""+e.tvList[0].id:"",e.getList()}))},tabsClick:function(){this.getList()},initForm:function(){this.$refs.dataForm&&this.$refs.dataForm.resetFields(),this.form={name:"",product_id:this.productId,father:this.queryParams.channel_id,sort:0,status:1,type:"tv_replay",extra:{cover:[{path:"",intro:""}],vms_channel:"",vms_channel_type:"cloud"}}},adddata:function(){this.initForm(),this.innerVisible=!0,this.dialogTitle="新增节目",this.dialogType="add"},editdata:function(e){var t=this;this.initForm(),this.dialogTitle="编辑节目",this.dialogType="edit",this.$nextTick((function(){t.form=JSON.parse(JSON.stringify(e)),console.log(t.form)})),this.innerVisible=!0},deldata:function(e){var t=this;this.$confirm("此操作将永久删除栏目id为"+e.id+"的节目, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(d["I"])(e.id).then((function(e){t.$message({message:"删除成功",type:"success"}),t.getList()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},innercloseDialog:function(){this.innerVisible=!1},innerenterDialog:function(){var e=this;this.$refs["dataForm"].validate((function(t){if(t){var a={};a.channel_id=e.queryParams.channel_id;var i=Object.assign(a,e.form);"edit"==e.dialogType?Object(d["cb"])(i.id,i).then((function(t){e.$message({message:"修改成功",type:"success"}),e.innerVisible=!1,e.getList()})):Object(d["u"])(i).then((function(t){e.$message({message:"新建成功",type:"success"}),e.innerVisible=!1,e.getList()}))}}))}}},A=I,C=(a("1f3a"),a("ef04"),a("b439"),Object(f["a"])(A,P,F,!1,null,"0ef37d61",null)),j=C.exports,M=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_d"},[a("el-form",{ref:"queryForm",attrs:{model:e.queryParams,inline:!0}},[a("el-form-item",[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:e.adddata}},[e._v("新增")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},border:"",data:e.dataList}},[a("el-table-column",{attrs:{label:"ID",align:"center",prop:"id"}}),a("el-table-column",{attrs:{label:"频道logo",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{staticStyle:{"max-height":"50px","max-width":"50px"},attrs:{src:e.row.extra.logo}})]}}])}),a("el-table-column",{attrs:{label:"频道名称",align:"center",prop:"name","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"权重",align:"center",prop:"sort","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"频道状态",align:"center",prop:"status","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(a){return e.statuschange(t.row)}},model:{value:t.row.status,callback:function(a){e.$set(t.row,"status",a)},expression:"scope.row.status"}},e._l(e.statusoptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)]}}])}),a("el-table-column",{attrs:{label:"模板状态",align:"center",prop:"extra.template.type||'未启用'","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("formattemplate")(t.row.extra.template)))])]}}])}),a("el-table-column",{attrs:{label:"节目模板",align:"center",prop:"en_name","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{size:"mini",type:"primary"},on:{click:function(a){return e.program(t.row)}}},[e._v("模板管理")])]}}])}),a("el-table-column",{attrs:{label:"创建时间",align:"center",prop:"created_at","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{width:"150px",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("Iconbutton",{attrs:{icontype:"xg",label:"修改"},on:{fatherMethod:function(a){return e.editdata(t.row)}}}),a("Iconbutton",{attrs:{icontype:"sc",label:"删除"},on:{fatherMethod:function(a){return e.deldata(t.row)}}})]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.page,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"page",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}}),a("el-dialog",{attrs:{width:"700px","close-on-click-modal":!1,title:e.dialogTitle,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"dataForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{"label-width":"120px",label:"频道名称",prop:"name"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{autocomplete:"off",placeholder:"请输入频道名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"权重",prop:"sort"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{autocomplete:"off",placeholder:"请输入权重(排序)"},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"所属产品",prop:"product_id"}},[a("el-select",{attrs:{disabled:"edit"==e.dialogType,placeholder:"请选择"},model:{value:e.form.product_id,callback:function(t){e.$set(e.form,"product_id",t)},expression:"form.product_id"}},e._l(e.productList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{"label-width":"120px",label:"频道LOGO：",prop:"extra.logo"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.VUE_APP_BASE_API+"/api/upload/image",headers:e.importHeaders,name:"image","show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.form.extra.logo?a("img",{staticClass:"avatar",attrs:{src:e.form.extra.logo}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{attrs:{"label-width":"120px",label:"适用于",prop:"forway"}},[a("el-checkbox-group",{on:{change:function(t){return e.$forceUpdate()}},model:{value:e.form.forway,callback:function(t){e.$set(e.form,"forway",t)},expression:"form.forway"}},[a("el-checkbox",{attrs:{label:"直播"}}),a("el-checkbox",{attrs:{label:"点播"}})],1)],1),e.form.forway.indexOf("直播")>-1?a("el-form-item",{attrs:{"label-width":"120px",label:"流地址"}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入内容"},model:{value:e.form.extra.stream_urls[0].url,callback:function(t){e.$set(e.form.extra.stream_urls[0],"url",t)},expression:"form.extra.stream_urls[0].url"}})],1):e._e(),a("el-form-item",{attrs:{"label-width":"120px",label:"简介",prop:"extra.intro"}},[a("el-input",{staticStyle:{width:"400px"},attrs:{autosize:{minRows:4},type:"textarea",autocomplete:"off",placeholder:"请输入简介"},model:{value:e.form.extra.intro,callback:function(t){e.$set(e.form.extra,"intro",t)},expression:"form.extra.intro"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"是否启用",prop:"status"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},e._l(e.statusoptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:e.closeDialog}},[e._v("取 消")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:e.enterDialog}},[e._v("确 定")])],1)],1),a("Pagedialog",{ref:"Pagedialog"})],1)},z=[],H=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_d_dialog"},[e.dialogFormVisible?a("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.importLoading,expression:"importLoading"}],attrs:{width:"1200px","show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("span",{staticClass:"el-dialog__title",attrs:{slot:"title"},slot:"title"},[a("span",[e._v("编辑节目单模板")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],staticStyle:{"margin-left":"20px"},attrs:{type:"primary",size:"small"},on:{click:e.downProgramme}},[e._v("下载节目单模板")]),a("el-upload",{staticClass:"upload-demo",attrs:{name:"excel",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-exce",action:e.actionUrl,data:e.actionData,headers:e.uploadHeader,"on-success":e.handleAvatarSuccess,"on-error":e.handleAvatarError,"before-upload":e.beforeAvatarUpload,"show-file-list":!1}},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{size:"small",type:"primary"}},[e._v("导入模板")])],1)],1),a("el-dialog",{attrs:{width:"540px",title:e.dialogTitle,"show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1,visible:e.innerVisible,"append-to-body":""},on:{"update:visible":function(t){e.innerVisible=t}}},[a("el-form",{ref:"dataForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{"label-width":"120px",label:"节目名称:",prop:"name"}},[a("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"请输入节目名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"开始时间:",prop:"time"}},[a("el-time-picker",{attrs:{"value-format":"HH:mm:ss",placeholder:"请选择时间"},model:{value:e.form.time,callback:function(t){e.$set(e.form,"time",t)},expression:"form.time"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"是否允许回看:",prop:"extra.allow_replay"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.extra.allow_replay,callback:function(t){e.$set(e.form.extra,"allow_replay",t)},expression:"form.extra.allow_replay"}},e._l(e.statusoptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:e.innercloseDialog}},[e._v("取 消")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:e.innerenterDialog}},[e._v("确 定")])],1)],1),a("span",[e._v("直播节日模板：")]),a("el-radio-group",{on:{change:e.chooseradio},model:{value:e.data.extra.template.type,callback:function(t){e.$set(e.data.extra.template,"type",t)},expression:"data.extra.template.type"}},[a("el-radio",{attrs:{label:"daily"}},[e._v("每日重复(创建单日节目单模板，每日重复)")]),a("el-radio",{attrs:{label:"weekly"}},[e._v("每周重复(创建周一至周日节目单模板，每周循环)")]),a("el-radio",{attrs:{label:"none"}},[e._v("不启用模板")])],1),a("div",{staticStyle:{"min-height":"500px"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:"daily"==e.data.extra.template.type||"weekly"==e.data.extra.template.type,expression:"data.extra.template.type=='daily'||data.extra.template.type=='weekly'"}],staticStyle:{"margin-top":"30px",display:"flex"}},[a("el-tabs",{directives:[{name:"show",rawName:"v-show",value:"weekly"==e.data.extra.template.type,expression:"data.extra.template.type=='weekly'"}],staticClass:"left",staticStyle:{height:"500px","margin-right":"10px",width:"100px"},attrs:{"tab-position":"left"},on:{"tab-click":e.changeweek},model:{value:e.weekday,callback:function(t){e.weekday=t},expression:"weekday"}},[a("el-tab-pane",{attrs:{label:"周一",name:"1"}}),a("el-tab-pane",{attrs:{label:"周二",name:"2"}}),a("el-tab-pane",{attrs:{label:"周三",name:"3"}}),a("el-tab-pane",{attrs:{label:"周四",name:"4"}}),a("el-tab-pane",{attrs:{label:"周五",name:"5"}}),a("el-tab-pane",{attrs:{label:"周六",name:"6"}}),a("el-tab-pane",{attrs:{label:"周日",name:"7"}})],1),a("div",{staticClass:"right",staticStyle:{"flex-grow":"1"}},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],staticStyle:{"margin-bottom":"20px"},attrs:{type:"primary",size:"mini"},on:{click:e.adddata}},[e._v("新增")]),e.tableflag?a("el-table",{attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},border:"",data:e.dataList}},[a("el-table-column",{attrs:{label:"节目名称",align:"center",prop:"name","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"开始时间",align:"center",prop:"time","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"播放时长",align:"center",prop:"extra.duration","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"允许回看",align:"center","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("formatallow_replay")(t.row.extra.allow_replay))+" ")]}}],null,!1,1769245459)}),a("el-table-column",{attrs:{width:"150px",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("Iconbutton",{attrs:{icontype:"xg",label:"修改"},on:{fatherMethod:function(a){return e.editdata(t)}}}),a("Iconbutton",{attrs:{icontype:"sc",label:"删除"},on:{fatherMethod:function(a){return e.deldata(t)}}})]}}],null,!1,593115993)})],1):e._e()],1)],1)]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:e.closeDialog}},[e._v("取 消")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:e.enterDialog}},[e._v("确 定")])],1)],1):e._e()],1)},U=[],B={name:"page_d_dialog",data:function(){return{dialogFormVisible:!1,innerVisible:!1,dialogTitle:"",form:{},rules:{time:[{required:!0,message:"请选择时间",trigger:"blur"}],"extra.allow_replay":[{required:!0,message:"请选择是否允许回看",trigger:"blur"}]},dialogType:"add",editIndex:"",dataList:[],dayList:[],weekList:{},tableflag:!0,weekday:"1",statusoptions:[{value:1,label:"是"},{value:2,label:"否"}],data:"",importLoading:!1}},computed:{actionUrl:function(){return this.xlsxUrl},uploadHeader:function(){var e=sessionStorage.getItem("token");return{Authorization:e}},actionData:function(e){var t=e.data,a=void 0===t?{}:t;return{channel_id:a.id}}},filters:{formatallow_replay:function(e){return 1==e?"是":"否"}},created:function(){this.initForm()},methods:{getdata:function(e){this.data=JSON.parse(JSON.stringify(e))},changeweek:function(e,t){this.returndataList()},closeDialog:function(){this.dialogFormVisible=!1},enterDialog:function(){var e=this;if("weekly"!=this.data.extra.template.type||this.weekList["1"]&&this.weekList["1"].length>0&&this.weekList["2"]&&this.weekList["2"].length>0&&this.weekList["3"]&&this.weekList["3"].length>0&&this.weekList["4"]&&this.weekList["4"].length>0&&this.weekList["5"]&&this.weekList["5"].length>0&&this.weekList["6"]&&this.weekList["6"].length>0&&this.weekList["7"]&&this.weekList["7"].length>0){this.data.father=this.data.father.id;var t={list:{daily:[],weekly:{}},type:""};t.list.daily=this.dayList,t.list.weekly=this.weekList,t.type=this.data.extra.template.type,this.data.extra.template=t,Object(d["pb"])(this.data.id,this.data).then((function(t){e.$message({message:"修改成功",type:"success"}),e.dialogFormVisible=!1,e.$parent.getList(),e.weekday="1"}))}else this.$message({message:"选择每周重复，请保证每天至少有一个节目",type:"warning"})},initForm:function(){this.$refs.dataForm&&this.$refs.dataForm.resetFields(),this.form={name:"",time:"",extra:{duration:"",allow_replay:1}}},adddata:function(){this.initForm(),this.innerVisible=!0,this.dialogTitle="新增节目",this.dialogType="add"},editdata:function(e){this.initForm(),this.editIndex=e.$index,this.form=JSON.parse(JSON.stringify(e.row)),this.innerVisible=!0,this.dialogTitle="修改节目",this.dialogType="edit"},deldata:function(e){var t=this,a=e.row;this.editIndex=e.$index,this.$confirm("此操作将永久删除节目名称为"+a.name+"的节目, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){"daily"==t.data.extra.template.type?(t.dayList.splice(t.editIndex,1),t.datalistformat(t.dayList),t.dataList=t.dayList,t.innerVisible=!1,t.$message({message:"删除成功",type:"success"})):"weekly"==t.data.extra.template.type&&(t.weekList[t.weekday].splice(t.editIndex,1),t.datalistformat(t.weekList[t.weekday]),t.dataList=t.weekList[t.weekday],t.innerVisible=!1,t.$message({message:"删除成功",type:"success"}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},innercloseDialog:function(){this.innerVisible=!1},returntime:function(e,t){function a(e){return e<10?"0"+e:e}var i="1970/1/1 ",s=(e=e||"09:01:22",t=t||"22:22:22",new Date(i+e)),l=new Date(i+t),r=parseInt((l.getTime()-s.getTime())/1e3);Math.floor(r/86400/365);r%=31536e3;Math.floor(r/86400/30);r%=2592e3;Math.floor(r/86400);r%=86400;var o=Math.floor(r/3600);r%=3600;var n=Math.floor(r/60);r%=60;var c=r;return a(o)+":"+a(n)+":"+a(c)},datalistformat:function(e){e.sort((function(e,t){return t.time<e.time?1:-1}));for(var t=0;t<e.length;t++)t<e.length-1?e[t].extra.duration=this.returntime(e[t].time,e[t+1].time):e[t].extra.duration=this.returntime(e[t].time,"24:00:00");return e},innerenterDialog:function(){var e=this;this.$refs["dataForm"].validate((function(t){if(t){var a=JSON.parse(JSON.stringify(e.form));if("edit"==e.dialogType){if("daily"==e.data.extra.template.type){for(var i=0;i<e.dayList.length;i++)if(a.time==e.dayList[i].time&&i!=e.editIndex)return void e.$message({message:"开始时间重复，请修改",type:"warning"});e.dayList.splice(e.editIndex,1,a),e.datalistformat(e.dayList),e.dataList=e.dayList,e.innerVisible=!1}else if("weekly"==e.data.extra.template.type){for(i=0;i<e.weekList[e.weekday].length;i++)if(a.time==e.weekList[e.weekday][i].time&&i!=e.editIndex)return void e.$message({message:"开始时间重复，请修改",type:"warning"});e.weekList[e.weekday].splice(e.editIndex,1,a),e.datalistformat(e.weekList[e.weekday]),e.dataList=e.weekList[e.weekday],e.innerVisible=!1}}else if("daily"==e.data.extra.template.type){for(i=0;i<e.dayList.length;i++)if(a.time==e.dayList[i].time)return void e.$message({message:"开始时间重复，请修改",type:"warning"});e.dayList.push(a),e.datalistformat(e.dayList),e.dataList=e.dayList,e.innerVisible=!1}else if("weekly"==e.data.extra.template.type){if(Object(p["a"])(e.weekList[e.weekday])){for(i=0;i<e.weekList[e.weekday].length;i++)if(a.time==e.weekList[e.weekday][i].time)return void e.$message({message:"开始时间重复，请修改",type:"warning"});e.weekList[e.weekday].push(a)}else e.weekList[e.weekday]=[],e.weekList[e.weekday].push(a);e.datalistformat(e.weekList[e.weekday]),e.dataList=e.weekList[e.weekday],e.innerVisible=!1}}}))},chooseradio:function(){var e=this;this.tableflag=!1,this.$nextTick((function(){e.tableflag=!0})),this.returndataList()},returndataList:function(){if(this.dataList=[],!this.data.extra.template){var e={list:{daily:[],weekly:{}},type:"none"};this.data.extra.template=e}"daily"==this.data.extra.template.type?(this.dayList=this.data.extra.template.list.daily,this.dataList=this.dayList):"weekly"==this.data.extra.template.type?(this.weekList=this.data.extra.template.list.weekly,this.weekList||(this.weekList={},this.weekList[this.weekday]=[]),this.dataList=this.weekList[this.weekday]):this.dataList=[]},downProgramme:function(){var e=location.origin;window.location.href="".concat(e,"/api/channels/downloadProgramTemplate")},beforeAvatarUpload:function(){this.importLoading=!0},handleAvatarSuccess:function(e){e.status_code>=200&&e.status_code<300?(this.$message.success("导入成功!"),this.$parent.getList(),this.dialogFormVisible=!1):this.$message.error("导入失败!"),this.importLoading=!1},handleAvatarError:function(e){this.$message.error("导入失败, 服务故障!"),this.importLoading=!1}}},E=B,J=(a("b69f"),a("f6d9"),Object(f["a"])(E,H,U,!1,null,"defcadfe",null)),K=J.exports,X={components:{Pagedialog:K},props:{productId:{type:Number,default:0},productList:{type:Array,default:[]}},name:"page_d",data:function(){var e,t=sessionStorage.getItem("token");return{importHeaders:{Authorization:t},queryParams:{page:1,pageSize:10,product_id:0,type:"radio_channel"},loading:!0,dataList:[],total:0,statusoptions:[{value:1,label:"启用"},{value:2,label:"禁用"}],dialogFormVisible:!1,form:{},rules:(e={name:[{required:!0,message:"请输入频道姓名",trigger:"blur"}],sort:[{required:!0,message:"请输入权重(排序)",trigger:"blur"}],product_id:[{required:!0,message:"请选择所属产品",trigger:"blur"}]},Object(o["a"])(e,"extra.logo",[{required:!0,message:"请选择频道logo",trigger:"blur"}]),Object(o["a"])(e,"forway",[{required:!0,message:"请选择适用场景",trigger:"blur"}]),Object(o["a"])(e,"status",[{required:!0,message:"请选择是否启用",trigger:"blur"}]),e),dialogType:"add",dialogTitle:""}},filters:{formattemplate:function(e){return e?"daily"==e.type?"每日循环":"weekly"==e.type?"每周循环":"未启用":"未启用"}},computed:{VUE_APP_BASE_API:function(){return this.imgurl2}},watch:{productId:function(e){this.queryParams.product_id=e,this.getList()}},created:function(){this.initForm()},methods:{program:function(e){this.$refs.Pagedialog.getdata(e),this.$refs.Pagedialog.dialogFormVisible=!0,this.$refs.Pagedialog.returndataList()},handleAvatarSuccess:function(e,t,a){this.form.extra.logo=e.path,this.$forceUpdate()},beforeAvatarUpload:function(e){var t=e.size/1024/1024<20;return t||this.$message.error("上传头像图片大小不能超过 20MB!"),t},handleQuery:function(){this.loading=!0,this.queryParams.page=1,this.getList()},getList:function(){var e=this;this.loading=!0;var t=JSON.parse(JSON.stringify(this.queryParams));Object(d["ec"])(t).then((function(t){e.loading=!1,e.dataList=t.data,e.total=t.total}))},statuschange:function(e){var t=this;e.father=e.father.id,Object(d["pb"])(e.id,e).then((function(e){t.$message({message:"修改成功",type:"success"}),t.getList()}))},adddata:function(){this.initForm(),this.dialogTitle="新增频道",this.dialogType="add",this.dialogFormVisible=!0},initForm:function(){this.$refs.dataForm&&this.$refs.dataForm.resetFields(),this.form={type:"radio_channel",father:0,name:"",sort:0,product_id:"",forway:[],extra:{has_live:"",has_replay:"",intro:"",logo:"",stream_urls:[{name:"标清",url:""}]},status:""}},editdata:function(e){var t=this;this.initForm(),this.dialogTitle="编辑频道",this.dialogType="edit",this.$nextTick((function(){t.form=JSON.parse(JSON.stringify(e)),t.form.forway=[],1==t.form.extra.has_replay&&t.form.forway.push("点播"),1==t.form.extra.has_live&&t.form.forway.push("直播"),console.log(t.form)})),this.dialogFormVisible=!0},deldata:function(e){var t=this;this.$confirm("此操作将永久删除id为"+e.id+"的频道, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(d["ab"])(e.id).then((function(e){t.$message({message:"删除成功",type:"success"}),t.getList()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},closeDialog:function(){this.initForm(),this.dialogFormVisible=!1},enterDialog:function(){var e=this;this.form.forway.indexOf("直播")>-1?this.form.extra.has_live=1:this.form.extra.has_live=0,this.form.forway.indexOf("点播")>-1?this.form.extra.has_replay=1:this.form.extra.has_replay=0,this.$refs["dataForm"].validate((function(t){if(t)if("edit"==e.dialogType){var a=JSON.parse(JSON.stringify(e.form));a.father=a.father.id,Object(d["pb"])(a.id,a).then((function(t){e.$message({message:"修改成功",type:"success"}),e.dialogFormVisible=!1,e.getList()}))}else Object(d["s"])(e.form).then((function(t){e.$message({message:"新建成功",type:"success"}),e.dialogFormVisible=!1,e.getList()}))}))}}},G=X,Q=(a("d089"),a("c5f3"),Object(f["a"])(G,M,z,!1,null,"db9fe868",null)),R=Q.exports,W=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_e"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.returntvList.length>0,expression:"returntvList.length > 0"}],staticClass:"pbox page_e",staticStyle:{"padding-top":"20px"}},[a("el-row",[a("el-col",{attrs:{span:3}},[a("el-tabs",{staticClass:"left",staticStyle:{height:"500px"},attrs:{"tab-position":"left"},on:{"tab-click":e.tabsClick},model:{value:e.queryParams.channel_id,callback:function(t){e.$set(e.queryParams,"channel_id",t)},expression:"queryParams.channel_id"}},e._l(e.returntvList,(function(e,t){return a("el-tab-pane",{attrs:{label:e.name,name:""+e.id}})})),1)],1),a("el-col",{attrs:{span:20}},[a("div",{staticClass:"right"},[a("div",[a("div",{staticClass:"top",staticStyle:{display:"inline"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions,placeholder:"选择日期"},on:{change:e.pickerdatechange},model:{value:e.queryParams.date,callback:function(t){e.$set(e.queryParams,"date",t)},expression:"queryParams.date"}})],1),a("el-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:e.pickerdatechange},model:{value:e.queryParams.date,callback:function(t){e.$set(e.queryParams,"date",t)},expression:"queryParams.date"}},[a("el-radio-button",{attrs:{label:e.nowDate(0)}},[e._v(e._s(e._f("dateformat")(e.nowDate(0),"today")))]),e._l(6,(function(t,i){return[a("el-radio-button",{attrs:{label:e.nowDate(t)}},[e._v(e._s(e._f("dateformat")(e.nowDate(t))))])]}))],2),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],staticStyle:{"margin-left":"20px"},attrs:{type:"primary",size:"small"},on:{click:e.adddata}},[e._v("新增")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"margin-top":"20px"},attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},border:"",data:e.dataList}},[a("el-table-column",{attrs:{label:"节目名称",align:"center",prop:"name","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"开始时间",align:"center",prop:"time","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"允许回看",align:"center","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("formatallow_replay")(t.row.extra.allow_replay))+" ")]}}])}),a("el-table-column",{attrs:{width:"150px",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("Iconbutton",{attrs:{icontype:"xg",label:"修改"},on:{fatherMethod:function(a){return e.editdata(t.row)}}}),a("Iconbutton",{attrs:{icontype:"sc",label:"删除"},on:{fatherMethod:function(a){return e.deldata(t.row)}}})]}}])})],1)],1)])],1)],1),a("el-dialog",{attrs:{width:"540px",title:e.dialogTitle,"show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1,visible:e.innerVisible},on:{"update:visible":function(t){e.innerVisible=t}}},[a("el-form",{ref:"dataForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{"label-width":"120px",label:"节目名称:",prop:"name"}},[a("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"请输入节目名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"开始时间:",prop:"time"}},[a("el-time-picker",{attrs:{"value-format":"HH:mm:ss",placeholder:"请选择时间"},model:{value:e.form.time,callback:function(t){e.$set(e.form,"time",t)},expression:"form.time"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"是否允许回看:",prop:"extra.allow_replay"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.extra.allow_replay,callback:function(t){e.$set(e.form.extra,"allow_replay",t)},expression:"form.extra.allow_replay"}},e._l(e.statusoptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:e.innercloseDialog}},[e._v("取 消")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:e.innerenterDialog}},[e._v("确 定")])],1)],1)],1)},Y=[],Z={name:"page_e",props:{productId:{type:Number,default:0}},data:function(){var e=this.getDay(0);return{pickerOptions:{disabledDate:function(e){return e.getTime()-5184e5>Date.now()||e.getTime()+6048e5<Date.now()}},loading:!0,dataList:[],tvList:[],tvqueryParams:{page:1,pageSize:999,product_id:0,type:"radio_channel"},queryParams:{page:1,pageSize:999,channel_id:"",date:e},innerVisible:!1,dialogTitle:"",form:{},rules:{time:[{required:!0,message:"请选择时间",trigger:"blur"}],"extra.allow_replay":[{required:!0,message:"请选择是否允许回看",trigger:"blur"}]},dialogType:"add",statusoptions:[{value:"1",label:"是"},{value:"0",label:"否"}]}},created:function(){this.initForm()},watch:{productId:function(e){this.tvqueryParams.product_id=e,this.gettvList(),this.getList()}},filters:{dateformat:function(e,t){e=new Date(e);var a=e.getDay(),i=["(周日)","(周一)","(周二)","(周三)","(周四)","(周五)","(周六)"],s=i[a],l=e.getMonth()+1,r=String(e.getDate()<10?"0"+e.getDate():e.getDate());return t?l+"."+r+" (今天)":l+"."+r+" "+s},formatallow_replay:function(e){return 1==e?"是":"否"}},computed:{nowDate:function(){var e=this;return function(t){return e.getDay(t)}},returntvList:function(){return this.tvList.filter((function(e){return 1==e.status&&"1"==e.extra.has_live}))}},methods:{pickerdatechange:function(){this.getList()},getDay:function(e){var t=new Date,a=t.getTime()+864e5*e;t.setTime(a);var i=t.getFullYear(),s=t.getMonth(),l=t.getDate();return s=this.doHandleMonth(s+1),l=this.doHandleMonth(l),i+"-"+s+"-"+l},doHandleMonth:function(e){var t=e;return 1===e.toString().length&&(t="0"+e),t},getList:function(){var e=this;this.loading=!0;var t=JSON.parse(JSON.stringify(this.queryParams));this.dataList=[],Object(d["fc"])(t).then((function(t){e.loading=!1,e.dataList=t.data}))},gettvList:function(){var e=this,t=this.tvqueryParams;Object(d["ec"])(t).then((function(t){e.tvList=t.data,e.tvList=e.tvList.filter((function(e){return 1==e.status&&"1"==e.extra.has_live})),e.queryParams.channel_id=e.tvList[0]?""+e.tvList[0].id:"",e.getList()}))},tabsClick:function(){this.getList()},initForm:function(){this.$refs.dataForm&&this.$refs.dataForm.resetFields(),this.form={name:"",time:"",extra:{allow_replay:""}}},adddata:function(){this.initForm(),this.innerVisible=!0,this.dialogTitle="新增节目",this.dialogType="add"},editdata:function(e){var t=this;this.initForm(),this.dialogTitle="编辑节目",this.dialogType="edit",this.$nextTick((function(){t.form=JSON.parse(JSON.stringify(e))})),this.innerVisible=!0},deldata:function(e){var t=this;this.$confirm("此操作将永久删除节目名称为"+e.name+"的节目, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(d["W"])(e.id).then((function(e){t.$message({message:"删除成功",type:"success"}),t.getList()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},innercloseDialog:function(){this.innerVisible=!1},innerenterDialog:function(){var e=this;this.$refs["dataForm"].validate((function(t){if(t){var a={type:"2"};a.channel_id=e.queryParams.channel_id,a.date=e.queryParams.date;var i=Object.assign(a,e.form);"edit"==e.dialogType?Object(d["lb"])(i.id,i).then((function(t){e.$message({message:"修改成功",type:"success"}),e.innerVisible=!1,e.getList()})):Object(d["t"])(i).then((function(t){e.$message({message:"新建成功",type:"success"}),e.innerVisible=!1,e.getList()}))}}))}}},ee=Z,te=(a("d44e"),Object(f["a"])(ee,W,Y,!1,null,null,null)),ae=te.exports,ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_f"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.returntvList.length>0,expression:"returntvList.length > 0"}],staticClass:"pbox page_f",staticStyle:{"padding-top":"20px"}},[a("el-row",[a("el-col",{attrs:{span:3}},[a("el-tabs",{staticClass:"left",staticStyle:{height:"500px"},attrs:{"tab-position":"left"},on:{"tab-click":e.tabsClick},model:{value:e.queryParams.channel_id,callback:function(t){e.$set(e.queryParams,"channel_id",t)},expression:"queryParams.channel_id"}},e._l(e.returntvList,(function(e,t){return a("el-tab-pane",{attrs:{label:e.name,name:""+e.id}})})),1)],1),a("el-col",{attrs:{span:20}},[a("div",{staticClass:"right"},[e.showlist?e._e():a("div",[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],staticStyle:{"margin-left":"20px"},attrs:{type:"primary",size:"small"},on:{click:e.adddata}},[e._v("新增")])],1),e.showlist?e._e():a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"margin-top":"20px"},attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},border:"",data:e.dataList}},[a("el-table-column",{attrs:{label:"id",align:"center",prop:"id","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"节目名称",align:"center",prop:"name","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"权重",align:"center",prop:"sort","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"状态",align:"center",prop:"name","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(a){return e.statuschange(t.row)}},model:{value:t.row.status,callback:function(a){e.$set(t.row,"status",a)},expression:"scope.row.status"}},e._l(e.statusoptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)]}}],null,!1,4181223627)}),a("el-table-column",{attrs:{label:"创建时间",align:"center",prop:"updated_at","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{width:"280px",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("Iconbutton",{attrs:{icontype:"dbjmd",label:"点播节目单"},on:{fatherMethod:function(a){return e.golist(t.row)}}}),a("Iconbutton",{attrs:{icontype:"xg",label:"修改"},on:{fatherMethod:function(a){return e.editdata(t.row)}}}),a("Iconbutton",{attrs:{icontype:"sc",label:"删除"},on:{fatherMethod:function(a){return e.deldata(t.row)}}})]}}],null,!1,3520136552)})],1),e.showlist?a("Pageclist",{attrs:{showlist:e.showlist,_channel_id:e._channel_id},on:{back:e.back}}):e._e()],1)])],1)],1),a("el-dialog",{attrs:{width:"540px",title:e.dialogTitle,"show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1,visible:e.innerVisible},on:{"update:visible":function(t){e.innerVisible=t}}},[a("el-form",{ref:"dataForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{"label-width":"120px",label:"节目名称:",prop:"name"}},[a("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"请输入节目名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"节目Logo/封面:",prop:"extra.cover[0].path"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.VUE_APP_BASE_API+"/api/upload/image",headers:e.importHeaders,name:"image","show-file-list":!1,"on-success":e.handleAvatarSuccess.bind(this,"cover"),"before-upload":e.beforeAvatarUpload}},[e.form.extra.cover[0].path?a("img",{staticClass:"avatar",attrs:{src:e.form.extra.cover[0].path}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{attrs:{"label-width":"120px",label:"权重(排序):",prop:"sort"}},[a("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"请输入权重"},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"绑定视频栏目",prop:"extra.vms_channel_type"}},[a("el-radio-group",{model:{value:e.form.extra.vms_channel_type,callback:function(t){e.$set(e.form.extra,"vms_channel_type",t)},expression:"form.extra.vms_channel_type"}},[a("el-radio",{attrs:{label:"cloud"}},[e._v("蓝云视频栏目")]),a("el-radio",{attrs:{label:"vms"}},[e._v("VMS视频栏目")])],1)],1),"cloud"==e.form.extra.vms_channel_type?a("el-form-item",{attrs:{"label-width":"120px",label:"蓝云视频栏目:",prop:"extra.vms_channel"}},[a("el-cascader",{key:"1",attrs:{props:{value:"code",label:"name",emitPath:!1},options:e.videocatalogoptions,"show-all-levels":!1},model:{value:e.form.extra.vms_channel,callback:function(t){e.$set(e.form.extra,"vms_channel",t)},expression:"form.extra.vms_channel"}})],1):e._e(),"vms"==e.form.extra.vms_channel_type?a("el-form-item",{attrs:{"label-width":"120px",label:"VMS视频栏目:",prop:"extra.vms_channel"}},[a("el-cascader",{key:"2",attrs:{props:{value:"id",label:"name",emitPath:!1},options:e.vmscatalogoptions,"show-all-levels":!1},model:{value:e.form.extra.vms_channel,callback:function(t){e.$set(e.form.extra,"vms_channel",t)},expression:"form.extra.vms_channel"}})],1):e._e(),a("el-form-item",{attrs:{"label-width":"120px",label:"是否启用:",prop:"status"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},e._l(e.statusoptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:e.innercloseDialog}},[e._v("取 消")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:e.innerenterDialog}},[e._v("确 定")])],1)],1)],1)},se=[],le=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page_c_list"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:e.back}},[e._v("返回上一级")]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"margin-top":"20px"},attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},border:"",data:e.dataList}},[a("el-table-column",{attrs:{label:"id",align:"center",prop:"script.id","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"节目名称",align:"center",prop:"script.title","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"所属节目",align:"center",prop:"channel.name","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"状态",align:"center",prop:"script.status","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{disabled:"",placeholder:"请选择"},on:{change:function(a){return e.statuschange(t.row)}},model:{value:t.row.script.status,callback:function(a){e.$set(t.row.script,"status",a)},expression:"scope.row.script.status"}},e._l(e.statusoptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)]}}])}),a("el-table-column",{attrs:{label:"创建时间",align:"center",prop:"script.created_at","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{width:"200px",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("Iconbutton",{attrs:{icontype:"sc",label:"删除"},on:{fatherMethod:function(a){return e.deldata(t.row)}}})]}}])})],1),a("el-dialog",{attrs:{width:"740px",title:e.dialogTitle,"show-close":!1,"close-on-press-escape":!1,"close-on-click-modal":!1,visible:e.innerVisible},on:{"update:visible":function(t){e.innerVisible=t}}},[a("el-form",{ref:"dataForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{"label-width":"120px",label:"点播节目单名称:",prop:"name"}},[a("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"请输入点播节目单名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"节目单封面:",prop:"cover"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.VUE_APP_BASE_API+"/api/upload/image",headers:e.importHeaders,name:"image","show-file-list":!1,"on-success":e.handleAvatarSuccess.bind(this,"name"),"before-upload":e.beforeAvatarUpload}},[e.form.name?a("img",{staticClass:"avatar",attrs:{src:e.form.name}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{attrs:{"label-width":"120px",label:"资源地址"}},[a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入内容"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[a("template",{slot:"prepend"},[e._v("超清")])],2),a("el-input",{staticStyle:{width:"400px",margin:"15px 0"},attrs:{placeholder:"请输入内容"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[a("template",{slot:"prepend"},[e._v("高清")])],2),a("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入内容"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[a("template",{slot:"prepend"},[e._v("标清")])],2)],1),a("el-form-item",{attrs:{"label-width":"120px",label:"播放时间:",prop:"play_time"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:e.form.play_time,callback:function(t){e.$set(e.form,"play_time",t)},expression:"form.play_time"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"基础点击量:",prop:"view_base_num"}},[a("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"请输入基础点击量"},model:{value:e.form.view_base_num,callback:function(t){e.$set(e.form,"view_base_num",t)},expression:"form.view_base_num"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"是否启用:",prop:"name"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},e._l(e.statusoptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:e.innercloseDialog}},[e._v("取 消")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:e.innerenterDialog}},[e._v("确 定")])],1)],1)],1)},re=[],oe={name:"page_c_list",props:{_channel_id:{type:Number,default:0},showlist:{type:Boolean,default:!0}},data:function(){var e=sessionStorage.getItem("token");return{importHeaders:{Authorization:e},dataList:[],loading:!0,statusoptions:[{value:1,label:"启用"},{value:0,label:"禁用"}],dialogTitle:"",innerVisible:!1,form:{},rules:{}}},created:function(){this.getList()},computed:{VUE_APP_BASE_API:function(){return this.imgurl2}},methods:{handleAvatarSuccess:function(e,t){this.form.name=t.path,this.$forceUpdate()},beforeAvatarUpload:function(e){var t=e.size/1024/1024<20;return t||this.$message.error("上传头像图片大小不能超过 20MB!"),t},back:function(){this.$emit("back",!1)},getList:function(){var e=this;this.loading=!0;var t={channel_id:this._channel_id,type:"tv_replay"};Object(d["Fb"])(t).then((function(t){e.loading=!1,console.log(t),e.dataList=t.data}))},deldata:function(e){var t=this;this.$confirm("此操作将永久删除id为"+e.script.id+"的节目, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(d["X"])(e.script.id).then((function(e){t.$message({message:"删除成功",type:"success"}),t.getList()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},innercloseDialog:function(){this.innerVisible=!1},innerenterDialog:function(){this.innerVisible=!1},initForm:function(){this.$refs.dataForm&&this.$refs.dataForm.resetFields(),this.form={status:1,extra:{cover:[{path:"",intro:""}],title:"",stream:[{path:"http://cv.cztv.com/zrtg_mit/36bd6a3457514fd7b67fd44940cf7a63/36bd6a3457514fd7b67fd44940cf7a63_h264_128k_mp3.mp3",rate:"128",format:"mp3",video_id:"581e88ee8cb649fa9692a07d0726c889",file_name:"/lanyun/2021/05/08/视频.mp4_47296197#h264_128k_mp3.mp3"},{path:"http://cv.cztv.com/zrtg_mit/36bd6a3457514fd7b67fd44940cf7a63/36bd6a3457514fd7b67fd44940cf7a63_H264_1500K_MP4.mp4",rate:"1500",format:"mp4",video_id:"455d73bc95d14f6a9fbaba3f1b03eda4",file_name:"/lanyun/2021/05/08/视频.mp4_47296197#H264_1500K_MP4.mp4"},{path:"http://cv.cztv.com/zrtg_mit/36bd6a3457514fd7b67fd44940cf7a63/36bd6a3457514fd7b67fd44940cf7a63_H264_800K_MP4.mp4",rate:"800",format:"mp4",video_id:"ef2418a8e8b4480fa172668c8e82734e",file_name:"/lanyun/2021/05/08/视频.mp4_47296197#H264_800K_MP4.mp4"},{path:"http://cv.cztv.com/zrtg_mit/36bd6a3457514fd7b67fd44940cf7a63/36bd6a3457514fd7b67fd44940cf7a63_H264_450K_MP4.mp4",rate:"450",format:"mp4",video_id:"07df38e0829a480abef854674ee6685f",file_name:"/lanyun/2021/05/08/视频.mp4_47296197#H264_450K_MP4.mp4"}]}}},editdata:function(e){console.log(e),this.initForm(),this.dialogTitle="编辑节目",this.dialogType="edit",this.innerVisible=!0}}},ne=oe,ce=(a("aca2"),a("4870"),Object(f["a"])(ne,le,re,!1,null,"f11da9ac",null)),de=ce.exports,pe={name:"page_f",props:{productId:{type:Number,default:0}},components:{Pageclist:de},data:function(){var e=sessionStorage.getItem("token");return{showlist:!1,_channel_id:"",importHeaders:{Authorization:e},loading:!0,dataList:[],tvList:[],videocatalogoptions:[],vmscatalogoptions:[],tvqueryParams:{page:1,pageSize:999,product_id:0,type:"radio_channel"},queryParams:{page:1,pageSize:999,channel_id:"",type:"radio_replay"},innerVisible:!1,dialogTitle:"",form:{},rules:{sort:[{required:!0,message:"请输入权重",trigger:"blur"}],status:[{required:!0,message:"请选择是否允许回看",trigger:"blur"}],"extra.cover[0].path":[{required:!0,message:"请选择节目Logo/封面",trigger:"blur"}]},dialogType:"add",statusoptions:[{value:1,label:"启用"},{value:0,label:"禁用"}]}},created:function(){this.getList(),this.initForm(),this.getvms_channels()},watch:{productId:function(e){this.tvqueryParams.product_id=e,this.gettvList()}},computed:{VUE_APP_BASE_API:function(){return this.imgurl2},returntvList:function(){return this.tvList.filter((function(e){return 1==e.status&&"1"==e.extra.has_replay}))}},methods:{back:function(e){this.showlist=e},golist:function(e){this._channel_id=e.id,this.showlist=!0},statuschange:function(e){var t=this;Object(d["cb"])(e.id,e).then((function(e){t.$message({message:"修改成功",type:"success"}),t.getList()}))},getvms_channels:function(){var e=this;Object(d["ic"])(1).then((function(t){e.videocatalogoptions=t})),Object(d["ic"])(0).then((function(t){function a(e){for(var t=0;t<e.length;t++)e[t].id=String(e[t].id),e[t].children&&a(e[t].children);return e}e.vmscatalogoptions=t,a(e.vmscatalogoptions)}))},handleAvatarSuccess:function(e,t){this.form.extra.cover[0].path=t.path,this.$forceUpdate()},beforeAvatarUpload:function(e){var t=e.size/1024/1024<20;return t||this.$message.error("上传头像图片大小不能超过 20MB!"),t},getList:function(){var e=this;this.showlist=!1,this.loading=!0;var t=this.queryParams.channel_id;t&&Object(d["wb"])(t).then((function(t){e.loading=!1,e.dataList=t}))},gettvList:function(){var e=this,t=this.tvqueryParams;Object(d["ec"])(t).then((function(t){e.tvList=t.data,e.tvList=e.tvList.filter((function(e){return 1==e.status&&"1"==e.extra.has_replay})),e.queryParams.channel_id=e.tvList[0]?""+e.tvList[0].id:"",e.getList()}))},tabsClick:function(){this.getList()},initForm:function(){this.$refs.dataForm&&this.$refs.dataForm.resetFields(),this.form={name:"",product_id:this.productId,father:this.queryParams.channel_id,sort:0,status:1,type:"tv_replay",extra:{cover:[{path:"",intro:""}],vms_channel:"",vms_channel_type:"cloud"}},console.log(this.form)},adddata:function(){this.initForm(),this.innerVisible=!0,this.dialogTitle="新增节目",this.dialogType="add"},editdata:function(e){var t=this;this.initForm(),this.dialogTitle="编辑节目",this.dialogType="edit",this.$nextTick((function(){t.form=JSON.parse(JSON.stringify(e))})),this.innerVisible=!0},deldata:function(e){var t=this;this.$confirm("此操作将永久删除栏目id为"+e.id+"的节目, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(d["I"])(e.id).then((function(e){t.$message({message:"删除成功",type:"success"}),t.getList()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},innercloseDialog:function(){this.innerVisible=!1},innerenterDialog:function(){var e=this;this.$refs["dataForm"].validate((function(t){if(t){var a={};a.channel_id=e.queryParams.channel_id;var i=Object.assign(a,e.form);"edit"==e.dialogType?Object(d["cb"])(i.id,i).then((function(t){e.$message({message:"修改成功",type:"success"}),e.innerVisible=!1,e.getList()})):Object(d["u"])(i).then((function(t){e.$message({message:"新建成功",type:"success"}),e.innerVisible=!1,e.getList()}))}}))}}},ue=pe,me=(a("4ba3"),a("e407"),a("f2e5"),Object(f["a"])(ue,ie,se,!1,null,"524c1853",null)),fe=me.exports,he={name:"radioTV",components:{Pagea:w,Pageb:S,Pagec:j,Paged:R,Pagee:ae,Pagef:fe},data:function(){return{activeName:"page_a",product_id:0,productList:[]}},created:function(){this.getproductList()},methods:{handleClick:function(e,t){1==e.index&&(this.$refs.page_b.gettvList(),this.$refs.page_b.initForm()),2==e.index&&(this.$refs.page_c.initForm(),this.$refs.page_c.gettvList()),4==e.index&&(this.$refs.page_e.gettvList(),this.$refs.page_e.initForm()),5==e.index&&(this.$refs.page_f.initForm(),this.$refs.page_f.gettvList())},getproductList:function(){var e=this;Object(d["Xb"])({}).then((function(t){e.productList=t.data,e.product_id=e.productList[0].id}))}}},ge=he,be=Object(f["a"])(ge,i,s,!1,null,null,null);t["default"]=be.exports},"10c1":function(e,t,a){"use strict";a("d7ad")},"1f3a":function(e,t,a){"use strict";a("8b4d")},3419:function(e,t,a){},4870:function(e,t,a){"use strict";a("9bef")},4945:function(e,t,a){},"4aef":function(e,t,a){},"4ba3":function(e,t,a){"use strict";a("594e")},"594e":function(e,t,a){},"6b2c":function(e,t,a){"use strict";a("f4bf")},"6c13":function(e,t,a){"use strict";a("4aef")},"7e1d":function(e,t,a){"use strict";a("e366")},"8b4d":function(e,t,a){},9686:function(e,t,a){},"9bef":function(e,t,a){},a982:function(e,t,a){"use strict";a("c8b6")},aca2:function(e,t,a){"use strict";a("df16")},ada5:function(e,t,a){},b00c:function(e,t,a){},b015:function(e,t,a){},b439:function(e,t,a){"use strict";a("b015")},b69f:function(e,t,a){"use strict";a("4945")},bedd:function(e,t,a){},c5f3:function(e,t,a){"use strict";a("b00c")},c612:function(e,t,a){},c8b6:function(e,t,a){},c938:function(e,t,a){"use strict";a("c612")},cb34:function(e,t,a){},cf0e:function(e,t,a){},d089:function(e,t,a){"use strict";a("3419")},d44e:function(e,t,a){"use strict";a("bedd")},d7ad:function(e,t,a){},df16:function(e,t,a){},e366:function(e,t,a){},e407:function(e,t,a){"use strict";a("ada5")},ead8:function(e,t,a){},ed22:function(e,t,a){"use strict";a("9686")},ef04:function(e,t,a){"use strict";a("cf0e")},f2e5:function(e,t,a){"use strict";a("ead8")},f4bf:function(e,t,a){},f6d9:function(e,t,a){"use strict";a("cb34")}}]);