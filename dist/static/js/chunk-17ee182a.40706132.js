(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-17ee182a"],{"1b6f":function(e,t,a){"use strict";a("80a2")},"293f":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"xl-convention"},[a("el-form",{ref:"queryForm",attrs:{model:e.queryParams,inline:!0,size:"small"}},[a("el-form-item",{attrs:{label:"所属产品:"}},[a("el-select",{attrs:{placeholder:"请选择所属产品"},on:{change:e.handleQuery},model:{value:e.queryParams.sourceId,callback:function(t){e.$set(e.queryParams,"sourceId",t)},expression:"queryParams.sourceId"}},e._l(e.productLists,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"规则名称:",prop:"ruleName"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入规则名称",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.ruleName,callback:function(t){e.$set(e.queryParams,"ruleName",t)},expression:"queryParams.ruleName"}})],1),a("el-form-item",{attrs:{label:"状态:",prop:"status"}},[a("el-select",{attrs:{placeholder:"请选择状态"},model:{value:e.queryParams.status,callback:function(t){e.$set(e.queryParams,"status",t)},expression:"queryParams.status"}},e._l(e.statusLists,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:e.handleAdd}},[e._v(" 新增 ")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:e.handleReset}},[e._v(" 重置 ")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:e.handleQuery}},[e._v(" 搜索 ")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},data:e.tableData,border:"","tooltip-effect":"dark"}},[a("el-table-column",{attrs:{label:"规则名称",align:"center",prop:"ruleName"}}),a("el-table-column",{attrs:{label:"所属模块",align:"center",prop:"typeLabel",showOverflowTooltip:""}}),a("el-table-column",{attrs:{label:"行为",align:"center",prop:"actionName",showOverflowTooltip:""}}),a("el-table-column",{attrs:{label:"积分",align:"center",prop:"risePoints"}}),a("el-table-column",{attrs:{label:"单日限制次数",align:"center",prop:"maxNumDayLabe"}}),a("el-table-column",{attrs:{label:"最高限制次数",align:"center",prop:"maxNumLabe"}}),a("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{on:{change:function(a){return e.handleChangeStatus(t.row)}},model:{value:t.row.status,callback:function(a){e.$set(t.row,"status",a)},expression:"scope.row.status"}},e._l(e.statusLists,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("Iconbutton",{attrs:{icontype:"xg",label:"修改"},on:{fatherMethod:function(a){return e.handleEdit(t.row)}}}),a("Iconbutton",{attrs:{icontype:"sc",label:"删除"},on:{fatherMethod:function(a){return e.handleDelete(t.row)}}})]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.queryParams.page,limit:e.queryParams.limit},on:{"update:page":function(t){return e.$set(e.queryParams,"page",t)},"update:limit":function(t){return e.$set(e.queryParams,"limit",t)},pagination:e.getList}}),a("el-dialog",{attrs:{width:"600px",title:e.dialog.title,visible:e.dialog.show},on:{"update:visible":function(t){return e.$set(e.dialog,"show",t)}}},[a("el-form",{ref:"dialogForm",attrs:{model:e.dialogForm,rules:e.dialogRules,size:"small","label-width":"120px"}},[a("el-form-item",{attrs:{label:"积分规则名称",prop:"ruleName"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{clearable:""},model:{value:e.dialogForm.ruleName,callback:function(t){e.$set(e.dialogForm,"ruleName",t)},expression:"dialogForm.ruleName"}})],1),a("el-form-item",{attrs:{label:"规则说明",prop:"ruleRemark"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入积分规则说明",type:"textarea",rows:6},model:{value:e.dialogForm.ruleRemark,callback:function(t){e.$set(e.dialogForm,"ruleRemark",t)},expression:"dialogForm.ruleRemark"}})],1),a("el-form-item",{attrs:{label:"所属模块",prop:"type"}},[a("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择规则类型",clearable:""},on:{change:e.selectType},model:{value:e.dialogForm.type,callback:function(t){e.$set(e.dialogForm,"type",t)},expression:"dialogForm.type"}},e._l(e.typeLists,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"行为",prop:"action"}},[a("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择行为",clearable:""},on:{change:e.selectActionType},model:{value:e.dialogForm.action,callback:function(t){e.$set(e.dialogForm,"action",t)},expression:"dialogForm.action"}},e._l(e.actionLists,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"(广电/直播)观看时长",prop:"duration"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入时长"},model:{value:e.dialogForm.duration,callback:function(t){e.$set(e.dialogForm,"duration",e._n(t))},expression:"dialogForm.duration"}})],1),a("el-form-item",{attrs:{label:"每次赠送积分",prop:"risePoints"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入赠送积分值"},model:{value:e.dialogForm.risePoints,callback:function(t){e.$set(e.dialogForm,"risePoints",e._n(t))},expression:"dialogForm.risePoints"}})],1),a("el-form-item",{attrs:{label:"单日限制次数",prop:"maxNumDay"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入次数(0表示不限)"},model:{value:e.dialogForm.maxNumDay,callback:function(t){e.$set(e.dialogForm,"maxNumDay",e._n(t))},expression:"dialogForm.maxNumDay"}})],1),a("el-form-item",{attrs:{label:"最高限制次数",prop:"maxNum"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入次数(0表示不限)"},model:{value:e.dialogForm.maxNum,callback:function(t){e.$set(e.dialogForm,"maxNum",e._n(t))},expression:"dialogForm.maxNum"}})],1),a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:e.dialogForm.status,callback:function(t){e.$set(e.dialogForm,"status",t)},expression:"dialogForm.status"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:function(t){e.dialog.show=!1}}},[e._v(" 取 消 ")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:e.enterDialog}},[e._v(" 确 定 ")])],1)],1)],1)},r=[],o=a("1da1"),i=a("5530"),n=(a("96cf"),a("8ba4"),a("a9e3"),a("d81d"),a("b0c0"),a("7db0"),a("d3b7"),a("0fea")),s={name:"Convention",data:function(){var e=function(e,t,a){if(console.log(t),null==t||""===t)return a(new Error("每日次数限制不能为空"));!Number.isInteger(t)||t<0?a(new Error("请输入正整数")):a()},t=function(e,t,a){if(null==t||""===t)return a(new Error("最高限制次数不能为空"));!Number.isInteger(t)||t<0?a(new Error("请输入正整数")):a()},a=function(e,t,a){if(null==t||""===t)return a(new Error("赠送积分值不能为空"));!Number.isInteger(t)||t<0?a(new Error("请输入正整数")):a()};return{productLists:[],statusLists:[{label:"启用",value:1},{label:"禁用",value:0}],typeLists:[{label:"新闻媒资",value:8e3},{label:"广电",value:8100},{label:"社区",value:8200},{label:"爆料",value:8300},{label:"互动",value:8400},{label:"个人信息/邀请注册",value:8500},{label:"举报反馈",value:8600},{label:"行为",value:8700}],actionLists:[],queryParams:{sourceId:"",ruleName:"",status:1,page:1,limit:10},total:0,loading:!1,tableData:[],dialog:{title:"新增",show:!1},dialogForm:{ruleName:"",ruleRemark:"",type:"",risePoints:"",action:"",actionName:"",duration:"",maxNumDay:"",maxNum:"",status:1},dialogRules:{ruleName:[{required:!0,message:"请输入规则名称",trigger:"blur"}],type:[{required:!0,message:"请选择规则类型",trigger:"change"}],action:[{required:!0,message:"请选择行为",trigger:"change"}],maxNumDay:[{required:!0,validator:e,trigger:"blur"}],maxNum:[{required:!0,validator:t,trigger:"blur"}],risePoints:[{required:!0,validator:a,trigger:"blur"}]}}},methods:{getProductList:function(){var e=this;return Object(n["mc"])({}).then((function(t){var a,l=t.data||[];e.productLists=l.map((function(e){return{label:e.name,value:e.source_id}})),e.queryParams.sourceId=null===l||void 0===l||null===(a=l[0])||void 0===a?void 0:a.source_id}))},selectType:function(e){this.getActionList(e)},selectActionType:function(e){var t;this.dialogForm.actionName=null===(t=this.actionLists.find((function(t){return t.value===e})))||void 0===t?void 0:t.label},getActionList:function(e){var t=this,a={modeCode:e};return Object(n["Db"])(a).then((function(e){200==e.code&&(t.actionLists=(e.data||[]).map((function(e){return{label:e.actionName,value:Number(e.actionCode)}})))}))},handleReset:function(){Object.assign(this.queryParams,{page:1}),this.resetForm("queryForm")},handleQuery:function(){this.queryParams.page=1,this.getList()},handleAdd:function(){this.resetForm("dialogForm"),this.dialog={show:!0,title:"新增"}},handleEdit:function(e){var t=e.id,a=e.type;this.getActionList(a),this.resetForm("dialogForm"),this.dialogForm={ruleName:e.ruleName,ruleRemark:e.ruleRemark,risePoints:e.risePoints,type:e.type,action:e.action,duration:e.duration,maxNumDay:e.maxNumDay,maxNum:e.maxNum,status:e.status},this.dialog={show:!0,title:"编辑",id:t}},enterDialog:function(){var e=this;this.$refs.dialogForm.validate((function(t){if(t){var a=Object(i["a"])(Object(i["a"])({},e.dialogForm),{},{sourceId:e.queryParams.sourceId}),l=e.removePropertyOfNullFor0(a),r=e.dialog.id?Object(n["ob"])(Object(i["a"])(Object(i["a"])({},l),{},{id:e.dialog.id})):Object(n["f"])(l);r.then((function(t){200==t.code&&(e.$message.success(t.msg),e.dialog.show=!1,e.getList())}))}}))},handleDelete:function(e){var t=this,a=e.id;Object(n["U"])({id:[a]}).then((function(e){200==e.code&&(t.$message.success(e.msg),t.getList())}))},handleChangeStatus:function(e){var t=this,a=e.sourceId,l=e.id,r=e.status,o=e.ruleName,i=e.ruleRemark,s=e.type,u=e.action,c=e.maxNumDay,m=e.maxNum,d=e.risePoints,p=e.actionName,b={sourceId:a,id:l,ruleName:o,ruleRemark:i,type:s,actionName:p,risePoints:d,action:u,maxNumDay:c,maxNum:m,status:r};Object(n["ob"])(b).then((function(e){200==e.code&&(t.$message.success(e.msg),t.getList())}))},getList:function(){var e=this,t=Object(i["a"])({},this.queryParams);this.loading=!0,Object(n["Ub"])(this.removePropertyOfNullFor0(t)).then((function(t){if(200==t.code){var a=t.data;e.tableData=(a.list||[]).map((function(t){var a;return Object(i["a"])(Object(i["a"])({},t),{},{typeLabel:null===(a=e.typeLists.find((function(e){return e.value===t.type})))||void 0===a?void 0:a.label,maxNumDayLabe:t.maxNumDay||"不限制",maxNumLabe:t.maxNum||"不限制"})})),e.total=a.totalCount}})).finally((function(){e.loading=!1}))}},created:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getProductList();case 2:e.getList();case 3:case"end":return t.stop()}}),t)})))()}},u=s,c=(a("1b6f"),a("2877")),m=Object(c["a"])(u,l,r,!1,null,"cc56c8e6",null);t["default"]=m.exports},"5e89":function(e,t,a){var l=a("861d"),r=Math.floor;e.exports=function(e){return!l(e)&&isFinite(e)&&r(e)===e}},"80a2":function(e,t,a){},"8ba4":function(e,t,a){var l=a("23e7"),r=a("5e89");l({target:"Number",stat:!0},{isInteger:r})}}]);