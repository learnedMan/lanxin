(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2dd5ddd5"],{"0496":function(t,e,a){var r=a("efe2");t.exports=function(t){return r((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}))}},"0f0c":function(t,e,a){"use strict";a("d204")},"10b1":function(t,e,a){var r=a("1c8b"),l=a("b747");r({target:"Number",stat:!0,forced:Number.parseInt!=l},{parseInt:l})},"13cc":function(t,e,a){"use strict";a.d(e,"B",(function(){return i})),a.d(e,"f",(function(){return o})),a.d(e,"u",(function(){return n})),a.d(e,"A",(function(){return s})),a.d(e,"r",(function(){return u})),a.d(e,"k",(function(){return c})),a.d(e,"q",(function(){return d})),a.d(e,"t",(function(){return m})),a.d(e,"e",(function(){return p})),a.d(e,"x",(function(){return g})),a.d(e,"b",(function(){return f})),a.d(e,"h",(function(){return h})),a.d(e,"n",(function(){return b})),a.d(e,"w",(function(){return v})),a.d(e,"a",(function(){return y})),a.d(e,"i",(function(){return x})),a.d(e,"o",(function(){return _})),a.d(e,"z",(function(){return w})),a.d(e,"d",(function(){return k})),a.d(e,"j",(function(){return F})),a.d(e,"p",(function(){return O})),a.d(e,"C",(function(){return $})),a.d(e,"g",(function(){return j})),a.d(e,"v",(function(){return q})),a.d(e,"m",(function(){return S})),a.d(e,"y",(function(){return P})),a.d(e,"c",(function(){return L})),a.d(e,"s",(function(){return N})),a.d(e,"l",(function(){return D}));var r=a("b775"),l=a("b60c");function i(t){return Object(r["a"])({url:"/api/broadcasts",method:"get",params:t})}function o(t){return Object(r["a"])({url:"/api/broadcasts",method:"post",data:t})}function n(t,e){return Object(r["a"])({url:"/api/broadcasts/".concat(t),method:"patch",data:e})}function s(t){return Object(r["a"])({url:"/api/broadcasts/".concat(t),method:"get"})}function u(t){return Object(r["a"])({url:"/api/broadcasts/".concat(t),method:"delete"})}function c(t,e){return Object(r["a"])({url:"/api/broadcasts/".concat(t),method:"patch",data:e})}function d(t){return Object(r["a"])({url:"/api/broadcastStreams/".concat(t),method:"delete"})}function m(t,e){return Object(r["a"])({url:"/api/broadcastStreams/".concat(t),method:"patch",data:e})}function p(t){return Object(r["a"])({url:"/api/broadcastStreams",method:"post",data:t})}function g(t){return Object(r["a"])({url:"/api/ad_places",method:"get",params:t})}function f(t){return Object(r["a"])({url:"/api/ad_places",method:"post",data:t})}function h(t,e){return Object(r["a"])({url:"/api/ad_places/".concat(t),method:"patch",data:e})}function b(t){return Object(r["a"])({url:"/api/product_versions/".concat(t),method:"delete"})}function v(t){return Object(r["a"])({url:"/api/ads",method:"get",params:t})}function y(t){return Object(r["a"])({url:"/api/ads",method:"post",data:t})}function x(t,e){return Object(r["a"])({url:"/api/ads/".concat(t),method:"patch",data:e})}function _(t){return Object(r["a"])({url:"/api/ads/".concat(t),method:"delete"})}function w(t){return Object(r["a"])({url:"/api/push",method:"get",params:t})}function k(t){return Object(r["a"])({url:"/api/push",method:"post",data:t})}function F(t,e){return Object(r["a"])({url:"/api/push/".concat(t),method:"patch",data:e})}function O(t){return Object(r["a"])({url:"/api/push/".concat(t),method:"delete"})}function $(t){return Object(l["a"])({url:"/internal/social/topic/list",method:"post",params:t})}function j(t){return Object(l["a"])({url:"/internal/social/topic/add",method:"post",data:t})}function q(t){return Object(l["a"])({url:"/internal/social/topic/update",method:"post",data:t})}function S(t){return Object(l["a"])({url:"/internal/social/topic/del",method:"post",data:t})}function P(t){return Object(l["a"])({url:"/internal/social/classify/list",method:"post",params:t})}function L(t){return Object(l["a"])({url:"/internal/social/classify/add",method:"post",data:t})}function N(t){return Object(l["a"])({url:"/internal/social/classify/update",method:"post",data:t})}function D(t){return Object(l["a"])({url:"/internal/social/classify/del",method:"post",data:t})}},"1b2e":function(t,e,a){var r=a("1c8b");r({target:"Number",stat:!0},{isNaN:function(t){return t!=t}})},"31a0":function(t,e,a){"use strict";var r=a("1c8b"),l=a("5197"),i=a("0496");r({target:"String",proto:!0,forced:i("link")},{link:function(t){return l(this,"a","href",t)}})},"46f0":function(t,e,a){"use strict";a("cd8a")},5197:function(t,e,a){var r=a("2732"),l=/"/g;t.exports=function(t,e,a,i){var o=String(r(t)),n="<"+e;return""!==a&&(n+=" "+a+'="'+String(i).replace(l,"&quot;")+'"'),n+">"+o+"</"+e+">"}},7740:function(t,e,a){},"8aa8":function(t,e,a){"use strict";a("7740")},9837:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"fade-transform",mode:"out-in"}},[a("keep-alive",{attrs:{exclude:t.exclude}},[a(t.component,{tag:"component",attrs:{params:t.params},on:{handleReturn:t.handleReturn,watchList:t.watchList}})],1)],1)},l=[],i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"xl-advert-list"},[a("el-form",{ref:"queryForm",attrs:{model:t.queryParams,inline:!0}},[a("el-form-item",{attrs:{label:"所属产品:"}},[a("el-select",{attrs:{placeholder:"请选择所属产品"},on:{change:t.handleQuery},model:{value:t.queryParams.product_id,callback:function(e){t.$set(t.queryParams,"product_id",e)},expression:"queryParams.product_id"}},t._l(t.productLists,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:"广告位:",prop:"name"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入关键字",clearable:"",size:"small"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleQuery(e)}},model:{value:t.queryParams.name,callback:function(e){t.$set(t.queryParams,"name",e)},expression:"queryParams.name"}})],1),a("el-form-item",{attrs:{label:"状态:",prop:"status"}},[a("el-select",{attrs:{size:"small",placeholder:"请选择类型",clearable:""},model:{value:t.queryParams.status,callback:function(e){t.$set(t.queryParams,"status",e)},expression:"queryParams.status"}},t._l(t.statusOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:t.handleReset}},[t._v(" 重置 ")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:t.handleQuery}},[t._v(" 搜索 ")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:t.handleAdd}},[t._v(" 新增 ")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},data:t.tableData,border:"","tooltip-effect":"dark"}},[a("el-table-column",{attrs:{label:"广告位名称",align:"center",prop:"name",showOverflowTooltip:""}}),a("el-table-column",{attrs:{label:"广告位类型",align:"center",showOverflowTooltip:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.getLabel(e.row.type)))]}}])}),a("el-table-column",{attrs:{label:"广告位描述",align:"center",prop:"intro"}}),a("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-select",{on:{change:function(a){return t.changeStatus(e.row)}},model:{value:e.row.status,callback:function(a){t.$set(e.row,"status",a)},expression:"scope.row.status"}},t._l(t.statusOptions.filter((function(t){return""!==t.value})),(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"260"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("Iconbutton",{attrs:{icontype:"ckxq",label:"广告列表"},on:{fatherMethod:function(a){return t.watchList(e.row)}}}),a("Iconbutton",{attrs:{icontype:"xg",label:"修改"},on:{fatherMethod:function(a){return t.handleEdit(e.row)}}}),a("Iconbutton",{attrs:{icontype:"sc",label:"删除"},on:{fatherMethod:function(a){return t.handleListDelete(e.row)}}})]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total > 0"}],attrs:{total:t.total,page:t.queryParams.page,limit:t.queryParams.pageSize},on:{"update:page":function(e){return t.$set(t.queryParams,"page",e)},"update:limit":function(e){return t.$set(t.queryParams,"pageSize",e)},pagination:t.getList}}),a("el-dialog",{attrs:{width:"600px",title:t.dialog.title,"close-on-click-modal":!1,visible:t.dialog.show},on:{"update:visible":function(e){return t.$set(t.dialog,"show",e)}}},[a("el-form",{ref:"dialogForm",attrs:{model:t.dialogForm,rules:t.dialogRules,"label-width":"120px",size:"small"}},[a("el-form-item",{attrs:{label:"所属产品:",prop:"product_id"}},[a("el-select",{attrs:{placeholder:"请选择所属产品",clearable:""},model:{value:t.dialogForm.product_id,callback:function(e){t.$set(t.dialogForm,"product_id",e)},expression:"dialogForm.product_id"}},t._l(t.productLists,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:"广告位名称:",prop:"name"}},[a("el-input",{staticStyle:{width:"194px"},attrs:{placeholder:"请输入广告位名称",clearable:""},model:{value:t.dialogForm.name,callback:function(e){t.$set(t.dialogForm,"name",e)},expression:"dialogForm.name"}})],1),a("el-form-item",{attrs:{label:"广告位类型:",prop:"type"}},[a("el-select",{attrs:{placeholder:"请选择广告位类型",clearable:""},model:{value:t.dialogForm.type,callback:function(e){t.$set(t.dialogForm,"type",e)},expression:"dialogForm.type"}},t._l(t.typeOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:"广告位描述:",prop:"intro"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入广告位描述",type:"textarea",row:6,clearable:""},model:{value:t.dialogForm.intro,callback:function(e){t.$set(t.dialogForm,"intro",e)},expression:"dialogForm.intro"}})],1),a("el-form-item",{attrs:{label:"广告位布局:"}},[a("el-form-item",{attrs:{"label-width":"100px",label:"左边距:",prop:"extra.layout.margin-left"}},[a("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"请输入左边距",clearable:""},on:{change:function(e){return t.numberChange(e,t.dialogForm.extra.layout,"margin-left")}},model:{value:t.dialogForm.extra.layout["margin-left"],callback:function(e){t.$set(t.dialogForm.extra.layout,"margin-left",t._n(e))},expression:"dialogForm.extra.layout['margin-left']"}}),t._v(" px ")],1),a("el-form-item",{attrs:{"label-width":"100px",label:"右边距:",prop:"extra.layout.margin-right"}},[a("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"请输入右边距",clearable:""},model:{value:t.dialogForm.extra.layout["margin-right"],callback:function(e){t.$set(t.dialogForm.extra.layout,"margin-right",t._n(e))},expression:"dialogForm.extra.layout['margin-right']"}}),t._v(" px ")],1),a("el-form-item",{attrs:{"label-width":"100px",label:"宽:",prop:"extra.layout.width"}},[a("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"请输入宽",clearable:""},model:{value:t.dialogForm.extra.layout.width,callback:function(e){t.$set(t.dialogForm.extra.layout,"width",t._n(e))},expression:"dialogForm.extra.layout.width"}}),t._v(" px ")],1),a("el-form-item",{attrs:{"label-width":"100px",label:"高:",prop:"extra.layout.height"}},[a("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"请输入高",clearable:""},model:{value:t.dialogForm.extra.layout.height,callback:function(e){t.$set(t.dialogForm.extra.layout,"height",t._n(e))},expression:"dialogForm.extra.layout.height"}}),t._v(" px ")],1)],1),a("el-form-item",{attrs:{label:"是否启用:",prop:"status"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:t.dialogForm.status,callback:function(e){t.$set(t.dialogForm,"status",e)},expression:"dialogForm.status"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:function(e){t.dialog.show=!1}}},[t._v(" 取 消 ")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:t.enterDialog}},[t._v(" 确 定 ")])],1)],1)],1)},o=[],n=a("e9ff"),s=a("06c4"),u=(a("e186"),a("2eeb"),a("053b"),a("10b1"),a("513c"),a("1b2e"),a("4194"),a("e18c"),a("0fea")),c=a("13cc"),d={name:"list",data:function(){return{productLists:[],statusOptions:[{label:"全部",value:""},{label:"启用",value:1},{label:"禁用",value:0}],typeOptions:[{label:"APP开机广告",value:7},{label:"APP顶部广告",value:8},{label:"矩形横幅",value:1},{label:"固定位置",value:2},{label:"漂浮广告",value:3},{label:"对联广告",value:4},{label:"文字广告",value:5},{label:"广告代码",value:6}],queryParams:{name:"",product_id:"",status:"",page:1,pageSize:10},total:0,loading:!1,tableData:[],dialog:{show:!1,title:"新增广告位"},dialogForm:{product_id:"",name:"",type:"",status:"",intro:"",extra:{layout:{"margin-left":"","margin-right":"",height:"",width:""}}},dialogRules:{product_id:[{required:!0,message:"请选择所属产品",trigger:"change"}],name:[{required:!0,message:"请输入广告位名称",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:"change"}]}}},methods:{getProductList:function(){var t=this;return Object(u["Xb"])({}).then((function(e){var a,r=e.data||[];t.productLists=r.map((function(t){return{label:t.name,value:t.id}})),t.queryParams.product_id=null===r||void 0===r||null===(a=r[0])||void 0===a?void 0:a.id}))},handleReset:function(){Object.assign(this.queryParams,{page:1}),this.resetForm("queryForm")},handleQuery:function(){this.queryParams.page=1,this.getList()},handleAdd:function(){this.resetForm("dialogForm"),this.dialog={title:"新增广告位",show:!0,isAdd:!0}},numberChange:function(t,e,a){t=Number.parseInt(t),e[a]=Number.isNaN(t)?"":t},changeStatus:function(t){var e,a,r,l,i=this,o={product_id:t.product_id,name:t.name,type:t.type,status:t.status,intro:t.intro,extra:{layout:{"margin-left":null!==(e=t.extra.layout["margin-left"])&&void 0!==e?e:"","margin-right":null!==(a=t.extra.layout["margin-right"])&&void 0!==a?a:"",height:null!==(r=t.extra.layout.height)&&void 0!==r?r:"",width:null!==(l=t.extra.layout.width)&&void 0!==l?l:""}}};Object(c["h"])(t.id,o).then((function(){i.$message.success("修改成功"),i.getList()}))},handleEdit:function(t){var e,a,r,l;this.resetForm("dialogForm"),this.dialog={title:"编辑广告位",show:!0,id:t.id},this.dialogForm={product_id:t.product_id,name:t.name,type:t.type,status:t.status,intro:t.intro,extra:{layout:{"margin-left":null!==(e=t.extra.layout["margin-left"])&&void 0!==e?e:"","margin-right":null!==(a=t.extra.layout["margin-right"])&&void 0!==a?a:"",height:null!==(r=t.extra.layout.height)&&void 0!==r?r:"",width:null!==(l=t.extra.layout.width)&&void 0!==l?l:""}}}},enterDialog:function(){var t,e=this;null===(t=this.$refs.dialogForm)||void 0===t||t.validate((function(t){var a,r=e.dialog,l=r.isAdd,i=r.id;t&&(a=l?Object(c["b"])(e.dialogForm):Object(c["h"])(i,e.dialogForm),a.then((function(){e.$message.success(l?"新增成功":"修改成功"),e.dialog.show=!1,e.getList()})))}))},handleListDelete:function(t){var e=this,a=t.id,r=t.name;this.$confirm("此操作将永久删除这条名称为".concat(r,"的广告位, 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(c["n"])(a).then((function(){e.$message({message:"删除成功",type:"success"}),e.getList()}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},watchList:function(t){this.$emit("watchList",{product_id:t.product_id,ad_place_id:t.id,name:t.name})},getLabel:function(t){var e,a;return null!==(e=null===(a=this.typeOptions.find((function(e){return e.value===t})))||void 0===a?void 0:a.label)&&void 0!==e?e:""},getList:function(){var t=this,e=Object(s["a"])({},this.queryParams);this.loading=!0,Object(c["x"])(this.removePropertyOfNullFor0(e)).then((function(e){t.tableData=e.data||[],t.total=e.total})).finally((function(){t.loading=!1}))}},created:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getProductList();case 2:t.getList();case 3:case"end":return e.stop()}}),e)})))()}},m=d,p=(a("8aa8"),a("cba8")),g=Object(p["a"])(m,i,o,!1,null,"53d65cbb",null),f=g.exports,h=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"xl-children-list"},[a("el-form",{ref:"queryForm",attrs:{model:t.queryParams,inline:!0}},[a("el-form-item",{attrs:{label:"广告标题:",prop:"keyword"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入关键字",clearable:"",size:"small"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleQuery(e)}},model:{value:t.queryParams.title,callback:function(e){t.$set(t.queryParams,"title",e)},expression:"queryParams.title"}})],1),a("el-form-item",{attrs:{label:"状态:",prop:"status"}},[a("el-select",{attrs:{size:"small",placeholder:"请选择类型",clearable:""},model:{value:t.queryParams.status,callback:function(e){t.$set(t.queryParams,"status",e)},expression:"queryParams.status"}},t._l(t.statusOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:t.handleReset}},[t._v(" 重置 ")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:t.handleQuery}},[t._v(" 搜索 ")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:t.handleAdd}},[t._v(" 新增 ")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"success",size:"mini"},on:{click:t.handleReturn}},[t._v(" 返回上一级 ")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},data:t.tableData,border:"","tooltip-effect":"dark"}},[a("el-table-column",{attrs:{label:"广告标题",align:"center",prop:"title",showOverflowTooltip:""}}),a("el-table-column",{attrs:{label:"广告类型",align:"center",showOverflowTooltip:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.getLabel(e.row.type)))]}}])}),a("el-table-column",{attrs:{label:"所属广告位",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.params.name))]}}])}),a("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-select",{attrs:{clearable:""},on:{change:function(a){return t.changeStatus(e.row)}},model:{value:e.row.status,callback:function(a){t.$set(e.row,"status",a)},expression:"scope.row.status"}},t._l(t.statusOptions.filter((function(t){return""!==t.value})),(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("Iconbutton",{attrs:{icontype:"xg",label:"修改"},on:{fatherMethod:function(a){return t.handleEdit(e.row)}}}),a("Iconbutton",{attrs:{icontype:"sc",label:"删除"},on:{fatherMethod:function(a){return t.handleListDelete(e.row)}}})]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total > 0"}],attrs:{total:t.total,page:t.queryParams.page,limit:t.queryParams.pageSize},on:{"update:page":function(e){return t.$set(t.queryParams,"page",e)},"update:limit":function(e){return t.$set(t.queryParams,"pageSize",e)},pagination:t.getList}}),t.dialog.show?a("el-dialog",{attrs:{width:"600px",title:t.dialog.title,"close-on-click-modal":!1,visible:t.dialog.show},on:{"update:visible":function(e){return t.$set(t.dialog,"show",e)}}},[a("el-form",{ref:"dialogForm",attrs:{model:t.dialogForm,rules:t.dialogRules,"label-width":"120px",size:"small"}},[a("el-form-item",{attrs:{label:"所属产品:",prop:"product_id",required:""}},[a("el-select",{attrs:{placeholder:"请选择所属产品",disabled:"",clearable:""},model:{value:t.dialogForm.product_id,callback:function(e){t.$set(t.dialogForm,"product_id",e)},expression:"dialogForm.product_id"}},t._l(t.productLists,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:"广告标题:",prop:"title"}},[a("el-input",{staticStyle:{width:"194px"},attrs:{placeholder:"请输入广告标题",clearable:""},model:{value:t.dialogForm.title,callback:function(e){t.$set(t.dialogForm,"title",e)},expression:"dialogForm.title"}})],1),a("el-form-item",{attrs:{label:"广告类型:",prop:"type"}},[a("el-select",{attrs:{placeholder:"请选择广告类型",clearable:""},on:{chnage:function(e){t.dialogForm.extra.url=""}},model:{value:t.dialogForm.type,callback:function(e){t.$set(t.dialogForm,"type",e)},expression:"dialogForm.type"}},t._l(t.typeOptions,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:"开始时间:",prop:"start_time"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择开始日期时间",align:"right",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss","picker-options":t.pickerOptionsStart},model:{value:t.dialogForm.start_time,callback:function(e){t.$set(t.dialogForm,"start_time",e)},expression:"dialogForm.start_time"}})],1),a("el-form-item",{attrs:{label:"结束时间:",prop:"end_time"}},[a("el-date-picker",{ref:"endTime",attrs:{type:"datetime",placeholder:"选择结束日期时间",align:"right",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss","picker-options":t.pickerOptionsEnd},model:{value:t.dialogForm.end_time,callback:function(e){t.$set(t.dialogForm,"end_time",e)},expression:"dialogForm.end_time"}}),a("el-checkbox",{staticStyle:{"margin-left":"10px"},on:{change:t.endAction},model:{value:t.dialogForm.unlimited,callback:function(e){t.$set(t.dialogForm,"unlimited",e)},expression:"dialogForm.unlimited"}},[t._v("不限制")])],1),a("el-form-item",{attrs:{label:"是否允许跳过:",prop:"extra.allow_skip"}},[a("el-radio-group",{model:{value:t.dialogForm.extra.allow_skip,callback:function(e){t.$set(t.dialogForm.extra,"allow_skip",e)},expression:"dialogForm.extra.allow_skip"}},[a("el-radio",{attrs:{label:"1"}},[t._v("是")]),a("el-radio",{attrs:{label:"0"}},[t._v("否")])],1)],1),a("el-form-item",{attrs:{label:"广告时长:",prop:"extra.duration"}},[a("el-input-number",{staticStyle:{width:"194px"},attrs:{controls:!1,precision:0,placeholder:"请输入时长(单位: 秒)",clearable:""},model:{value:t.dialogForm.extra.duration,callback:function(e){t.$set(t.dialogForm.extra,"duration",e)},expression:"dialogForm.extra.duration"}})],1),a("el-form-item",{attrs:{label:"广告角标:",prop:"extra.corner_mark"}},[a("el-checkbox",{attrs:{"true-label":"1","false-label":"0"},model:{value:t.dialogForm.extra.corner_mark,callback:function(e){t.$set(t.dialogForm.extra,"corner_mark",e)},expression:"dialogForm.extra.corner_mark"}},[t._v("显示广告角标,客户端开机广告倒计时或顶部图片是否展示")])],1),a("el-form-item",{attrs:{label:"广告"+(1===t.dialogForm.type?"图片":"视频")+":",prop:"extra.url"}},[1===t.dialogForm.type?a("upload-single",{model:{value:t.dialogForm.extra.url,callback:function(e){t.$set(t.dialogForm.extra,"url",e)},expression:"dialogForm.extra.url"}}):a("upload-video",{model:{value:t.dialogForm.extra.url,callback:function(e){t.$set(t.dialogForm.extra,"url",e)},expression:"dialogForm.extra.url"}})],1),a("el-form-item",{attrs:{label:"广告跳转:",prop:"extra.link.type"}},[a("el-radio-group",{model:{value:t.dialogForm.extra.link.type,callback:function(e){t.$set(t.dialogForm.extra.link,"type",e)},expression:"dialogForm.extra.link.type"}},t._l(t.linkOptions,(function(e){return a("el-radio",{key:e.value,attrs:{label:e.value}},[t._v(t._s(e.label))])})),1)],1),"outer_link"===t.dialogForm.extra.link.type?a("el-form-item",{attrs:{label:"链接地址:",prop:"extra.link.url"}},[a("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"请输入链接地址，如：https://www.baidu.com",clearable:""},model:{value:t.dialogForm.extra.link.url,callback:function(e){t.$set(t.dialogForm.extra.link,"url",e)},expression:"dialogForm.extra.link.url"}})],1):t._e(),"text"===t.dialogForm.extra.link.type?a("el-form-item",{attrs:{label:"文字提示:",prop:"extra.link.text"}},[a("el-input",{staticStyle:{width:"194px"},attrs:{placeholder:"请输入文字提示",clearable:""},model:{value:t.dialogForm.extra.link.text,callback:function(e){t.$set(t.dialogForm.extra.link,"text",e)},expression:"dialogForm.extra.link.text"}})],1):t._e(),"news"===t.dialogForm.extra.link.type?a("el-form-item",{attrs:{label:"新闻ID:",prop:"extra.link.id"}},[a("el-input",{staticStyle:{width:"194px"},attrs:{placeholder:"请输入新闻ID",clearable:""},model:{value:t.dialogForm.extra.link.id,callback:function(e){t.$set(t.dialogForm.extra.link,"id",e)},expression:"dialogForm.extra.link.id"}})],1):t._e()],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:function(e){t.dialog.show=!1}}},[t._v(" 取 消 ")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:t.enterDialog}},[t._v(" 确 定 ")])],1)],1):t._e()],1)},b=[],v=(a("31a0"),a("e60d")),y=a("9fd7"),x={props:{params:Object},components:{uploadSingle:v["a"],uploadVideo:y["a"]},data:function(){var t=this,e=function(e){return!!t.dialogForm.end_time&&e.getTime()>new Date(t.dialogForm.end_time).getTime()},a=function(e){return!!t.dialogForm.start_time&&e.getTime()<=new Date(t.dialogForm.start_time).getTime()-864e5},r=function(e,a,r){var l=t.dialogForm.end_time;return a?l&&new Date(l).getTime()<new Date(a).getTime()?r(new Error("开始时间不能大于结束时间!")):void r():r(new Error("请选择开始日期!"))},l=function(e,a,r){var l=t.dialogForm.start_time;return t.dialogForm.unlimited?r():a?l&&new Date(l).getTime()>new Date(a).getTime()?r(new Error("结束时间不能小于开始时间!")):void r():r(new Error("请选择结束日期!"))};return{productLists:[],statusOptions:[{label:"全部",value:""},{label:"启用",value:1},{label:"禁用",value:0}],typeOptions:[{label:"图片",value:1},{label:"视频",value:2}],queryParams:{title:"",status:"",page:1,pageSize:10},total:0,loading:!1,tableData:[],dialog:{show:!1,title:"新增广告位"},pickerOptionsStart:{disabledDate:e},pickerOptionsEnd:{disabledDate:a},linkOptions:[{label:"无跳转",value:"none"},{label:"链接",value:"outer_link"},{label:"新闻ID",value:"news"}],dialogForm:{product_id:"",title:"",type:1,start_time:"",end_time:"",unlimited:!1,extra:{allow_skip:"1",introduction:"",corner_mark:"1",url:"",duration:"",link:{type:"none",url:"",text:"",id:""}}},dialogRules:{title:[{required:!0,message:"请输入广告位名称",trigger:"blur"}],type:[{required:!0,message:"请选择广告类型",trigger:"change"}],start_time:[{required:!0,validator:r,trigger:"blur"}],end_time:[{required:!0,validator:l,trigger:"blur"}],"extra.url":[{required:!0,message:"请输入广告图片/视频",trigger:"blur"}],"extra.duration":[{type:"number",required:!0,message:"请输入广告时长",trigger:"blur"}],"extra.link.url":[{required:!0,message:"请输入链接地址",trigger:"blur"}],"extra.link.text":[{required:!0,message:"请输入文字提示",trigger:"blur"}],"extra.link.id":[{required:!0,message:"请输入新闻id",trigger:"blur"}]}}},methods:{getProductList:function(){var t=this;return Object(u["Xb"])({}).then((function(e){var a,r=e.data||[];t.productLists=r.map((function(t){return{label:t.name,value:t.id}})),t.queryParams.product_id=null===r||void 0===r||null===(a=r[0])||void 0===a?void 0:a.id}))},handleReset:function(){Object.assign(this.queryParams,{page:1}),this.resetForm("queryForm")},handleQuery:function(){this.queryParams.page=1,this.getList()},handleReturn:function(){this.$emit("handleReturn")},handleAdd:function(){this.resetForm("dialogForm"),this.dialog={title:"新增广告位",show:!0},this.dialogForm.product_id=this.params.product_id},endAction:function(){this.dialogForm.end_time="",this.dialogForm.unlimited&&this.$refs["dialogForm"].clearValidate(["end_time"])},handleEdit:function(t){var e,a,r,l;this.resetForm("dialogForm"),this.dialogForm={product_id:this.params.product_id,title:t.title,type:t.type,start_time:t.start_time,end_time:null!==(e=t.end_time)&&void 0!==e?e:"",unlimited:!t.end_time,extra:{allow_skip:t.extra.allow_skip,introduction:t.extra.introduction,corner_mark:t.extra.corner_mark,url:t.extra.url,duration:t.extra.duration,link:{type:t.extra.link.type,url:null!==(a=t.extra.link.url)&&void 0!==a?a:"",text:null!==(r=t.extra.link.text)&&void 0!==r?r:"",id:null!==(l=t.extra.link.id)&&void 0!==l?l:""}}},this.dialog={title:"新增广告位",show:!0,id:t.id}},enterDialog:function(){var t,e=this;null===(t=this.$refs.dialogForm)||void 0===t||t.validate((function(t){if(t){var a,r=e.dialog.id;"none"===e.dialogForm.extra.link.type&&(e.dialogForm.extra.link.id="",e.dialogForm.extra.link.url="");var l=Object(s["a"])({ad_place_id:e.params.ad_place_id},e.dialogForm);a=r?Object(c["i"])(r,l):Object(c["a"])(l),a.then((function(){e.$message.success(r?"修改成功":"新增成功"),e.dialog.show=!1,e.getList()}))}}))},handleListDelete:function(t){var e=this,a=t.id,r=t.title;this.$confirm("此操作将永久删除这条标题为".concat(r,"的广告, 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(c["o"])(a).then((function(){e.$message({message:"删除成功",type:"success"}),e.getList()}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},changeStatus:function(t){var e,a,r,l,i=this,o=t.id,n={product_id:this.params.product_id,ad_place_id:this.params.ad_place_id,title:t.title,type:t.type,start_time:t.start_time,end_time:null!==(e=t.end_time)&&void 0!==e?e:"",status:t.status,extra:{allow_skip:t.extra.allow_skip,introduction:t.extra.introduction,corner_mark:t.extra.corner_mark,url:t.extra.url,duration:t.extra.duration,link:{type:t.extra.link.type,url:null!==(a=t.extra.link.url)&&void 0!==a?a:"",text:null!==(r=t.extra.link.text)&&void 0!==r?r:"",id:null!==(l=t.extra.link.id)&&void 0!==l?l:""}}};Object(c["i"])(o,n).then((function(){i.$message.success("修改成功"),i.getList()}))},getLabel:function(t){var e,a;return null!==(e=null===(a=this.typeOptions.find((function(e){return e.value===t})))||void 0===a?void 0:a.label)&&void 0!==e?e:""},getList:function(){var t=this,e=this.params,a=e.product_id,r=e.ad_place_id,l=Object(s["a"])(Object(s["a"])({},this.queryParams),{},{product_id:a,ad_place_id:r});this.loading=!0,Object(c["w"])(this.removePropertyOfNullFor0(l)).then((function(e){t.tableData=e.data||[],t.total=e.total})).finally((function(){t.loading=!1}))}},created:function(){this.getProductList(),this.getList()}},_=x,w=(a("0f0c"),Object(p["a"])(_,h,b,!1,null,null,null)),k=w.exports,F={name:"AdvertList",components:{list:f,childrenList:k},data:function(){return{component:"list",exclude:["childrenList"],params:{}}},methods:{handleReturn:function(){this.component="list"},watchList:function(t){this.params=t,this.component="childrenList"}}},O=F,$=Object(p["a"])(O,r,l,!1,null,null,null);e["default"]=$.exports},"9fd7":function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"xl-upload-video"},[a("el-upload",{attrs:{name:"file",accept:"video/*",action:t.actionUrl,headers:t.uploadHeader,"show-file-list":!1,"on-success":t.handleUploadSuccess,"before-upload":t.beforeUploadVideo,"on-progress":t.handleProgress,"on-error":t.handleUploadError}},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}]},[t._v("上传视频"),a("i",{staticClass:"el-icon-upload el-icon--right",staticStyle:{"font-size":"14px"}})])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.value,expression:"value"}],staticClass:"xl-upload-video--play",on:{click:t.play}},[t._v(t._s(t.value)+" "),a("i",{staticClass:"el-icon-video-play"})]),a("el-progress",{directives:[{name:"show",rawName:"v-show",value:t.percentage,expression:"percentage"}],attrs:{percentage:t.percentage}}),t.dialog.show?a("el-dialog",{attrs:{width:"640px",title:"视频",visible:t.dialog.show},on:{"update:visible":function(e){return t.$set(t.dialog,"show",e)}}},[a("video",{attrs:{height:"400",width:"600",controls:""}},[a("source",{attrs:{src:t.dialog.url}}),t._v(" 您的浏览器不支持 video 标签。 ")])]):t._e()],1)},l=[],i=(a("e35a"),a("0d7a"),a("9302"),{props:{value:String},data:function(){return{percentage:0,dialog:{show:!1,url:""}}},computed:{actionUrl:function(){return this.videourl},uploadHeader:function(){var t=sessionStorage.getItem("token");return{Authorization:t}},type:function(){var t=this.value&&this.value.split(".");return(null===t||void 0===t?void 0:t[t.length-1])||""}},methods:{beforeUploadVideo:function(t){var e=t.size/1024/1024<=300,a=["video/mp4","video/ogg","video/flv","video/avi","video/wmv","video/rmvb","video/mov"];return-1==a.indexOf(t.type)?(this.$message.warning("请上传正确的视频格式: ".concat(a.join())),!1):e?(this.percentage=0,!0):(this.$message.warning("视频大小不能超过300MB"),!1)},handleProgress:function(){this.percentage=90},handleUploadSuccess:function(t,e,a){t.status_code>=200&&t.status_code<300?(this.percentage=100,this.$message.success("视频上传成功!"),this.$emit("input",t.path)):(this.$message.error("视频上传失败!"),this.percentage=0,a.length=0)},handleUploadError:function(){this.$message.error("上传失败, 请重新上传!"),this.percentage=0},play:function(){this.dialog={show:!0,url:this.value}}}}),o=i,n=(a("46f0"),a("cba8")),s=Object(n["a"])(o,r,l,!1,null,"664e7a03",null);e["a"]=s.exports},b747:function(t,e,a){var r=a("d890"),l=a("c10f").trim,i=a("fc8c"),o=r.parseInt,n=/^[+-]?0[Xx]/,s=8!==o(i+"08")||22!==o(i+"0x16");t.exports=s?function(t,e){var a=l(String(t));return o(a,e>>>0||(n.test(a)?16:10))}:o},cd8a:function(t,e,a){},d204:function(t,e,a){}}]);