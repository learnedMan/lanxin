(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3f84d196"],{"16f5":function(e,t,a){},"286e":function(e,t,a){},"36b6":function(e,t,a){},"46b8":function(e,t,a){"use strict";a("286e")},a9cb:function(e,t,a){"use strict";a("36b6")},c0db:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"xl-video"},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{staticClass:"xl-video-tab",attrs:{label:"vms视频库",name:"0"}},[e.showVmsChannel?a("xl-menu",{attrs:{menus:e.vmsChannel,"active-menu":e.vmsParams.defaultActive},on:{select:function(t){return e.menuChange(t,"vmsParams")}}}):e._e(),a("div",{staticClass:"xl-video-tab--content"},[a("el-form",{attrs:{model:e.vmsParams,inline:!0}},[a("el-form-item",{attrs:{label:"视频名称:",prop:"keyword"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入关键字",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getVideoList("vmsParams")}},model:{value:e.vmsParams.keyword,callback:function(t){e.$set(e.vmsParams,"keyword",t)},expression:"vmsParams.keyword"}})],1),a("el-form-item",{attrs:{label:"同步时间:"}},[a("el-date-picker",{attrs:{type:"daterange",align:"right",size:"small","unlink-panels":"","range-separator":"~","value-format":"yyyy-MM-dd","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},on:{change:function(t){return e.handleDateChange(t,"vmsParams")}},model:{value:e.vmsParams.dateValue,callback:function(t){e.$set(e.vmsParams,"dateValue",t)},expression:"vmsParams.dateValue"}})],1),a("el-form-item",[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.rest("vmsParams")}}},[e._v("重置")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.getVideoList("vmsParams")}}},[e._v(" 搜索 ")])],1)],1),a("div",{staticClass:"xl-video-tab--content-ul",staticStyle:{width:"98%"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},border:"",data:e.vmsVideo}},[a("el-table-column",{attrs:{label:"ID",width:"60px",align:"center",prop:"id"}}),a("el-table-column",{attrs:{label:"视频封面",width:"150px",align:"center",prop:"cover","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{staticStyle:{width:"50px",height:"50px"},attrs:{src:e.row.cover,alt:""}})]}}])}),a("el-table-column",{attrs:{label:"视频名称",align:"center",prop:"title","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"时长",align:"center",prop:"duration"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.getTime(t.row.duration)))])]}}])}),a("el-table-column",{attrs:{label:"同步时间",align:"center",prop:"created_at","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{width:"280px",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("Iconbutton",{attrs:{icontype:"bf",label:"播放"},on:{fatherMethod:function(a){return e.play(t.row)}}}),a("Iconbutton",{attrs:{icontype:"fz",label:"复制"},on:{fatherMethod:function(a){return e.openLink(t.row)}}}),a("Iconbutton",{attrs:{icontype:"xg",label:"修改"},on:{fatherMethod:function(a){return e.editdata(t.row,0)}}})]}}])})],1)],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.vmsParams.total>0,expression:"vmsParams.total > 0"}],attrs:{total:e.vmsParams.total,page:e.vmsParams.page,limit:e.vmsParams.pageSize},on:{"update:page":function(t){return e.$set(e.vmsParams,"page",t)},"update:limit":function(t){return e.$set(e.vmsParams,"pageSize",t)},pagination:function(t){return e.getVideoList("vmsParams")}}})],1)],1),a("el-tab-pane",{staticClass:"xl-video-tab",attrs:{label:"蓝云视频库",name:"1"}},[e.showXlChannel?a("xl-menuL",{attrs:{menus:e.xlChannel,"active-menu":e.xlParams.defaultActive},on:{select:function(t){return e.menuChange(t,"xlParams")}}}):e._e(),a("div",{staticClass:"xl-video-tab--content"},[a("el-form",{attrs:{model:e.xlParams,inline:!0}},[a("el-form-item",{attrs:{label:"视频名称:",prop:"keyword"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入关键字",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getVideoList("xlParams")}},model:{value:e.xlParams.keyword,callback:function(t){e.$set(e.xlParams,"keyword",t)},expression:"xlParams.keyword"}})],1),a("el-form-item",{attrs:{label:"同步时间:"}},[a("el-date-picker",{attrs:{type:"daterange",align:"right",size:"small","unlink-panels":"","range-separator":"~","value-format":"yyyy-MM-dd HH:mm:ss","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},on:{change:function(t){return e.handleDateChange(t,"xlParams")}},model:{value:e.xlParams.dateValue,callback:function(t){e.$set(e.xlParams,"dateValue",t)},expression:"xlParams.dateValue"}})],1),a("el-form-item",[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.rest("xlParams")}}},[e._v("重置")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.getVideoList("xlParams")}}},[e._v(" 搜索 ")])],1)],1),a("div",{staticClass:"xl-video-tab--content-ul",staticStyle:{width:"98%"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},border:"",data:e.xlVideo}},[a("el-table-column",{attrs:{label:"ID",width:"60px",align:"center",prop:"id"}}),a("el-table-column",{attrs:{label:"视频封面",width:"100px",align:"center",prop:"cover","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{staticStyle:{width:"50px",height:"50px"},attrs:{src:e.row.cover,alt:""}})]}}])}),a("el-table-column",{attrs:{label:"视频名称",align:"center",prop:"title","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"时长",align:"center",prop:"duration"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.getTime(t.row.duration)))])]}}])}),a("el-table-column",{attrs:{label:"同步时间",align:"center",prop:"created_at","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{width:"280px",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("Iconbutton",{attrs:{icontype:"bf",label:"播放"},on:{fatherMethod:function(a){return e.play(t.row)}}}),a("Iconbutton",{attrs:{icontype:"fz",label:"复制"},on:{fatherMethod:function(a){return e.openLink(t.row)}}}),a("Iconbutton",{attrs:{icontype:"xg",label:"修改"},on:{fatherMethod:function(a){return e.editdata(t.row,1)}}})]}}])})],1)],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.xlParams.total>0,expression:"xlParams.total > 0"}],attrs:{total:e.xlParams.total,page:e.xlParams.page,limit:e.xlParams.pageSize},on:{"update:page":function(t){return e.$set(e.xlParams,"page",t)},"update:limit":function(t){return e.$set(e.xlParams,"pageSize",t)},pagination:function(t){return e.getVideoList("xlParams")}}})],1)],1)],1),a("el-dialog",{attrs:{width:"640px",title:"视频",visible:e.VideoDialog.show},on:{close:e.closeVideo,"update:visible":function(t){return e.$set(e.VideoDialog,"show",t)}}},[a("video",{attrs:{height:"400",width:"600",controls:"",id:"video"}},[a("source",{attrs:{src:e.VideoDialog.url}}),e._v(" 您的浏览器不支持 video 标签。 ")])]),a("el-dialog",{attrs:{width:"640px",title:"修改",visible:e.editDialog.show},on:{"update:visible":function(t){return e.$set(e.editDialog,"show",t)}}},[a("el-form",{ref:"dataForm",attrs:{model:e.editDialog.form,rules:e.rules}},[a("el-form-item",{attrs:{"label-width":"120px",label:"视频名称:",prop:"name"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{autocomplete:"off",placeholder:"请输入视频名称"},model:{value:e.editDialog.form.name,callback:function(t){e.$set(e.editDialog.form,"name",t)},expression:"editDialog.form.name"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"视频封面图:",prop:"cover"}},[a("cropper",{attrs:{count:1,showTip:!1},model:{value:e.editDialog.cover,callback:function(t){e.$set(e.editDialog,"cover",t)},expression:"editDialog.cover"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:e.closeDialog}},[e._v("取 消")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:e.enterDialog}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{width:"80%",title:"链接地址",visible:e.linkDialog.show},on:{"update:visible":function(t){return e.$set(e.linkDialog,"show",t)}}},[a("el-table",{attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},border:"",data:e.linkDialog.tableData}},[a("el-table-column",{attrs:{label:"类型",align:"center",prop:"format",width:"80px","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"码率",align:"center",prop:"rate",width:"80px","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"地址",align:"center",prop:"path","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{width:"120px",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("Iconbutton",{attrs:{icontype:"fz",label:"复制"},on:{fatherMethod:function(a){return e.copy(t.row)}}})]}}])})],1)],1)],1)},l=[],i=a("2909"),o=a("5530"),r=(a("b0c0"),a("d81d"),a("4e82"),a("cc48")),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"xl-component-menu"},[a("el-scrollbar",{staticStyle:{width:"200px"},attrs:{"wrap-class":"scrollbar-wrapper"}},[a("el-menu",{attrs:{"default-active":e.activeMenu},on:{select:e.handleSelect}},e._l(e.menus,(function(e){return a("menu-item",{key:e.id,attrs:{item:e}})})),1)],1)],1)},c=[],u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.item.children?a("el-submenu",{attrs:{index:e.item.id+""}},[a("template",{slot:"title"},[a("span",[e._v(e._s(e.item.name))])]),e._l(e.item.children,(function(e){return a("menu-item",{key:e.id,attrs:{item:e}})}))],2):[a("el-menu-item",{attrs:{index:e.item.id+""}},[a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(e.item.name))])])]],2)},d=[],m={name:"menuItem",props:{item:{type:Object,required:!0}},data:function(){return{}}},p=m,f=a("2877"),h=Object(f["a"])(p,u,d,!1,null,"5165e2a8",null),v=h.exports,g={props:{menus:{type:Array,default:function(){return[]}},activeMenu:{type:String,default:"0"}},components:{menuItem:v},methods:{handleSelect:function(e){this.$emit("select",e)}}},b=g,w=(a("46b8"),Object(f["a"])(b,s,c,!1,null,"4736c2de",null)),x=w.exports,y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"xl-component-menu"},[a("el-scrollbar",{staticStyle:{width:"200px"},attrs:{"wrap-class":"scrollbar-wrapper"}},[a("el-menu",{attrs:{"default-active":e.activeMenu},on:{select:e.handleSelect}},e._l(e.menus,(function(e){return a("menu-item-l",{key:e.code,attrs:{item:e}})})),1)],1)],1)},k=[],_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.item.children?a("el-submenu",{attrs:{index:e.item.code}},[a("template",{slot:"title"},[a("span",[e._v(e._s(e.item.name))])]),e._l(e.item.children,(function(e){return a("menu-item-l",{key:e.code,attrs:{item:e}})}))],2):[a("el-menu-item",{attrs:{index:e.item.code}},[a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(e.item.name))])])]],2)},D=[],P={name:"menuItemL",props:{item:{type:Object,required:!0}},data:function(){return{}}},C=P,V=Object(f["a"])(C,_,D,!1,null,"5063bc94",null),O=V.exports,$={props:{menus:{type:Array,default:function(){return[]}},activeMenu:{type:String,default:"0"}},components:{MenuItemL:O},methods:{handleSelect:function(e){this.$emit("select",e)}}},S=$,M=(a("a9cb"),Object(f["a"])(S,y,k,!1,null,"583b425a",null)),j=M.exports,L=a("b49d"),z={components:{xlMenu:x,xlMenuL:j,Cropper:L["a"]},data:function(){return{activeName:"0",vmsChannel:[],vmsVideo:[],xlChannel:[],loading:!0,xlVideo:[],VideoDialog:{show:!1,url:""},editDialog:{show:!1,cover:[],form:{name:""}},rules:{name:[{required:!0,message:"请输入视频名称",trigger:"blur"}]},linkDialog:{show:!1,tableData:[]},pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},vmsParams:{keyword:"",startDate:"",endDate:"",dateValue:"",cloud:0,vms_channel_id:"",defaultActive:"",page:1,pageSize:10,total:0},xlParams:{keyword:"",startDate:"",endDate:"",dateValue:"",cloud:1,vms_channel_id:"",defaultActive:"",page:1,pageSize:10,total:0}}},computed:{site_id:function(){return this.$store.state.user.u_info.site_id},showVmsChannel:function(){return 0!==this.vmsChannel.length},showXlChannel:function(){return 0!==this.xlChannel.length}},methods:{play:function(e){var t=e.item_list[0].path;this.VideoDialog={show:!0,url:t}},rest:function(e){this[e].keyword="",this[e].dateValue="",this[e].startDate="",this[e].endDate=""},closeVideo:function(){var e=document.getElementById("video");e.pause()},openLink:function(e){this.linkDialog={show:!0,tableData:e.item_list}},copyLink:function(e){var t=e,a=document.createElement("input");a.value=t,document.body.appendChild(a),a.select(),document.execCommand("Copy"),this.$message({message:"复制成功",type:"success"}),a.remove()},copy:function(e){this.copyLink(e.path)},editdata:function(e,t){var a=[{path:e.cover,status:"success"}];this.editDialog={show:!0,cover:a,id:e.id,cloud:t,form:{name:e.title||""}},console.log("editDialog",this.editDialog)},closeDialog:function(){this.editDialog.show=!1},enterDialog:function(){var e=this;this.$refs["dataForm"].validate((function(t){if(t){var a={title:e.editDialog.form.name,cover:e.editDialog.cover[0].path,cloud:e.editDialog.cloud};console.log("封面图片",e.editDialog.cover),console.log("提交数据",a),Object(r["q"])(e.editDialog.id,a).then((function(t){200==t.status_code?(e.$message({message:"修改成功",type:"success"}),e.editDialog.show=!1,e.getVideoList(a.cloud?"xlParams":"vmsParams")):e.$message.warning(t.message)}))}}))},getDefaultActive:function(e){return e?e.children?this.getDefaultActive(e.children[0]):e.id+"":""},getDefaultActiveL:function(e){return e?e.children?this.getDefaultActiveL(e.children[0]):e.code+"":""},handleDateChange:function(e,t){var a=e||["",""];this[t].startDate=a[0],this[t].endDate=a[1]},menuChange:function(e,t){this.vmsVideo=[],this.xlVideo=[],this[t].vms_channel_id=e,this.getVideoList(t)},getTime:function(e){var t=parseInt(e),a=Math.floor(t/3600)<10?"0"+Math.floor(t/3600):Math.floor(t/3600),n=Math.floor(t/60%60)<10?"0"+Math.floor(t/60%60):Math.floor(t/60%60),l=Math.floor(t%60)<10?"0"+Math.floor(t%60):Math.floor(t%60),i="";return"00"!==a&&(i+="".concat(a,":")),"00"!==n&&(i+="".concat(n,":")),i+="".concat(l),i},handleClick:function(e){this.getVideoChannel(e.name)},changeVideo:function(e,t){Object.assign(t.customObj,{label:e.label,url:e.path})},handleChoose:function(e){var t=Object(o["a"])({},e),a={url:t.customObj.url,type:t.customObj.type,cover:t.cover,title:t.title};delete t.customObj,this.$emit("choose",t),this.$emit("choose-url",a)},getVideoChannel:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Object(r["R"])({cloud:t}).then((function(a){t?(e.xlChannel=a,e.xlParams.defaultActive=e.getDefaultActiveL(a[0]),e.xlParams.vms_channel_id=e.getDefaultActiveL(a[0])):(e.vmsChannel=a,e.vmsParams.defaultActive=e.getDefaultActive(a[0]),e.vmsParams.vms_channel_id=e.getDefaultActive(a[0])),e.getVideoList(t?"xlParams":"vmsParams")}))},getVideoList:function(e){var t,a=this;this.loading=!0,t=Object(o["a"])({},this[e]),delete t.dateValue,delete t.total,delete t.defaultActive,t.site_id=this.site_id;var n=["超清","高清","普清","模糊"];Object(r["S"])(t).then((function(t){console.log("res表格数据",t.data),a.loading=!1;var l=t.data.map((function(e){var t,a,l=e.item_list.sort((function(e,t){return t.rate-e.rate})).map((function(e,t){return Object(o["a"])(Object(o["a"])({},e),{},{label:n[t]})}));return Object(o["a"])(Object(o["a"])({},e),{},{customObj:{cover:e.cover,url:null===(t=l[0])||void 0===t?void 0:t.path,type:null===(a=l[0])||void 0===a?void 0:a.format,label:"超清",arr:l}})})),r=t.total;"vmsParams"===e?a.vmsVideo=Object(i["a"])(l):a.xlVideo=l,a[e].total=r}))}},created:function(){this.getVideoChannel()}},A=z,I=(a("d9ae"),Object(f["a"])(A,n,l,!1,null,null,null));t["default"]=I.exports},d9ae:function(e,t,a){"use strict";a("16f5")}}]);