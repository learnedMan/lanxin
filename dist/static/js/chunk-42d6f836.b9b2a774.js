(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-42d6f836"],{bbb4:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"classmanage"},[a("el-form",{ref:"queryForm",attrs:{model:e.queryParams,inline:!0}},[a("el-form-item",{attrs:{label:"所属产品："}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.product_id,callback:function(t){e.product_id=t},expression:"product_id"}},e._l(e.productList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"分类名称："}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入关键字",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.keywords,callback:function(t){e.$set(e.queryParams,"keywords",t)},expression:"queryParams.keywords"}})],1),a("el-form-item",{attrs:{label:"是否启用："}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.queryParams.status,callback:function(t){e.$set(e.queryParams,"status",t)},expression:"queryParams.status"}},e._l(e.statusoptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:e.handleQuery}},[e._v("搜索")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:e.initcondition}},[e._v("重置")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.adddata("")}}},[e._v("新增")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},border:"",data:e.dataList,"row-key":"name","tree-props":{children:"list"}}},[a("el-table-column",{attrs:{label:"分类id",align:"center",prop:"id"}}),a("el-table-column",{attrs:{label:"分类名称",align:"center",prop:"name","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"分类等级",align:"center",prop:"level","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("levelfilter")(t.row.level))+" ")]}}])}),a("el-table-column",{attrs:{label:"排序",align:"center",prop:"sort","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:"是否启用",align:"center",prop:"status","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(a){return e.statuschange(t.row)}},model:{value:t.row.status,callback:function(a){e.$set(t.row,"status",a)},expression:"scope.row.status"}},e._l(e.statusoptions,(function(t){return 2!=t.value?a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}}):e._e()})),1)]}}])}),a("el-table-column",{attrs:{label:"创建时间",align:"center",prop:"createdTime","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{width:"240px",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["1"==t.row.is_end?a("Iconbutton",{attrs:{icontype:"xz",label:"新增"},on:{fatherMethod:function(a){return e.adddata(t.row.id)}}}):e._e(),a("Iconbutton",{attrs:{icontype:"xg",label:"修改"},on:{fatherMethod:function(a){return e.editdata(t.row)}}}),a("Iconbutton",{attrs:{icontype:"sc",label:"删除"},on:{fatherMethod:function(a){return e.handleDelete(t.row)}}})]}}])})],1),a("el-dialog",{attrs:{width:"500px","close-on-click-modal":!1,title:e.dialogTitle,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"dataForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{"label-width":"120px",label:"分类名称",prop:"name"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{autocomplete:"off",placeholder:"请输入姓名"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"分类图标",prop:"image"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.VUE_APP_BASE_API+"/api/upload/image",headers:e.importHeaders,name:"image","show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.form.image?a("img",{staticClass:"avatar",attrs:{src:e.form.image}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{attrs:{"label-width":"120px",label:"分类排序",prop:"sort"}},[a("el-input-number",{attrs:{controls:!1,autocomplete:"off"},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"是否末级",prop:"is_end"}},[a("span",{staticStyle:{color:"red"}},[e._v("注意：选择后不可更改！")]),a("el-radio-group",{attrs:{disabled:!e.editfalg},model:{value:e.form.is_end,callback:function(t){e.$set(e.form,"is_end",t)},expression:"form.is_end"}},[a("el-radio",{staticStyle:{"margin-bottom":"10px"},attrs:{label:0}},[e._v("是(该分类作为末级，不可在此基础上创建子级)")]),a("el-radio",{attrs:{label:1}},[e._v("不是(该分类可创建子级，用户发帖对应子级)")])],1)],1),a("el-form-item",{attrs:{"el-form-item":"","label-width":"120px",label:"是否启用",prop:"status"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},e._l(e.statusoptions,(function(t){return 2!=t.value?a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}}):e._e()})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:e.closeDialog}},[e._v("取 消")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:e.enterDialog}},[e._v("确 定")])],1)],1)],1)},s=[],r=(a("4de4"),a("d3b7"),a("e9c4"),a("0fea")),o=a("13cc"),l={name:"classmanage",data:function(){var e=sessionStorage.getItem("token");return{importHeaders:{Authorization:e},radio:0,queryParams:{page:1,limit:9999,sourceId:0,keywords:"",status:2},editfalg:!1,product_id:0,productList:[],loading:!0,dataList:[],statusoptions:[{value:2,label:"全部"},{value:0,label:"启动"},{value:1,label:"禁用"}],dialogFormVisible:!1,form:{},rules:{name:[{required:!0,message:"请输入分类姓名",trigger:"blur"}],image:[{required:!0,message:"请选择分类图标",trigger:"blur"}],sort:[{required:!0,message:"请输入排序",trigger:"blur"}]},dialogType:"add",dialogTitle:""}},computed:{VUE_APP_BASE_API:function(){return this.imgurl2}},filters:{levelfilter:function(e){var t="";switch(e){case 1:t="一级";break;case 2:t="二级";break;default:t="级数别乱填";break}return t}},watch:{product_id:function(e){this.queryParams.sourceId=this.productList.filter((function(t){return t.id==e}))[0].source_id||0,this.getList()}},created:function(){this.getproductList(),this.initForm()},methods:{getproductList:function(){var e=this;Object(r["mc"])({}).then((function(t){e.productList=t.data,e.product_id=e.productList[0].id}))},forceUpdate:function(){this.$forceUpdate()},handleAvatarSuccess:function(e,t,a){this.form.image=e.path,this.$forceUpdate()},beforeAvatarUpload:function(e){var t=e.size/1024/1024<20;return t||this.$message.error("上传头像图片大小不能超过 20MB!"),t},initcondition:function(){this.queryParams.page=1,this.queryParams.limit=10,this.queryParams.status=2,this.queryParams.keywords=""},handleQuery:function(){this.loading=!0,this.queryParams.page=1,this.getList()},getList:function(){var e=this,t=JSON.parse(JSON.stringify(this.queryParams));Object(o["y"])(t).then((function(t){e.loading=!1,e.dataList=t.data.list}))},statuschange:function(e){var t=this;Object(o["s"])(e).then((function(e){t.$message({message:"修改成功",type:"success"}),t.getList()}))},adddata:function(e){this.initForm(),this.dialogTitle=e?"新增二级分类（id:"+e+")":"新增一级分类",this.form.pid=e||0,this.form.level=e?2:1,this.editfalg=!e,this.dialogType="add",this.dialogFormVisible=!0},initForm:function(){this.$refs.dataForm&&this.$refs.dataForm.resetFields(),this.editfalg=!1,this.form={pid:0,image:"",name:"",sort:0,status:0,is_end:0,level:2,sourceId:this.queryParams.sourceId}},editdata:function(e){this.initForm(),this.dialogTitle="编辑分类",this.dialogType="edit",this.form=JSON.parse(JSON.stringify(e)),this.dialogFormVisible=!0},handleDelete:function(e){var t=this,a={};a.id=e.id,a.sourceId=this.queryParams.sourceId,this.$confirm("此操作将永久删除ID为"+e.id+"的分类, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(o["l"])(a).then((function(e){t.$message({message:"删除成功",type:"success"}),t.getList()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},closeDialog:function(){this.initForm(),this.dialogFormVisible=!1},enterDialog:function(){var e=this;this.$refs["dataForm"].validate((function(t){if(t)if("edit"==e.dialogType){var a=e.form;Object(o["s"])(a).then((function(t){e.$message({message:"修改成功",type:"success"}),e.dialogFormVisible=!1,e.getList()}))}else{a=JSON.parse(JSON.stringify(e.form));Object(o["c"])(a).then((function(t){e.$message({message:"新建成功",type:"success"}),e.dialogFormVisible=!1,e.getList()}))}}))}}},n=l,u=(a("d0e3"),a("2877")),c=Object(u["a"])(n,i,s,!1,null,null,null);t["default"]=c.exports},d0e3:function(e,t,a){"use strict";a("dae0")},dae0:function(e,t,a){}}]);