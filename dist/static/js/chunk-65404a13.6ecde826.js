(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-65404a13"],{"0a03":function(e,t,a){},"10b1":function(e,t,a){var i=a("1c8b"),o=a("b747");i({target:"Number",stat:!0,forced:Number.parseInt!=o},{parseInt:o})},"13cc":function(e,t,a){"use strict";a.d(t,"B",(function(){return l})),a.d(t,"f",(function(){return n})),a.d(t,"u",(function(){return r})),a.d(t,"A",(function(){return s})),a.d(t,"r",(function(){return c})),a.d(t,"k",(function(){return u})),a.d(t,"q",(function(){return d})),a.d(t,"t",(function(){return p})),a.d(t,"e",(function(){return m})),a.d(t,"x",(function(){return h})),a.d(t,"b",(function(){return f})),a.d(t,"h",(function(){return g})),a.d(t,"n",(function(){return b})),a.d(t,"w",(function(){return v})),a.d(t,"a",(function(){return y})),a.d(t,"i",(function(){return w})),a.d(t,"o",(function(){return _})),a.d(t,"z",(function(){return x})),a.d(t,"d",(function(){return k})),a.d(t,"j",(function(){return j})),a.d(t,"p",(function(){return O})),a.d(t,"C",(function(){return D})),a.d(t,"g",(function(){return $})),a.d(t,"v",(function(){return P})),a.d(t,"m",(function(){return q})),a.d(t,"y",(function(){return S})),a.d(t,"c",(function(){return C})),a.d(t,"s",(function(){return L})),a.d(t,"l",(function(){return F}));var i=a("b775"),o=a("b60c");function l(e){return Object(i["a"])({url:"/api/broadcasts",method:"get",params:e})}function n(e){return Object(i["a"])({url:"/api/broadcasts",method:"post",data:e})}function r(e,t){return Object(i["a"])({url:"/api/broadcasts/".concat(e),method:"patch",data:t})}function s(e){return Object(i["a"])({url:"/api/broadcasts/".concat(e),method:"get"})}function c(e){return Object(i["a"])({url:"/api/broadcasts/".concat(e),method:"delete"})}function u(e,t){return Object(i["a"])({url:"/api/broadcasts/".concat(e),method:"patch",data:t})}function d(e){return Object(i["a"])({url:"/api/broadcastStreams/".concat(e),method:"delete"})}function p(e,t){return Object(i["a"])({url:"/api/broadcastStreams/".concat(e),method:"patch",data:t})}function m(e){return Object(i["a"])({url:"/api/broadcastStreams",method:"post",data:e})}function h(e){return Object(i["a"])({url:"/api/ad_places",method:"get",params:e})}function f(e){return Object(i["a"])({url:"/api/ad_places",method:"post",data:e})}function g(e,t){return Object(i["a"])({url:"/api/ad_places/".concat(e),method:"patch",data:t})}function b(e){return Object(i["a"])({url:"/api/product_versions/".concat(e),method:"delete"})}function v(e){return Object(i["a"])({url:"/api/ads",method:"get",params:e})}function y(e){return Object(i["a"])({url:"/api/ads",method:"post",data:e})}function w(e,t){return Object(i["a"])({url:"/api/ads/".concat(e),method:"patch",data:t})}function _(e){return Object(i["a"])({url:"/api/ads/".concat(e),method:"delete"})}function x(e){return Object(i["a"])({url:"/api/push",method:"get",params:e})}function k(e){return Object(i["a"])({url:"/api/push",method:"post",data:e})}function j(e,t){return Object(i["a"])({url:"/api/push/".concat(e),method:"patch",data:t})}function O(e){return Object(i["a"])({url:"/api/push/".concat(e),method:"delete"})}function D(e){return Object(o["a"])({url:"/internal/social/topic/list",method:"post",params:e})}function $(e){return Object(o["a"])({url:"/internal/social/topic/add",method:"post",data:e})}function P(e){return Object(o["a"])({url:"/internal/social/topic/update",method:"post",data:e})}function q(e){return Object(o["a"])({url:"/internal/social/topic/del",method:"post",data:e})}function S(e){return Object(o["a"])({url:"/internal/social/classify/list",method:"post",params:e})}function C(e){return Object(o["a"])({url:"/internal/social/classify/add",method:"post",data:e})}function L(e){return Object(o["a"])({url:"/internal/social/classify/update",method:"post",data:e})}function F(e){return Object(o["a"])({url:"/internal/social/classify/del",method:"post",data:e})}},"1b2e":function(e,t,a){var i=a("1c8b");i({target:"Number",stat:!0},{isNaN:function(e){return e!=e}})},"37ba":function(e,t,a){},"6c1e":function(e,t,a){},"9ba5":function(e,t,a){"use strict";a("6c1e")},"9d3e":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"xl-version-history"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},data:e.tableData,border:"","tooltip-effect":"dark"}},[a("el-table-column",{attrs:{prop:"created_at",label:"日期",align:"center"}}),a("el-table-column",{attrs:{prop:"user.name",label:"姓名","show-overflow-tooltip":"",align:"center"}}),a("el-table-column",{attrs:{prop:"operation",label:"操作记录","show-overflow-tooltip":"",align:"center"}}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.handleWatch(t.row)}}},[e._v(" 查看详情 ")])]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.queryParams.page,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"page",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getHistory}}),e.dialog.show?a("el-dialog",{attrs:{width:"1200px",top:"20px",title:e.dialog.title,visible:e.dialog.show,"append-to-body":""},on:{"update:visible":function(t){return e.$set(e.dialog,"show",t)}}},[a("scripts-details",{staticStyle:{padding:"10px",margin:"0"},attrs:{id:e.id,visible:e.dialog.show,typeDetails:e.type,"fetch-suggestions":e.fetchSuggestions,disabled:!0,disabledNews:!0},on:{"update:visible":function(t){return e.$set(e.dialog,"show",t)}}})],1):e._e()],1)},o=[],l=a("06c4"),n=(a("513c"),a("e18c"),a("cc48")),r=a("1d6e"),s=a("5fe8"),c={name:"versionHistory",components:{NewDetail:r["a"],scriptsDetails:s["default"]},props:{type:{type:String,default:"script"},id:{type:Number,required:!0}},data:function(){return{tableData:[],total:0,loading:!1,queryParams:{page:1,pageSize:10},dialog:{title:"查看详情",show:!1,id:""},fetchSuggestions:function(){return new Promise((function(e){return e()}))}}},methods:{getHistory:function(){var e=this,t=this.id,a=this.type;this.loading=!0,Object(n["G"])(Object(l["a"])({item_type:a,item_id:t},this.queryParams)).then((function(t){var a=t.data,i=t.total;e.tableData=a,e.total=i})).finally((function(){e.loading=!1}))},handleWatch:function(e){var t=e.extra;this.fetchSuggestions=function(){return new Promise((function(e){e(t.item)}))},this.dialog={title:"查看详情",show:!0}}},created:function(){this.getHistory()}},u=c,d=(a("9e1d"),a("cba8")),p=Object(d["a"])(u,i,o,!1,null,"c9ac419c",null);t["a"]=p.exports},"9e1d":function(e,t,a){"use strict";a("0a03")},"9ea2":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"fade-transform",mode:"out-in"}},[a("keep-alive",{attrs:{exclude:e.exclude}},[a(e.component,{tag:"component",attrs:{id:e.id},on:{"watch-detail":e.watchDetail,handleReturn:e.handleReturn}})],1)],1)},o=[],l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"xl-project-lists"},[i("el-form",{ref:"queryForm",attrs:{model:e.queryParams,inline:!0}},[i("el-form-item",{attrs:{label:"所属产品:"}},[i("el-select",{attrs:{placeholder:"请选择所属产品"},on:{change:e.handleQuery},model:{value:e.queryParams.product_id,callback:function(t){e.$set(e.queryParams,"product_id",t)},expression:"queryParams.product_id"}},e._l(e.productLists,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"标题:",prop:"keyword"}},[i("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入关键字",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.keyword,callback:function(t){e.$set(e.queryParams,"keyword",t)},expression:"queryParams.keyword"}})],1),i("el-form-item",{attrs:{label:"启用状态:",prop:"status"}},[i("el-select",{attrs:{size:"small",placeholder:"请选择状态",clearable:""},model:{value:e.queryParams.status,callback:function(t){e.$set(e.queryParams,"status",t)},expression:"queryParams.status"}},e._l(e.statusOptions,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"创建时间:",prop:"createDate"}},[i("el-date-picker",{attrs:{type:"daterange",align:"right",size:"small","unlink-panels":"","range-separator":"~","value-format":"yyyy-MM-dd HH:mm:ss","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.handleDateChange},model:{value:e.queryParams.createDate,callback:function(t){e.$set(e.queryParams,"createDate",t)},expression:"queryParams.createDate"}})],1),i("el-form-item",[i("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:e.handleReset}},[e._v(" 重置 ")]),i("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:e.handleQuery}},[e._v(" 搜索 ")]),i("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:e.handleAdd}},[e._v(" 新增 ")])],1)],1),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},data:e.tableData,border:"","tooltip-effect":"dark"}},[i("el-table-column",{attrs:{label:"专题ID",align:"center",prop:"id"}}),i("el-table-column",{attrs:{label:"标题",align:"center",prop:"name",showOverflowTooltip:""}}),i("el-table-column",{attrs:{label:"专题类型",align:"center",prop:"topic_type_label"}}),i("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-select",{on:{change:function(a){return e.changeStatus(t.row)}},model:{value:t.row.status,callback:function(a){e.$set(t.row,"status",a)},expression:"scope.row.status"}},e._l(e.statusOptions.filter((function(e){return""!==e.value})),(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)]}}])}),i("el-table-column",{attrs:{label:"创建时间",align:"center",prop:"created_at"}}),i("el-table-column",{attrs:{label:"操作",align:"center",width:"260"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("Iconbutton",{attrs:{icontype:"xg",label:"修改"},on:{fatherMethod:function(a){return e.handleEdit(t.row)}}}),i("Iconbutton",{attrs:{icontype:"sc",label:"删除"},on:{fatherMethod:function(a){return e.handleDelete(t.row)}}}),i("Iconbutton",{attrs:{icontype:"ckxq",label:"详情"},on:{fatherMethod:function(a){return e.watchList(t.row)}}})]}}])})],1),i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.queryParams.page,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"page",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}}),i("el-dialog",{attrs:{width:"600px","close-on-click-modal":!1,title:e.publishDialog.title,visible:e.publishDialog.show},on:{"update:visible":function(t){return e.$set(e.publishDialog,"show",t)}}},[i("el-form",{ref:"publishForm",attrs:{model:e.publishDialog.form,rules:e.publishDialog.rules}},[i("el-form-item",{attrs:{"label-width":"120px",label:"栏目",prop:"channel_id"}},[i("el-cascader",{staticStyle:{width:"350px"},attrs:{filterable:"",options:e.channelsList,props:e.cascaderOption,clearable:""},model:{value:e.publishDialog.form.channels,callback:function(t){e.$set(e.publishDialog.form,"channels",t)},expression:"publishDialog.form.channels"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:function(t){e.publishDialog.show=!1}}},[e._v(" 取 消 ")]),i("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:e.enterPublishDialog}},[e._v(" 确 定 ")])],1)],1),i("el-dialog",{attrs:{width:"800px",top:"10vh","close-on-click-modal":!1,title:e.dialog.title,visible:e.dialog.show},on:{"update:visible":function(t){return e.$set(e.dialog,"show",t)}}},[i("el-form",{ref:"dialogForm",attrs:{model:e.dialog.form,rules:e.dialog.rules,"label-width":"120px",size:"small"}},[i("el-form-item",{attrs:{label:"标题:",prop:"name"}},[i("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入标题",clearable:"",size:"small"},model:{value:e.dialog.form.name,callback:function(t){e.$set(e.dialog.form,"name",t)},expression:"dialog.form.name"}})],1),i("el-form-item",{attrs:{label:"简介:",prop:"extra.introduction"}},[i("el-input",{staticStyle:{width:"400px"},attrs:{rows:6,type:"textarea",placeholder:"请输入简介",clearable:"",size:"small"},model:{value:e.dialog.form.extra.introduction,callback:function(t){e.$set(e.dialog.form.extra,"introduction",t)},expression:"dialog.form.extra.introduction"}})],1),i("el-form-item",{attrs:{label:"封面样式:",prop:"extra.news_style.template_style"}},[i("el-radio-group",{attrs:{size:"small"},on:{change:e.handleCoverChange},model:{value:e.dialog.form.extra.news_style.template_style,callback:function(t){e.$set(e.dialog.form.extra.news_style,"template_style",t)},expression:"dialog.form.extra.news_style.template_style"}},e._l(e.template_styleLists,(function(t){return i("el-radio",{key:t.value,staticStyle:{"line-height":"32px"},attrs:{label:t.value}},[i("el-popover",{attrs:{placement:"top",trigger:"hover"}},[i("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(t.label))]),i("img",{attrs:{src:a("9795")("./"+t.img),alt:"",width:"300px"}})])],1)})),1)],1),i("el-form-item",{attrs:{prop:"extra.news_style.cover"}},[i("cropper",{attrs:{count:e.imgCount},model:{value:e.dialog.form.extra.news_style.cover,callback:function(t){e.$set(e.dialog.form.extra.news_style,"cover",t)},expression:"dialog.form.extra.news_style.cover"}})],1),i("el-form-item",{attrs:{label:"背景图:",prop:"extra.background"}},[i("upload-single",{model:{value:e.dialog.form.extra.background,callback:function(t){e.$set(e.dialog.form.extra,"background",t)},expression:"dialog.form.extra.background"}})],1),i("el-form-item",{attrs:{label:"(模板化)栏目:",prop:"extra.template_style"}},[i("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:e.catalogchange},model:{value:e.dialog.form.extra.template_style,callback:function(t){e.$set(e.dialog.form.extra,"template_style",t)},expression:"dialog.form.extra.template_style"}},e._l(e.catalogOptions,(function(e){return i("el-option",{key:e.id,attrs:{label:e.catalogName,value:""+e.catalogCode}})})),1)],1),i("el-form-item",{attrs:{label:"(模板化)样式:",prop:"extra.template_json_id"}},[i("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.dialog.form.extra.template_json_id,callback:function(t){e.$set(e.dialog.form.extra,"template_json_id",t)},expression:"dialog.form.extra.template_json_id"}},e._l(e.styleOptions,(function(e){return i("el-option",{key:e.id,attrs:{label:e.styleName,value:""+e.id}})})),1),e.dialog.form.extra.template_json_id?i("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],staticStyle:{"margin-left":"10px"},on:{click:e.yulanfn}},[e._v("预览")]):e._e()],1),i("el-form-item",{attrs:{label:"多级专题:",prop:"extra.topic_type"}},[i("el-switch",{attrs:{"active-value":"2","inactive-value":"1"},model:{value:e.dialog.form.extra.topic_type,callback:function(t){e.$set(e.dialog.form.extra,"topic_type",t)},expression:"dialog.form.extra.topic_type"}})],1),i("el-form-item",{attrs:{label:"允许分享:",prop:"extra.allow_share"}},[i("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:e.dialog.form.extra.allow_share,callback:function(t){e.$set(e.dialog.form.extra,"allow_share",t)},expression:"dialog.form.extra.allow_share"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:function(t){e.dialog.show=!1}}},[e._v("取 消")]),i("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:e.enterChangeDialog}},[e._v("确 定")])],1)],1)],1)},n=[],r=a("e9ff"),s=a("06c4"),c=(a("e186"),a("77ad"),a("2eeb"),a("053b"),a("4194"),a("9302"),a("e18c"),a("0fea")),u=a("b49d"),d=a("e60d"),p=a("cc48"),m={name:"ProjectLists",components:{Cropper:u["a"],uploadSingle:d["a"]},computed:{visitedViews:function(){return this.$store.state.tagsView.visitedViews}},data:function(){var e=this,t=function(t,a,i){var o=e.imgCount,l=e.dialog.form.extra.news_style.template_style;console.log("type",e.dialog.form),console.log("typeValue",l),Array.isArray(a)&&0!==a.length||"240"==l?a.slice(0,o).every((function(e){return e.path}))||"240"==l?i():i(new Error("请上传".concat(o,"张封面图片"))):i(new Error("请上传封面图片"))};return{queryParams:{product_id:"",type:"topic",status:"",keyword:"",createDate:"",startdate:"",enddate:"",page:1,pageSize:10},productLists:[],statusOptions:[{label:"全部",value:""},{label:"启用",value:1},{label:"禁用",value:0}],loading:!1,total:0,tableData:[],cascaderOption:{checkStrictly:!0,emitPath:!1,value:"id",label:"name",multiple:!0},channelsList:[],publishDialog:{show:!1,title:"发布栏目",form:{channels:"",special_channel_ids:""},rules:{channels:[{required:!0,message:"请选择栏目",trigger:"change"}]}},template_styleLists:[{label:"纯文本",value:"240",count:1,img:"1402-240.png"},{label:"三图下文本",value:"230",count:3,img:"1402-230.png"},{label:"三图上文本",value:"231",count:3,img:"1402-231.png"},{label:"左图+标题1",value:"220",count:1,img:"1402-220.png"},{label:"左图+标题2",value:"222",count:1,img:"1402-222.png"},{label:"右图+标题",value:"221",count:1,img:"1402-221.png"},{label:"播放器2",value:"211",count:1,img:"1402-211.png"},{label:"播放器3",value:"212",count:1,img:"1402-212.png"},{label:"大图1",value:"200",count:1,img:"1402-200.png"},{label:"大图2",value:"201",count:1,img:"1402-201.png"},{label:"大图3",value:"202",count:1,img:"1402-202.png"},{label:"大图4",value:"203",count:1,img:"1402-203.png"},{label:"大图7",value:"206",count:1,img:"1402-206.png"}],imgCount:1,catalogOptions:[],styleOptions:[],dialog:{show:!1,title:"新增专题",form:{name:"",status:1,extra:{news_style:{template_style:"240",cover:[]},allow_share:"0",template_style:"",template_json_id:"",topic_type:1,introduction:"",background:""}},rules:{name:[{required:!0,message:"请输入标题",trigger:"blur"}],"extra.news_style.template_style":[{required:!0,message:"请选择封面样式",trigger:"change"}],"extra.news_style.cover":[{validator:t,trigger:"change"}],"extra.background":[{required:!0,message:"请选择背景图片",trigger:"change"}]}}}},methods:{getProductList:function(){var e=this;return Object(c["fc"])({}).then((function(t){var a,i=t.data||[];e.productLists=i.map((function(e){return{label:e.name,value:e.id,source_id:e.source_id}})),e.queryParams.product_id=null===i||void 0===i||null===(a=i[0])||void 0===a?void 0:a.id}))},handleDateChange:function(e){var t=e||["",""];this.queryParams.startdate=t[0],this.queryParams.enddate=t[1]},handleReset:function(){Object.assign(this.queryParams,{page:1}),this.resetForm("queryForm")},handleQuery:function(){this.queryParams.page=1,this.getList()},handleAdd:function(){this.resetForm("dialogForm"),Object.assign(this.dialog,{title:"新增专题",show:!0,id:"",form:{name:"",status:1,extra:{news_style:{template_style:"240",cover:[]},allow_share:"0",template_style:"",template_json_id:"",topic_type:1,introduction:"",background:""}}})},changeStatus:function(e){var t=this,a=e.status,i=e.id;Object(p["p"])({status:a,ids:"".concat(i)}).then((function(){t.$message.success("修改状态成功"),t.getList()}))},handleEdit:function(e){var t,a;this.resetForm("dialogForm"),Object.assign(this.dialog,{title:"编辑专题",show:!0,id:e.id,form:{name:e.name,status:e.status,extra:{news_style:{template_style:(null===(t=e.extra.news_style)||void 0===t?void 0:t.template_style)||"240",cover:(null===(a=e.extra.news_style)||void 0===a?void 0:a.cover)||[]},allow_share:e.extra.allow_share||"0",template_style:e.extra.template_style,template_json_id:e.extra.template_json_id,topic_type:e.extra.topic_type,introduction:e.extra.introduction,background:e.extra.background}}}),this.catalogchange(e.extra.template_style,!1)},handleCoverChange:function(e){var t;this.imgCount=(null===(t=this.template_styleLists.find((function(t){return t.value===e})))||void 0===t?void 0:t.count)||1},enterChangeDialog:function(){var e,t=this;null===(e=this.$refs.dialogForm)||void 0===e||e.validate((function(e){if(e){var a=t.dialog.id,i={name:t.dialog.form.name,status:t.dialog.form.status,product_id:t.queryParams.product_id,type:"topic",extra:Object(s["a"])(Object(s["a"])({},t.dialog.form.extra),{},{news_style:{template_style:t.dialog.form.extra.news_style.template_style,cover:t.dialog.form.extra.news_style.cover.slice(0,t.imgCount)}})},o=a?Object(p["o"])(a,i):Object(p["f"])(i);o.then((function(){t.$message.success("".concat(t.dialog.title,"成功!")),t.dialog.show=!1,t.getList()}))}}))},handleDelete:function(e){var t=this,a=e.id;this.$confirm("此操作将永久删除这条ID为".concat(a,"的专题, 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(p["y"])(a).then((function(){t.$message({message:"删除成功",type:"success"}),t.getList()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},watchList:function(e){var t=e.id;this.$emit("watch-detail",t)},handlePublish:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var i,o,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.resetForm("publishForm"),i=e.id,o=e.extra.special_channel_script_id,l=[],!o){a.next=6;break}return a.next=6,Object(p["M"])(o).then((function(e){l=(e.channel||[]).map((function(e){return e.id}))}));case 6:Object.assign(t.publishDialog,{show:!0,form:{channels:l,special_channel_ids:i}});case 7:case"end":return a.stop()}}),a)})))()},enterPublishDialog:function(){var e,t=this;null===(e=this.$refs.publishForm)||void 0===e||e.validate((function(e){if(e){var a=t.publishDialog.form;Object(p["T"])({channels:a.channels.join(),special_channel_ids:a.special_channel_ids,type:"topic"}).then((function(){t.$message.success("发布成功"),t.publishDialog.show=!1,t.getList()}))}}))},getList:function(){var e=this,t=Object(s["a"])({},this.queryParams);delete t.createDate,this.loading=!0,Object(p["P"])(this.removePropertyOfNullFor0(t)).then((function(t){e.tableData=(t.data||[]).map((function(e){return Object(s["a"])(Object(s["a"])({},e),{},{topic_type_label:2==e.extra.topic_type?"多模块聚合":"简单聚合"})})),e.total=t.total||0})).finally((function(){e.loading=!1}))},getChannels:function(){var e=this;Object(c["Ab"])({with_special_channels:"topic"}).then((function(t){e.channelsList=t.map((function(e){return Object(s["a"])(Object(s["a"])({},e),{},{disabled:!0})})),e.changeChannelName(e.channelsList)}))},getCatelog:function(){var e=this;Object(c["C"])().then((function(t){e.catalogOptions=t.data.list}))},catalogchange:function(e){var t,a=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(i&&(this.dialog.form.extra.template_json_id=""),this.styleOptions=[],e){var o=null===(t=this.productLists.find((function(e){return e.value===a.queryParams.product_id})))||void 0===t?void 0:t.source_id,l={catalogCode:e,sourceId:o};Object(c["xc"])(l).then((function(e){a.styleOptions=e.data||[]}))}},yulanfn:function(){window.open(this.viewurl+this.dialog.form.extra.template_json_id)}},created:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("9999999"),t.next=3,e.getProductList();case 3:e.getList(),e.getChannels(),e.getCatelog();case 6:case"end":return t.stop()}}),t)})))()}},h=m,f=(a("d57c"),a("cba8")),g=Object(f["a"])(h,l,n,!1,null,"2edbe196",null),b=g.exports,v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"xl-project-detail"},[a("el-row",[e.hasChildTopic?a("el-col",{staticStyle:{"border-right":"1px solid #f3f3f3"},attrs:{span:6}},[a("h3",{staticClass:"xl-project-detail--title"},[a("span",[e._v("子专题")]),a("span",[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],staticStyle:{"margin-right":"6px"},attrs:{type:"text",icon:"el-icon-folder-add"},on:{click:e.handleTopicAdd}})],1)]),a("el-tree",{ref:"tree",attrs:{data:e.channelsList,props:e.props,"node-key":"id","default-expand-all":"","expand-on-click-node":!1},on:{"node-click":e.treeChange},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,o=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",{staticClass:"custom-tree-node--name"},[e._v(e._s(o.name))]),a("span",{on:{click:function(e){e.stopPropagation()}}},[o.id!==(e.channelsList[0]&&e.channelsList[0].id)?a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"text",icon:"el-icon-top"},on:{click:function(t){return t.stopPropagation(),e.handleTopicSort("up",o)}}}):e._e(),o.id!==(e.channelsList[e.channelsList.length-1]&&e.channelsList[e.channelsList.length-1].id)?a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"text",icon:"el-icon-bottom"},on:{click:function(t){return t.stopPropagation(),e.handleTopicSort("down",o)}}}):e._e(),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(t){return t.stopPropagation(),e.handleTopicEdit(o)}}}),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(t){return t.stopPropagation(),e.handleTopicRemove(i,o)}}}),a("el-switch",{staticStyle:{"margin-left":"10px"},attrs:{value:o.status,size:"small","active-value":1,"inactive-value":0},on:{input:function(t){return e.changeStatus(o)}}})],1)])}}],null,!1,2559711074)})],1):e._e(),a("el-col",{staticStyle:{"padding-left":"20px"},attrs:{span:e.hasChildTopic?18:24}},[a("div",{staticClass:"search"},[a("el-form",{ref:"queryForm",attrs:{model:e.queryParams,inline:!0}},[a("el-form-item",{attrs:{label:"新闻名称:",prop:"keyword"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入关键字",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.keyword,callback:function(t){e.$set(e.queryParams,"keyword",t)},expression:"queryParams.keyword"}})],1),a("el-form-item",{attrs:{label:"新闻类型:",prop:"type"}},[a("el-select",{attrs:{size:"small",placeholder:"请选择类型",clearable:""},model:{value:e.queryParams.type,callback:function(t){e.$set(e.queryParams,"type",t)},expression:"queryParams.type"}},e._l(e.typeOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"新闻状态:",prop:"status"}},[a("el-select",{attrs:{size:"small",placeholder:"请选择状态",clearable:""},model:{value:e.queryParams.status,callback:function(t){e.$set(e.queryParams,"status",t)},expression:"queryParams.status"}},e._l([{value:"",label:"全部"}].concat(e.statusOptions),(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"创建日期:",prop:"dateValue"}},[a("el-date-picker",{attrs:{size:"small",type:"daterange",align:"right","unlink-panels":"","range-separator":"~","value-format":"yyyy-MM-dd HH:mm:ss","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.handleDateChange},model:{value:e.queryParams.dateValue,callback:function(t){e.$set(e.queryParams,"dateValue",t)},expression:"queryParams.dateValue"}})],1),a("el-form-item",[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:e.handleReset}},[e._v(" 重置 ")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:e.handleQuery}},[e._v(" 搜索 ")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:e.handleAdd}},[e._v(" 新增新闻 ")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"success",size:"mini"},on:{click:e.handleReturn}},[e._v(" 返回上一级 ")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%",overflow:"auto"},attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},data:e.tableData,border:"","tooltip-effect":"dark"}},[e.isMobile?e._e():a("el-table-column",{attrs:{label:"新闻ID",align:"center",prop:"id"}}),e.isMobile?e._e():a("el-table-column",{attrs:{label:"新闻封面",align:"center",prop:"id",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-image",{staticStyle:{width:"80px",height:"45px"},attrs:{lazy:"",src:t.row.cover||e.useravatar,fit:"contain"}},[a("img",{staticStyle:{width:"100%",height:"100%"},attrs:{slot:"error",src:e.useravatar,alt:""},slot:"error"})])]}}],null,!1,1035214268)}),a("el-table-column",{attrs:{label:"新闻标题",align:"center",width:"140",prop:"title","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],staticClass:"watch-detail-btn",attrs:{type:"text"},on:{click:function(a){return e.handleWatch(t.row)}}},[e._v(e._s(t.row.title))])]}}])}),a("el-table-column",{attrs:{label:"新闻类型",align:"center",prop:"typeLabel"}}),a("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{size:"small"},on:{change:function(a){return e.statusChange(t.row)}},model:{value:t.row.status,callback:function(a){e.$set(t.row,"status",a)},expression:"scope.row.status"}},e._l(e.statusOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)]}}])}),e.isMobile?e._e():a("el-table-column",{attrs:{label:"编辑",align:"center",prop:"author_name","show-overflow-tooltip":!0}}),e.isMobile?e._e():a("el-table-column",{attrs:{label:"排序",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleSort(t.row)}}},[e._v(" "+e._s(t.row.sort)+" ")])]}}],null,!1,4080726915)}),e.isMobile?e._e():a("el-table-column",{attrs:{label:"发布时间",align:"center",prop:"created_at"}}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"verify-table-action"},[a("Iconbutton",{attrs:{icontype:1===t.row.top?"qxzd":"zd",label:1===t.row.top?"取消置顶":"置顶"},on:{fatherMethod:function(a){return e.handlePlaced(t.row)}}}),1===t.row.status?a("Iconbutton",{attrs:{icontype:"ckxq",label:"详情"},on:{fatherMethod:function(a){return e.handleWatch(t.row)}}}):e._e(),1!==t.row.status&&"broadcast"!==t.row.type?a("Iconbutton",{attrs:{icontype:"xg",label:"修改"},on:{fatherMethod:function(a){return e.handleEdit(t.row)}}}):e._e(),a("Iconbutton",{attrs:{icontype:"sc",label:"删除"},on:{fatherMethod:function(a){return e.handleListDelete(t.row)}}}),a("Iconbutton",{attrs:{icontype:"yl",label:"预览"},on:{fatherMethod:function(a){return e.handlePreview(t.row)}}}),a("Iconbutton",{attrs:{icontype:"ts",label:"推送"},on:{fatherMethod:function(a){return e.handlePush(t.row)}}}),a("Iconbutton",{attrs:{icontype:"czjl",label:"操作记录"},on:{fatherMethod:function(a){return e.handleHistory(t.row)}}})],1)]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.queryParams.page,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"page",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}})],1)],1),a("el-dialog",{attrs:{width:"400px",title:"调整排序",visible:e.sortDialog.show},on:{"update:visible":function(t){return e.$set(e.sortDialog,"show",t)}}},[a("el-form",{ref:"sortForm",attrs:{model:e.sortDialog.form,rules:e.sortDialog.rules,"label-width":"120px",size:"small"}},[a("el-form-item",{attrs:{label:"当前排序:",prop:"old"}},[a("el-input",{staticStyle:{width:"194px"},attrs:{disabled:""},model:{value:e.sortDialog.form.old,callback:function(t){e.$set(e.sortDialog.form,"old",t)},expression:"sortDialog.form.old"}})],1),a("el-form-item",{attrs:{label:"目标排序:",prop:"now"}},[a("el-input",{staticStyle:{width:"194px"},attrs:{placeholder:"请输入目标排序"},on:{change:e.numberChange},model:{value:e.sortDialog.form.now,callback:function(t){e.$set(e.sortDialog.form,"now",e._n(t))},expression:"sortDialog.form.now"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:function(t){e.sortDialog.show=!1}}},[e._v(" 取 消 ")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:e.enterSortDialog}},[e._v(" 确 定 ")])],1)],1),e.detailDialog.show?a("el-dialog",{attrs:{width:"1200px",title:"查看",top:"20px",visible:e.detailDialog.show},on:{"update:visible":function(t){return e.$set(e.detailDialog,"show",t)}}},[a("scripts-details",{staticStyle:{padding:"10px",margin:"0"},attrs:{typeDetails:"news",id:e.detailDialog.id,visible:e.detailDialog.show,disabledNews:e.detailDialog.disabled},on:{"update:visible":function(t){return e.$set(e.detailDialog,"show",t)},refresh:e.refresh}})],1):e._e(),a("el-dialog",{attrs:{width:"500px",title:e.pushDialog.title,visible:e.pushDialog.show},on:{"update:visible":function(t){return e.$set(e.pushDialog,"show",t)}}},[a("el-form",{ref:"dialogForm",attrs:{model:e.dialogForm,rules:e.dialogRules,"label-width":"120px",size:"small"}},[a("el-form-item",{attrs:{label:"推送终端:",prop:"push_to.terminal"}},[a("el-select",{attrs:{placeholder:"请选择终端",clearable:""},model:{value:e.dialogForm.push_to.terminal,callback:function(t){e.$set(e.dialogForm.push_to,"terminal",t)},expression:"dialogForm.push_to.terminal"}},e._l(e.terminal,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"消息内容:",prop:"title"}},[a("el-input",{staticStyle:{width:"194px"},attrs:{placeholder:"请输入消息内容",clearable:""},model:{value:e.dialogForm.title,callback:function(t){e.$set(e.dialogForm,"title",t)},expression:"dialogForm.title"}})],1),a("el-form-item",{attrs:{label:"消息详情:",prop:"content"}},[a("el-input",{staticStyle:{width:"194px"},attrs:{placeholder:"请输入消息详情",clearable:"",type:"textarea",row:4},model:{value:e.dialogForm.content,callback:function(t){e.$set(e.dialogForm,"content",t)},expression:"dialogForm.content"}})],1),a("el-form-item",{attrs:{label:"链接到:",prop:"linked_to.id"}},[a("el-input",{staticStyle:{width:"194px"},attrs:{disabled:""},model:{value:e.dialogForm.linked_to.title,callback:function(t){e.$set(e.dialogForm.linked_to,"title",t)},expression:"dialogForm.linked_to.title"}})],1),a("el-form-item",{attrs:{label:"推送图片:",prop:"cover"}},[a("upload-single",{model:{value:e.dialogForm.cover,callback:function(t){e.$set(e.dialogForm,"cover",t)},expression:"dialogForm.cover"}})],1),a("el-form-item",{attrs:{label:"推送时间:",prop:"push_time"}},[a("el-date-picker",{directives:[{name:"show",rawName:"v-show",value:e.switchVal,expression:"switchVal"}],staticStyle:{width:"194px","margin-right":"10px"},attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择日期时间","picker-options":e.pickerOptions},on:{focus:e.pickerFocus},model:{value:e.dialogForm.push_time,callback:function(t){e.$set(e.dialogForm,"push_time",t)},expression:"dialogForm.push_time"}}),a("el-radio",{attrs:{label:!0},model:{value:e.switchVal,callback:function(t){e.switchVal=t},expression:"switchVal"}},[e._v("自定义时间")]),a("el-radio",{attrs:{label:!1},model:{value:e.switchVal,callback:function(t){e.switchVal=t},expression:"switchVal"}},[e._v("立即推送")])],1),a("el-form-item",{attrs:{label:"是否推送给个人:",prop:"push_to.type"}},[a("el-radio-group",{model:{value:e.dialogForm.push_to.type,callback:function(t){e.$set(e.dialogForm.push_to,"type",t)},expression:"dialogForm.push_to.type"}},[a("el-radio",{attrs:{label:"all"}},[e._v("否")]),a("el-radio",{attrs:{label:"single"}},[e._v("是")])],1)],1),"single"===e.dialogForm.push_to.type?a("el-form-item",{attrs:{label:"客户端ID:",prop:"push_to.cid"}},[a("el-input",{staticStyle:{width:"194px"},attrs:{placeholder:"请输入客户端ID",clearable:""},model:{value:e.dialogForm.push_to.cid,callback:function(t){e.$set(e.dialogForm.push_to,"cid",t)},expression:"dialogForm.push_to.cid"}})],1):e._e()],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:function(t){e.pushDialog.show=!1}}},[e._v(" 取 消 ")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:e.enterPushDialog}},[e._v(" 确 定 ")])],1)],1),e.history.show?a("el-dialog",{attrs:{width:"700px",title:"操作记录",visible:e.history.show},on:{"update:visible":function(t){return e.$set(e.history,"show",t)}}},[a("version-history",{attrs:{id:e.history.id,type:"news"}})],1):e._e(),a("el-dialog",{attrs:{width:"500px",title:e.topicDialog.title,visible:e.topicDialog.show},on:{"update:visible":function(t){return e.$set(e.topicDialog,"show",t)}}},[a("el-form",{ref:"topicForm",attrs:{model:e.topicDialog.form,rules:e.topicDialog.rules,"label-width":"120px",size:"small"}},[a("el-form-item",{attrs:{label:"标题:",prop:"name"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入专题名",clearable:"",size:"small"},model:{value:e.topicDialog.form.name,callback:function(t){e.$set(e.topicDialog.form,"name",t)},expression:"topicDialog.form.name"}})],1),a("el-form-item",{attrs:{label:"(模板化)栏目:",prop:"extra.template_style"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:e.catalogchange},model:{value:e.topicDialog.form.extra.template_style,callback:function(t){e.$set(e.topicDialog.form.extra,"template_style",t)},expression:"topicDialog.form.extra.template_style"}},e._l(e.catalogOptions,(function(e){return a("el-option",{key:e.id,attrs:{label:e.catalogName,value:""+e.catalogCode}})})),1)],1),a("el-form-item",{attrs:{label:"(模板化)样式:",prop:"extra.template_json_id"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.topicDialog.form.extra.template_json_id,callback:function(t){e.$set(e.topicDialog.form.extra,"template_json_id",t)},expression:"topicDialog.form.extra.template_json_id"}},e._l(e.styleOptions,(function(e){return a("el-option",{key:e.id,attrs:{label:e.styleName,value:""+e.id}})})),1),e.topicDialog.form.extra.template_json_id?a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],staticStyle:{"margin-left":"10px"},on:{click:e.yulanfn}},[e._v("预览")]):e._e()],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:function(t){e.topicDialog.show=!1}}},[e._v("取 消")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:e.enterTopicChange}},[e._v("确 定")])],1)],1)],1)},y=[],w=a("8955"),_=(a("b4fb"),a("15d9"),a("3466"),a("08d5"),a("10b1"),a("513c"),a("1b2e"),a("31a0"),a("13cc")),x=a("e7e2"),k=a.n(x),j=a("469d"),O=a("1d6e"),D=a("5fe8"),$=a("9d3e"),P={name:"ProjectDetail",props:["id"],components:{NewDetail:O["a"],scriptsDetails:D["default"],VersionHistory:$["a"]},data:function(){var e=function(){var e=new Date((new Date).getTime()+1e3),t=e.getHours(),a=e.getMinutes(),i=e.getSeconds();return"".concat(t,":").concat(a,":").concat(i," - 23:59:59")};return{switchAction:!1,channelsList:[],props:Object.freeze({label:"name",children:"child"}),currentKey:"",hasChildTopic:!1,useravatar:a("3f1e"),statusOptions:[{label:"已上线",value:1},{label:"待审核",value:0},{label:"已下线",value:2}],typeOptions:[{label:"全部",value:""},{label:"新闻",value:"news"},{label:"图集",value:"album"},{label:"视频",value:"video"},{label:"外链",value:"outer_link"},{label:"直播间",value:"broadcast"},{label:"专题",value:"topic"},{label:"服务",value:"service"},{label:"电视直播",value:"tv_live"},{label:"电视点播",value:"tv_replay"},{label:"广播直播",value:"radio_live"},{label:"广播点播",value:"radio_replay"}],queryParams:{startdate:"",enddate:"",status:"",type:"",keyword:"",dateValue:"",pageSize:10,page:1},total:0,loading:!1,tableData:[],sortDialog:{show:!1,id:"",form:{old:"",now:""},rules:{now:[{required:!0,message:"请输入目标排序",trigger:"blur"}]}},detailDialog:{show:!1,id:"",disabled:!1},pushDialog:{show:!1,title:"新增推送"},pickerOptions:{selectableRange:e(),disabledDate:function(e){return e.getTime()<(new Date).getTime()-864e5}},switchVal:!1,product_id:"",terminal:[{label:"全部",value:3},{label:"ios",value:2},{label:"安卓",value:1}],dialogForm:{title:"",content:"",cover:"",linked_to:{route_type:"news",type:"",id:"",title:""},push_to:{type:"all",terminal:"",cid:""},push_time:""},dialogRules:{title:[{required:!0,message:"请输入消息内容",trigger:"blur"}],content:[{required:!0,message:"请输入消息详情",trigger:"blur"}],push_time:[{required:!0,message:"请选择推送时间",trigger:"change"}],"push_to.cid":[{required:!0,message:"请输入客户端ID",trigger:"blur"}],"linked_to.id":[{required:!0,message:"请选择链接到的内容",trigger:"change"}],"push_to.terminal":[{required:!0,message:"请选择推送终端",trigger:"change"}]},history:{show:!1,id:""},catalogOptions:[],styleOptions:[],productLists:[],topicDialog:{show:!1,title:"新增",form:{name:"",extra:{template_style:"",template_json_id:""}},rules:{name:[{required:!0,message:"请输入标题",trigger:"blur"}]}}}},methods:{getProductList:function(){var e=this;return Object(c["fc"])({}).then((function(t){var a=t.data||[];e.productLists=a.map((function(e){return{label:e.name,value:e.id,source_id:e.source_id}}))}))},getCatelog:function(){var e=this;Object(c["C"])().then((function(t){e.catalogOptions=t.data.list}))},catalogchange:function(e){var t,a=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(i&&(this.topicDialog.form.extra.template_json_id=""),this.styleOptions=[],e){var o=null===(t=this.productLists.find((function(e){return e.value===a.product_id})))||void 0===t?void 0:t.source_id,l={catalogCode:e,sourceId:o};Object(c["xc"])(l).then((function(e){a.styleOptions=e.data||[]}))}},yulanfn:function(){window.open(this.viewurl+this.dialog.form.extra.template_json_id)},getTopicDetail:function(){var e=this;return Object(p["O"])(this.id).then((function(t){var a=t.extra.topic_type,i=t.product_id;e.hasChildTopic=2==a,e.product_id=i}))},getChildTopic:function(){var e=this;return Object(p["B"])(this.id).then((function(t){var a;e.channelsList=t;var i=e.$route.query.id;e.currentKey=i||e.currentKey||(null===t||void 0===t||null===(a=t[0])||void 0===a?void 0:a.id)||"",e.$nextTick((function(){var t;null===(t=e.$refs.tree)||void 0===t||t.setCurrentKey(e.currentKey),e.getList()}))}))},handleTopicAdd:function(){this.resetForm("topicForm"),Object.assign(this.topicDialog,{show:!0,title:"新增专题",form:{name:"",extra:{template_style:"",template_json_id:""}}})},handleTopicEdit:function(e){this.resetForm("topicForm");var t=e.name,a=e.id,i=e.extra,o=i.template_style,l=void 0===o?"":o,n=i.template_json_id,r=void 0===n?"":n;Object.assign(this.topicDialog,{show:!0,title:"修改专题",id:a,form:{name:t,extra:{template_style:l,template_json_id:r}}}),this.catalogchange(l,!1)},enterTopicChange:function(){var e,t=this;null===(e=this.$refs.topicForm)||void 0===e||e.validate((function(e){if(e){var a=t.topicDialog.id,i=a?Object(p["o"])(a,Object(s["a"])(Object(s["a"])({},t.topicDialog.form),{},{father:t.id})):Object(p["f"])(Object(s["a"])({father:t.id,status:1,type:"topic"},t.topicDialog.form));i.then((function(){t.$message.success(a?"修改成功":"添加成功!"),t.topicDialog.show=!1,t.getChildTopic()}))}}))},handleTopicSort:function(e,t){var a=this,i=t.id,o=this.channelsList.findIndex((function(e){return e.id===i})),l={};"up"===e?(l[this.channelsList[o].id]=this.channelsList[o-1].sort,l[this.channelsList[o-1].id]=this.channelsList[o].sort):(l[this.channelsList[o].id]=this.channelsList[o+1].sort,l[this.channelsList[o+1].id]=this.channelsList[o].sort),Object(c["wc"])(l).then((function(){a.$message.success("修改成功"),a.getChildTopic()}))},changeStatus:function(e){var t=this,a=e.status,i=e.id;Object(p["p"])({status:1===a?0:1,ids:"".concat(i)}).then((function(){t.$message.success("修改状态成功"),t.getChildTopic()}))},handleTopicRemove:function(e,t){var a=this,i=t.name,o=t.id;this.$confirm("此操作将永久删除该".concat(i,"目录, 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(p["y"])(o).then((function(){a.$message({message:"删除成功",type:"success"}),a.currentKey===o&&(a.currentKey=""),a.getChildTopic()}))})).catch((function(){a.$message({type:"info",message:"已取消删除"})}))},treeChange:function(e){this.currentKey=e.id,this.handleReset(),this.getList(),console.log(e)},handleDateChange:function(e){var t=e||["",""];this.queryParams.startdate=t[0],this.queryParams.enddate=t[1]},handleReset:function(){Object.assign(this.queryParams,{startdate:"",enddate:"",page:1}),this.resetForm("queryForm")},handleQuery:function(){this.queryParams.page=1,this.getList()},handleAdd:function(){this.$router.push({name:"Add-media",query:{redirect:"ProjectManage",channelId:this.currentKey,father:this.id}})},handleReturn:function(){this.$emit("handleReturn")},statusChange:function(e){var t=this,a=e.id,i=e.status;Object(p["m"])({ids:a,status:i}).then((function(){t.$message.success("修改状态成功"),t.getList()}))},numberChange:function(e){e=Number.parseInt(e),this.sortDialog.form.now=Number.isNaN(e)?"":e},handleSort:function(e){var t=e.id,a=e.sort;Object.assign(this.sortDialog,{show:!0,id:t,form:{old:a,now:""}})},enterSortDialog:function(){var e,t=this;null===(e=this.$refs.sortForm)||void 0===e||e.validate((function(e){if(e){var a=t.sortDialog,i=a.id,o=a.form;Object(p["l"])(Object(w["a"])({},i,o.now)).then((function(){t.$message.success("修改成功"),t.sortDialog.show=!1,t.getList()}))}}))},handlePlaced:function(e){var t=this,a=e.top,i=e.id;Object(p["U"])({ids:i,top:1===a?0:1}).then((function(){t.$message.success(1===a?"取消置顶":"置顶"),t.getList()}))},handleWatch:function(e){console.log(e);var t=e.id,a=e.type,i=e.script_id;"broadcast"===a?this.$router.push({name:"StudioList",query:{title:i}}):this.detailDialog={id:t,show:!0,disabled:!0}},handleEdit:function(e){var t=e.id;this.detailDialog={id:t,show:!0,disabled:!1}},handleListDelete:function(e){var t=this,a=e.id;this.$confirm("此操作将永久删除这条新闻, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(p["w"])(a).then((function(){t.$message({message:"删除成功",type:"success"}),t.getList()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},handlePreview:function(e){var t=e.id;this.$router.push({name:"Preview",query:{id:t,type:"news"}})},switchChange:function(){var e=this;this.$nextTick((function(){var t;null===(t=e.$refs.dialogForm)||void 0===t||t.clearValidate("push_time")}))},pickerFocus:function(){this.pickerOptions.selectableRange=this.updateSelectableRange()},handlePush:function(e){var t=this,a=e.type,i=e.id,o=e.title,l=e.link,n=e.cover;this.resetForm("dialogForm"),this.switchVal=!1,Object.assign(this.dialogForm,{cover:n,title:o,content:"",linked_to:Object(s["a"])({route_type:"news",type:a,id:i,title:o},l?{link:l}:{})}),Object(p["K"])(e.id).then((function(e){t.dialogForm.content=e.extra.intro,t.pushDialog.show=!0}))},enterPushDialog:function(){var e,t=this;this.switchVal||(this.dialogForm.push_time=Object(j["a"])(new Date,"yyyy-MM-dd hh:mm:ss")),null===(e=this.$refs.dialogForm)||void 0===e||e.validate((function(e){if(e){var a=t.product_id,i=t.dialogForm,o=i.push_to.cid,l={product_id:a,extra:Object(s["a"])(Object(s["a"])({},i),{},{push_to:Object(s["a"])(Object(s["a"])({},i.push_to),{},{cid:o?[o]:[]})})};Object(_["d"])(l).then((function(e){t.$message.success(e.message),t.pushDialog.show=!1}))}}))},handleHistory:function(e){var t=e.id;this.history={show:!0,id:t}},getList:function(){var e=this;if(!this.hasChildTopic||0!==this.channelsList.length){this.loading=!0;var t=Object(s["a"])(Object(s["a"])({},this.queryParams),{},{channel_id:this.currentKey});Object(p["L"])(this.removePropertyOfNullFor0(t)).then((function(t){e.total=t.total,e.tableData=(t.data||[]).map((function(t){var a=e.typeOptions.find((function(e){return t.type===e.value})),i=t.cover[0];return Object(s["a"])(Object(s["a"])({},t),{},{typeLabel:a&&a.label||"",cover:i&&i.path||""})})),!e.isMobile&&e.initSort()})).finally((function(){e.loading=!1}))}},initSort:function(){var e=this,t=this.$refs.multipleTable.$el.querySelectorAll(".el-table__body-wrapper > table > tbody")[0];k.a.create(t,{ghostClass:"sortable-ghost",onEnd:function(t){var a=t.newIndex,i=t.oldIndex,o=e.tableData[i].id,l=e.tableData[a].sort;e.tableData=[],Object(p["l"])(Object(w["a"])({},o,l)).then((function(){e.$message.success("修改成功"),e.getList()}))}})},refresh:function(){this.getList(),this.detailDialog.id=""}},created:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getTopicDetail();case 2:e.hasChildTopic?e.getChildTopic():(e.currentKey=e.id,e.getList()),e.getProductList(),e.getCatelog();case 5:case"end":return t.stop()}}),t)})))()}},q=P,S=(a("9ba5"),Object(f["a"])(q,v,y,!1,null,null,null)),C=S.exports,L={name:"ProjectManage",components:{ProjectLists:b,ProjectDetail:C},data:function(){return{exclude:["ProjectDetail"],component:"ProjectLists",id:""}},methods:{handleReturn:function(){this.$router.push(this.$route.path),this.component="ProjectLists"},watchDetail:function(e){this.id=e,this.component="ProjectDetail"}},created:function(){var e=this.$route.query.father;this.id=e||"",this.id&&(this.component="ProjectDetail")}},F=L,N=Object(f["a"])(F,i,o,!1,null,null,null);t["default"]=N.exports},b747:function(e,t,a){var i=a("d890"),o=a("c10f").trim,l=a("fc8c"),n=i.parseInt,r=/^[+-]?0[Xx]/,s=8!==n(l+"08")||22!==n(l+"0x16");e.exports=s?function(e,t){var a=o(String(e));return n(a,t>>>0||(r.test(a)?16:10))}:n},d57c:function(e,t,a){"use strict";a("37ba")}}]);