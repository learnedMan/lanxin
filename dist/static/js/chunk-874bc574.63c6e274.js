(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-874bc574"],{"01d5":function(e,t,a){},"4c4f":function(e,t,a){"use strict";a("01d5")},"6f1d":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"sign-integral",staticStyle:{"padding-left":"80px","padding-top":"30px"}},[a("el-form",{ref:"dataForm",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{"label-width":"120px",label:"所属产品:",prop:"sourceId"}},[a("el-select",{attrs:{placeholder:"请选择所属产品"},on:{change:e.handleQuery},model:{value:e.form.sourceId,callback:function(t){e.$set(e.form,"sourceId",t)},expression:"form.sourceId"}},e._l(e.productLists,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{"label-width":"120px",label:"签到模式:",prop:"signPattern"}},[a("el-radio-group",{attrs:{disabled:e.editflag,size:"small"},model:{value:e.form.circulatory,callback:function(t){e.$set(e.form,"circulatory",t)},expression:"form.circulatory"}},e._l(e.patterns,(function(t){return a("el-radio",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1),a("el-form-item",{attrs:{"label-width":"120px",label:"规则:",prop:"tips"}},[a("el-input",{staticStyle:{width:"400px"},attrs:{disabled:e.editflag,type:"textarea",rows:4,placeholder:"请输入签到规则",clearable:""},model:{value:e.form.tips,callback:function(t){e.$set(e.form,"tips",t)},expression:"form.tips"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"状态:",prop:"status"}},[a("el-switch",{attrs:{disabled:e.editflag,"active-value":0,"inactive-value":1},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"奖励设置:",prop:"awardSet"}},[a("el-row",{staticStyle:{width:"400px"}},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content bg-purple"},[e._v("时间")])]),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content bg-purple-light"},[e._v("奖励类型")])]),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content bg-purple"},[e._v("奖励")])])],1),e._l(e.form.awardSet.lists,(function(t){return a("el-row",{key:t.day,staticStyle:{width:"400px"}},[a("el-col",{attrs:{span:8}},[e._v(e._s(t.label))]),a("el-col",{staticStyle:{"padding-right":"30px"},attrs:{span:8}},[a("el-select",{attrs:{disabled:e.editflag,size:"mini",placeholder:"请选择"},model:{value:t.type,callback:function(a){e.$set(t,"type",a)},expression:"v.type"}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-col",{attrs:{span:8}},[a("el-input",{attrs:{disabled:e.editflag,size:"mini",placeholder:"请输入积分值"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"v.value"}})],1)],1)}))],2)],1),a("div",{staticStyle:{"padding-top":"20px","padding-left":"50px"}},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{disabled:!e.editflag,type:"success",size:"mini"},on:{click:e.editfn}},[e._v("编辑")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{disabled:e.editflag,type:"info",size:"mini"},on:{click:e.reset}},[e._v("重置")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{disabled:e.editflag,type:"primary",size:"mini"},on:{click:e.save}},[e._v("保存")])],1)],1)},r=[],s=a("1da1"),i=a("5530"),o=(a("d81d"),a("b0c0"),a("e9c4"),a("d3b7"),a("a9e3"),a("96cf"),a("2f62")),n=a("0fea"),c=a("ed08"),u={name:"sign-integral",data:function(){return{editflag:!0,form:{},recordform:{},productLists:[],patterns:[{label:"7天连续循环签到(连续签到7天后,第8天重新从第1天开始循环)",value:1},{label:"7天连续不循环签到(连续签到7天后,继续签到,按第7天积分值进行奖励)",value:2}],rules:{tips:[{required:!0,message:"请输入签到规则",trigger:"blur"}],awardSet:[{required:!0,message:"请输入积分值",trigger:"blur"}]}}},computed:Object(i["a"])({},Object(o["b"])(["sidebar","avatar","device","u_info"])),created:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.form={circulatory:1,tips:"",status:0,sourceId:"",awardSet:{lists:[{type:"1",value:"",label:"第1天/周一",day:1,options:[{value:"1",label:"积分"}]},{type:"1",value:"",label:"第2天/周二",day:2,options:[{value:"1",label:"积分"}]},{type:"1",value:"",label:"第3天/周三",day:3,options:[{value:"1",label:"积分"}]},{type:"1",value:"",label:"第4天/周四",day:4,options:[{value:"1",label:"积分"}]},{type:"1",value:"",label:"第5天/周五",day:5,options:[{value:"1",label:"积分"}]},{type:"1",value:"",label:"第6天/周六",day:6,options:[{value:"1",label:"积分"}]},{type:"1",value:"",label:"第7天/周七",day:7,options:[{value:"1",label:"积分"}]}]}},e.recordform=Object(c["c"])(e.form),t.next=4,e.getProductList();case 4:e.getinfo();case 5:case"end":return t.stop()}}),t)})))()},methods:{getProductList:function(){var e=this;return Object(n["nc"])({}).then((function(t){var a,l=t.data||[];e.productLists=l.map((function(e){return{label:e.name,value:e.source_id}})),e.form.sourceId=null===l||void 0===l||null===(a=l[0])||void 0===a?void 0:a.source_id}))},handleQuery:function(e){this.form.sourceId=e,this.getinfo()},getinfo:function(){var e=this,t={sourceId:this.form.sourceId};Object(n["Zb"])(t).then((function(t){var a=t.data;e.form.circulatory=a.circulatory,e.form.status=a.status,e.form.tips=a.tips,e.form.sourceId=a.data[0].sourceId;var l=a.data||[];e.form.awardSet.lists=e.form.awardSet.lists.map((function(e){return l.map((function(t){t.day===e.day&&(e.value=t.point)})),Object(i["a"])({},e)}))}))},reset:function(){this.form=JSON.parse(JSON.stringify(this.recordform)),this.$message({type:"success",message:"已重置"}),console.log(this.recordform)},save:function(){var e=this;this.$refs["dataForm"].validate((function(t){if(t){var a=e.form.awardSet.lists,l=a.every((function(e){return e.value})),r=a.map((function(e){var t=e.day,a=Number(e.value);return{day:t,point:a}})),s=Object(i["a"])(Object(i["a"])({},e.form),{},{data:r});delete s.awardSet,l?Object(n["j"])(s).then((function(t){e.$message({message:"保存成功",type:"success"})})).then((function(t){e.editflag=!0,e.getinfo()}),(function(e){})):e.$message("请输入积分值")}}))},editfn:function(){this.editflag=!1},handleAvatarSuccess:function(e,t,a){this.form.logo=e.path,this.$forceUpdate()},beforeAvatarUpload:function(e){var t=e.size/1024/1024<20;return t||this.$message.error("上传头像图片大小不能超过 20MB!"),t}}},d=u,p=(a("91d0"),a("4c4f"),a("2877")),f=Object(p["a"])(d,l,r,!1,null,"2bdae32a",null);t["default"]=f.exports},"91d0":function(e,t,a){"use strict";a("cc84")},cc84:function(e,t,a){}}]);