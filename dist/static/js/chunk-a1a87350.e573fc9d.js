(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a1a87350"],{"17d0":function(e,t,a){"use strict";a("90b8")},"1a3b":function(e,t,a){"use strict";a("a6ea")},"1faa":function(e,t,a){},"238d":function(e,t,a){},"25bb":function(e,t,a){},"269d":function(e,t,a){"use strict";a("ef21")},"3b32":function(e,t,a){"use strict";a("238d")},"3bbb":function(e,t,a){"use strict";a("662a")},"46f0":function(e,t,a){"use strict";a("1faa")},5038:function(e,t,a){e.exports=a.p+"static/img/tp.7ca79fd9.png"},"55ad":function(e,t,a){},"57b6":function(e,t,a){},"588d":function(e,t,a){e.exports=a.p+"static/img/cq.75ac643b.png"},"662a":function(e,t,a){},"6cdc":function(e,t,a){e.exports=a.p+"static/img/dt.b7445a1d.png"},7010:function(e,t,a){},"7d85":function(e,t,a){"use strict";a("25bb")},"90b8":function(e,t,a){},"99fc":function(e,t,a){e.exports=a.p+"static/img/cj.8311b898.png"},"9fd7":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"xl-upload-video"},[a("el-upload",{attrs:{name:"file",accept:"video/*",action:e.actionUrl,headers:e.uploadHeader,"show-file-list":!1,"on-success":e.handleUploadSuccess,"before-upload":e.beforeUploadVideo,"on-progress":e.handleProgress,"on-error":e.handleUploadError}},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}]},[e._v("上传视频"),a("i",{staticClass:"el-icon-upload el-icon--right",staticStyle:{"font-size":"14px"}})])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.value,expression:"value"}],staticClass:"xl-upload-video--play",on:{click:e.play}},[e._v(e._s(e.value)+" "),a("i",{staticClass:"el-icon-video-play"})]),a("el-progress",{directives:[{name:"show",rawName:"v-show",value:e.percentage,expression:"percentage"}],attrs:{percentage:e.percentage}}),e.dialog.show?a("el-dialog",{attrs:{width:"640px",title:"视频",visible:e.dialog.show},on:{"update:visible":function(t){return e.$set(e.dialog,"show",t)}}},[a("video",{attrs:{height:"400",width:"600",controls:""}},[a("source",{attrs:{src:e.dialog.url}}),e._v(" 您的浏览器不支持 video 标签。 ")])]):e._e()],1)},o=[],r=(a("ac1f"),a("1276"),a("a15b"),{props:{value:String},data:function(){return{percentage:0,dialog:{show:!1,url:""}}},computed:{actionUrl:function(){return this.videourl},uploadHeader:function(){var e=sessionStorage.getItem("token");return{Authorization:e}},type:function(){var e=this.value&&this.value.split(".");return(null===e||void 0===e?void 0:e[e.length-1])||""}},methods:{beforeUploadVideo:function(e){var t=e.size/1024/1024<=300,a=["video/mp4","video/ogg","video/flv","video/avi","video/wmv","video/rmvb","video/mov"];return-1==a.indexOf(e.type)?(this.$message.warning("请上传正确的视频格式: ".concat(a.join())),!1):t?(this.percentage=0,!0):(this.$message.warning("视频大小不能超过300MB"),!1)},handleProgress:function(){this.percentage=90},handleUploadSuccess:function(e,t,a){e.status_code>=200&&e.status_code<300?(this.percentage=100,this.$message.success("视频上传成功!"),this.$emit("input",e.path)):(this.$message.error("视频上传失败!"),this.percentage=0,a.length=0)},handleUploadError:function(){this.$message.error("上传失败, 请重新上传!"),this.percentage=0},play:function(){this.dialog={show:!0,url:this.value}}}}),l=r,s=(a("46f0"),a("2877")),n=Object(s["a"])(l,i,o,!1,null,"664e7a03",null);t["a"]=n.exports},a255:function(e,t,a){"use strict";a("7010")},a6ea:function(e,t,a){},a7cb:function(e,t,a){"use strict";a("55ad")},c73d:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"fade-transform",mode:"out-in"}},[a("keep-alive",{attrs:{exclude:e.exclude}},[a(e.component,{tag:"component",attrs:{id:e.id},on:{watchConsole:e.watchConsole,handleReturn:e.handleReturn}})],1)],1)},o=[],r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"xl-studio-list"},[i("div",{staticClass:"search"},[i("el-form",{ref:"queryForm",attrs:{model:e.queryParams,inline:!0}},[i("el-form-item",{attrs:{label:"直播间名称:",prop:"keyword"}},[i("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入关键字",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.keyword,callback:function(t){e.$set(e.queryParams,"keyword",t)},expression:"queryParams.keyword"}})],1),i("el-form-item",{attrs:{label:"类型:",prop:"broadcast_type"}},[i("el-select",{attrs:{size:"small",placeholder:"请选择类型",clearable:""},model:{value:e.queryParams.broadcast_type,callback:function(t){e.$set(e.queryParams,"broadcast_type",t)},expression:"queryParams.broadcast_type"}},e._l(e.broadcast_typeOptions,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"直播状态:",prop:"live"}},[i("el-select",{attrs:{size:"small",placeholder:"请选择类型",clearable:""},model:{value:e.queryParams.live,callback:function(t){e.$set(e.queryParams,"live",t)},expression:"queryParams.live"}},e._l(e.liveOptions,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"审核状态:",prop:"status"}},[i("el-select",{attrs:{size:"small",placeholder:"请选择状态",clearable:""},model:{value:e.queryParams.status,callback:function(t){e.$set(e.queryParams,"status",t)},expression:"queryParams.status"}},e._l(e.publishOptions,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"创建时间:"}},[i("el-date-picker",{attrs:{type:"daterange",align:"right",size:"small","unlink-panels":"","range-separator":"~","value-format":"yyyy-MM-dd HH:mm:ss","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},on:{change:function(t){return e.handleDateChange(t,"createDate")}},model:{value:e.createDate,callback:function(t){e.createDate=t},expression:"createDate"}})],1),i("el-form-item",[i("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:e.handleReset}},[e._v(" 重置 ")]),i("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:e.handleQuery}},[e._v(" 搜索 ")]),i("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:e.handleAdd}},[e._v(" 新增 ")])],1)],1)],1),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:e.tablekey,ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},data:e.tableData,border:"","tooltip-effect":"dark"}},[e.isMobile?e._e():i("el-table-column",{attrs:{label:"ID",align:"center",prop:"id","min-width":"5%"}}),i("el-table-column",{attrs:{label:"直播间名称",align:"center",prop:"title","min-width":"25%","show-overflow-tooltip":!0}}),i("el-table-column",{attrs:{label:"点击量",align:"center",prop:"hits","min-width":"5%"}}),i("el-table-column",{attrs:{label:"直播间类型",align:"center",prop:"broadcast_typeLabel","min-width":"5%"}}),i("el-table-column",{attrs:{label:"直播状态",align:"center",prop:"liveLabel","min-width":"8%"}}),i("el-table-column",{attrs:{label:"审核状态",align:"center","min-width":"8%"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-select",{attrs:{size:"small"},on:{change:function(a){return e.publishChange(t.row)}},model:{value:t.row.status,callback:function(a){e.$set(t.row,"status",a)},expression:"scope.row.status"}},e._l(e.publishOptions.filter((function(e){return""!==e.value})),(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)]}}])}),e.isMobile?e._e():i("el-table-column",{attrs:{label:"开播时间",align:"center",prop:"start_time","min-width":"10%"}}),e.isMobile?e._e():i("el-table-column",{attrs:{label:"结束时间",align:"center",prop:"end_time","min-width":"10%"}}),i("el-table-column",{attrs:{label:"运营",align:"center","min-width":"8%"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"small"},on:{click:function(a){return e.watchConsole(t.row)}}},[e._v(" 控制台 ")])]}}])}),e.isMobile?e._e():i("el-table-column",{attrs:{label:"创建时间",align:"center",prop:"created_at","min-width":"8%"}}),i("el-table-column",{attrs:{label:"操作",align:"center","min-width":"20%"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"verify-table-action"},[i("Iconbutton",{attrs:{icontype:"xg",label:"修改"},on:{fatherMethod:function(a){return e.handleEdit(t.row)}}}),i("Iconbutton",{attrs:{icontype:"sc",label:"删除"},on:{fatherMethod:function(a){return e.handleDelete(t.row)}}}),i("Iconbutton",{attrs:{icontype:"fb",label:"栏目"},on:{fatherMethod:function(a){return e.handlePublish(t.row)}}})],1)]}}])})],1),i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.queryParams.page,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"page",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}}),i("el-dialog",{attrs:{width:"600px",title:e.publishDialog.title,visible:e.publishDialog.show},on:{"update:visible":function(t){return e.$set(e.publishDialog,"show",t)}}},[i("el-form",{ref:"publishForm",attrs:{model:e.publishDialog.form,rules:e.publishDialog.rules}},[i("el-form-item",{attrs:{"label-width":"120px",label:"栏目",prop:"channel_id"}},[i("el-cascader",{staticStyle:{width:"350px"},attrs:{filterable:"",options:e.channelsList,props:e.cascaderOption,clearable:""},model:{value:e.publishDialog.form.channel_id,callback:function(t){e.$set(e.publishDialog.form,"channel_id",t)},expression:"publishDialog.form.channel_id"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:function(t){e.publishDialog.show=!1}}},[e._v(" 取 消 ")]),i("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:e.enterPublishDialog}},[e._v(" 确 定 ")])],1)],1),e.dialog.show?i("el-dialog",{attrs:{width:"800px",top:"20px",title:e.dialog.title,visible:e.dialog.show},on:{"update:visible":function(t){return e.$set(e.dialog,"show",t)}}},[i("el-form",{ref:"dialogForm",attrs:{model:e.dialog.form,rules:e.dialog.rules,"label-width":"120px",size:"small"}},[i("el-form-item",{attrs:{"label-width":"120px",label:"发布栏目:",prop:"channels"}},[i("el-cascader",{staticStyle:{width:"200px"},attrs:{options:e.channelsList,props:e.cascaderOption,clearable:""},model:{value:e.dialog.form.channels,callback:function(t){e.$set(e.dialog.form,"channels",t)},expression:"dialog.form.channels"}})],1),i("el-form-item",{attrs:{"label-width":"120px",label:"直播间名称:",prop:"extra.title"}},[i("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入直播间名称",clearable:"",size:"small"},model:{value:e.dialog.form.extra.title,callback:function(t){e.$set(e.dialog.form.extra,"title",t)},expression:"dialog.form.extra.title"}})],1),i("el-form-item",{attrs:{label:"直播封面:",prop:"extra.template_style"}},[i("el-radio-group",{attrs:{size:"small"},model:{value:e.dialog.form.extra.template_style,callback:function(t){e.$set(e.dialog.form.extra,"template_style",t)},expression:"dialog.form.extra.template_style"}},e._l(e.templateStyleLists,(function(t){return i("el-radio",{key:t.value,staticStyle:{"line-height":"32px"},attrs:{label:t.value}},[i("el-popover",{attrs:{placement:"top",trigger:"focus"}},[i("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(t.label))]),i("img",{attrs:{src:a("9795")("./"+t.img),alt:"",width:"300px"}})])],1)})),1)],1),i("el-form-item",{attrs:{prop:"extra.cover"}},[i("cropper",{attrs:{count:e.imgCount},model:{value:e.dialog.form.extra.cover,callback:function(t){e.$set(e.dialog.form.extra,"cover",t)},expression:"dialog.form.extra.cover"}})],1),i("el-form-item",{attrs:{"label-width":"120px",label:"直播类型:",prop:"extra.broadcast_type"}},[i("el-radio-group",{on:{change:e.statementChange},model:{value:e.dialog.form.extra.broadcast_type,callback:function(t){e.$set(e.dialog.form.extra,"broadcast_type",t)},expression:"dialog.form.extra.broadcast_type"}},e._l(e.broadcast_typeOptions.filter((function(e){return""!==e.value})),(function(t){return i("el-radio",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1),"3"===e.dialog.form.extra.broadcast_type?i("el-form-item",{attrs:{"label-width":"120px",label:"顶部图片:",prop:"extra.banner"}},[i("div",{staticStyle:{display:"flex"}},[i("upload-single",{model:{value:e.dialog.form.extra.banner,callback:function(t){e.$set(e.dialog.form.extra,"banner",t)},expression:"dialog.form.extra.banner"}}),i("span",{staticStyle:{"margin-left":"15px",color:"#ccc","box-sizing":"border-box","padding-top":"70px"}},[e._v("建议尺寸750*120px")])],1)]):e._e(),i("el-form-item",{attrs:{"label-width":"120px",label:"图文直播:",prop:"extra.statement"}},[i("el-radio-group",{attrs:{disabled:"3"===e.dialog.form.extra.broadcast_type},model:{value:e.dialog.form.extra.statement,callback:function(t){e.$set(e.dialog.form.extra,"statement",t)},expression:"dialog.form.extra.statement"}},e._l(e.statementOptions,(function(t){return i("el-radio",{key:t.value,staticStyle:{"margin-top":"10px"},attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1),i("el-form-item",{attrs:{"label-width":"120px",label:"直播时间:",prop:"extra.start_time"}},[i("el-date-picker",{attrs:{disabled:""!==e.dialog.id,type:"datetimerange",align:"right",size:"small","unlink-panels":"","range-separator":"~","value-format":"yyyy-MM-dd HH:mm:ss","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:function(t){return e.handleDateChange(t,"liveTime")}},model:{value:e.liveTime,callback:function(t){e.liveTime=t},expression:"liveTime"}})],1),i("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{prop:"extra.end_time"}}),i("el-form-item",{attrs:{prop:"extra.allow_comment",label:"评论控制"}},[i("el-radio-group",{attrs:{size:"small"},model:{value:e.dialog.form.extra.allow_comment,callback:function(t){e.$set(e.dialog.form.extra,"allow_comment",t)},expression:"dialog.form.extra.allow_comment"}},[i("el-radio",{key:"0",attrs:{label:"0"}},[e._v("先审后发")]),i("el-radio",{key:"1",attrs:{label:"1"}},[e._v("先发后审")]),i("el-radio",{key:"2",attrs:{label:"2"}},[e._v("禁止评论")])],1)],1),i("el-form-item",{attrs:{prop:"extra.allow_share",label:"允许分享"}},[i("el-radio-group",{attrs:{size:"small"},model:{value:e.dialog.form.extra.allow_share,callback:function(t){e.$set(e.dialog.form.extra,"allow_share",t)},expression:"dialog.form.extra.allow_share"}},[i("el-radio",{key:"1",attrs:{label:"1"}},[e._v("是")]),i("el-radio",{key:"0",attrs:{label:"0"}},[e._v("否")])],1)],1),i("el-form-item",{attrs:{"label-width":"120px",label:"直播间简介:",prop:"extra.intro"}},[i("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入简介",clearable:"",type:"textarea",rows:"5"},model:{value:e.dialog.form.extra.intro,callback:function(t){e.$set(e.dialog.form.extra,"intro",t)},expression:"dialog.form.extra.intro"}})],1),i("el-form-item",{attrs:{prop:"extra.display_stat",label:"数据显示"}},[i("el-radio-group",{attrs:{size:"small"},model:{value:e.dialog.form.extra.display_stat,callback:function(t){e.$set(e.dialog.form.extra,"display_stat",t)},expression:"dialog.form.extra.display_stat"}},[i("el-radio",{key:"1",attrs:{label:"1"}},[e._v("是")]),i("el-radio",{key:"0",attrs:{label:"0"}},[e._v("否")])],1)],1),i("el-form-item",{attrs:{label:"机器人数据",prop:"extra.robot_settings.enable"}},[i("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:e.dialog.form.extra.robot_settings.enable,callback:function(t){e.$set(e.dialog.form.extra.robot_settings,"enable",t)},expression:"dialog.form.extra.robot_settings.enable"}})],1),i("el-form-item",{attrs:{label:"基础观看人数:"}},[i("el-row",[i("el-col",{attrs:{span:24}},[i("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{prop:"extra.view_base_num"}},[i("el-input-number",{attrs:{controls:!1,precision:0,placeholder:"请输入",clearable:""},model:{value:e.dialog.form.extra.view_base_num,callback:function(t){e.$set(e.dialog.form.extra,"view_base_num",t)},expression:"dialog.form.extra.view_base_num"}}),e._v(" 人 ")],1)],1)],1),i("el-row",{directives:[{name:"show",rawName:"v-show",value:e.dialog.form.extra.robot_settings.enable,expression:"dialog.form.extra.robot_settings.enable"}],staticStyle:{"margin-top":"10px"}},[i("el-col",{attrs:{span:24}},[e._v(" 每分钟额外显示 "),i("el-form-item",{staticStyle:{display:"inline-block","margin-bottom":"0"},attrs:{prop:"extra.robot_settings.view.min"}},[i("el-input-number",{attrs:{controls:!1,precision:0,max:e.dialog.form.extra.robot_settings.view.max||0,placeholder:"请输入",clearable:""},model:{value:e.dialog.form.extra.robot_settings.view.min,callback:function(t){e.$set(e.dialog.form.extra.robot_settings.view,"min",t)},expression:"dialog.form.extra.robot_settings.view.min"}})],1),e._v(" ~ "),i("el-form-item",{staticStyle:{display:"inline-block","margin-bottom":"0"},attrs:{prop:"extra.robot_settings.view.max"}},[i("el-input-number",{attrs:{controls:!1,precision:0,min:e.dialog.form.extra.robot_settings.view.min||0,placeholder:"请输入",clearable:""},model:{value:e.dialog.form.extra.robot_settings.view.max,callback:function(t){e.$set(e.dialog.form.extra.robot_settings.view,"max",t)},expression:"dialog.form.extra.robot_settings.view.max"}})],1),e._v(" 内的随机整数（最大值建议≤100） ")],1)],1)],1),i("el-form-item",{attrs:{label:"基础点赞数量:"}},[i("el-row",[i("el-col",{attrs:{span:24}},[i("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{prop:"extra.praise_base_num"}},[i("el-input-number",{attrs:{controls:!1,precision:0,placeholder:"请输入",clearable:""},model:{value:e.dialog.form.extra.praise_base_num,callback:function(t){e.$set(e.dialog.form.extra,"praise_base_num",t)},expression:"dialog.form.extra.praise_base_num"}}),e._v(" 个 ")],1)],1)],1),i("el-row",{directives:[{name:"show",rawName:"v-show",value:e.dialog.form.extra.robot_settings.enable,expression:"dialog.form.extra.robot_settings.enable"}],staticStyle:{"margin-top":"10px"}},[i("el-col",{attrs:{span:24}},[e._v(" 每分钟增加 "),i("el-form-item",{staticStyle:{display:"inline-block","margin-bottom":"0"},attrs:{prop:"extra.robot_settings.praise.min"}},[i("el-input-number",{attrs:{controls:!1,max:e.dialog.form.extra.robot_settings.praise.max||1/0,placeholder:"请输入",clearable:""},model:{value:e.dialog.form.extra.robot_settings.praise.min,callback:function(t){e.$set(e.dialog.form.extra.robot_settings.praise,"min",t)},expression:"dialog.form.extra.robot_settings.praise.min"}})],1),e._v(" ~ "),i("el-form-item",{staticStyle:{display:"inline-block","margin-bottom":"0"},attrs:{prop:"extra.robot_settings.praise.max"}},[i("el-input-number",{attrs:{controls:!1,min:e.dialog.form.extra.robot_settings.praise.min||0,placeholder:"请输入",clearable:""},model:{value:e.dialog.form.extra.robot_settings.praise.max,callback:function(t){e.$set(e.dialog.form.extra.robot_settings.praise,"max",t)},expression:"dialog.form.extra.robot_settings.praise.max"}})],1),e._v(" 内的随机整数 ")],1)],1)],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:function(t){e.dialog.show=!1}}},[e._v("取 消")]),i("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"},{name:"loading",rawName:"v-loading",value:e.dialogLoading,expression:"dialogLoading"}],attrs:{type:"primary"},on:{click:e.enterChangeDialog}},[e._v("确 定")])],1)],1):e._e()],1)},l=[],s=a("5530"),n=(a("d3b7"),a("fb6a"),a("7db0"),a("d81d"),a("a15b"),a("159b"),a("13cc")),c=a("0fea"),d=a("48fb"),u=a("e60d"),p=a("b49d"),m={name:"studioList",components:{uploadSingle:u["a"],Cropper:p["a"]},data:function(){var e=this,t=function(t,a,i){var o=e.imgCount,r=e.dialog.form.extra.template_style;Array.isArray(a)&&0!==a.length||"240"==r?a.slice(0,o).every((function(e){return e.path}))||"240"==r?i():i(new Error("请上传".concat(o,"张图片"))):i(new Error("请上传图片"))};return{loading:!1,tablekey:!1,queryParams:{keyword:"",live:"",broadcast_type:"",status:"",startdate:"",enddate:"",page:1,pageSize:10},tableData:[],total:0,cascaderOption:{checkStrictly:!0,emitPath:!1,value:"id",label:"name",multiple:!0},channelsList:[],broadcast_typeOptions:[{label:"全部",value:""},{label:"横版",value:"1"},{label:"竖版",value:"2"},{label:"纯图文",value:"3"}],liveOptions:[{label:"全部",value:""},{label:"未开始",value:0},{label:"进行中",value:1},{label:"已结束",value:2}],publishOptions:[{label:"全部",value:""},{label:"待审核",value:0},{label:"已发布",value:1},{label:"已下线",value:2}],statementOptions:[{label:"关闭（关闭后客户端不展示图文直播间）",value:"none"},{label:"关联直播间（该直播间中，多个机位共用同一图文直播）",value:"broadcast"}],pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},liveTime:"",createDate:"",templateStyleLists:[{label:"纯文本",value:"240",count:1,img:"1402-240.png"},{label:"三图下文本",value:"230",count:3,img:"1402-230.png"},{label:"三图上文本",value:"231",count:3,img:"1402-231.png"},{label:"左图+标题1",value:"220",count:1,img:"1402-220.png"},{label:"左图+标题2",value:"222",count:1,img:"1402-222.png"},{label:"右图+标题",value:"221",count:1,img:"1402-221.png"},{label:"播放器2",value:"211",count:1,img:"1402-211.png"},{label:"播放器3",value:"212",count:1,img:"1402-212.png"},{label:"大图1",value:"200",count:1,img:"1402-200.png"},{label:"大图2",value:"201",count:1,img:"1402-201.png"},{label:"大图3",value:"202",count:1,img:"1402-202.png"},{label:"大图4",value:"203",count:1,img:"1402-203.png"},{label:"大图5",value:"204",count:1,img:"1402-204.png"},{label:"大图6",value:"205",count:1,img:"1402-205.png"},{label:"大图7",value:"206",count:1,img:"1402-206.png"}],dialog:{title:"新增",id:"",show:!1,form:{channels:[],extra:{type:"broadcast",title:"",banner:"",template_style:"240",cover:[],allow_comment:"1",allow_share:"1",display_stat:"1",broadcast_type:"1",statement:"none",start_time:"",end_time:"",intro:"",view_base_num:"",praise_base_num:"",robot_settings:{enable:0,view:{min:"",max:""},praise:{min:"",max:""}}}},rules:{"extra.title":[{required:!0,message:"请输入直播间名称",trigger:"blur"}],"extra.template_style":[{required:!0,message:"请选择直播封面样式",trigger:"change"}],"extra.cover":[{validator:t,trigger:"change"}],"extra.broadcast_type":[{required:!0,message:"请选择直播类型",trigger:"change"}],"extra.start_time":[{required:!0,message:"请选择直播时间",trigger:"change"}],"extra.intro":[{required:!0,message:"请输入直播间简介",trigger:"blur"}],"extra.banner":[{required:!0,message:"请上传顶部图片",trigger:"change"}],"extra.allow_comment":[{required:!0,message:"请选择评论控制",trigger:"change"}],"extra.allow_share":[{required:!0,message:"请选择是否允许分享",trigger:"change"}],"extra.display_stat":[{required:!0,message:"请选择是否显示数据",trigger:"change"}]}},dialogLoading:!1,publishDialog:{show:!1,title:"发布栏目",form:{channel_id:"",broadcast_ids:""},rules:{channel_id:[{required:!0,message:"请选择栏目",trigger:"change"}]}}}},computed:{imgCount:function(e){var t,a,i=e.dialog,o=e.templateStyleLists;return null!==(t=null===(a=o.find((function(e){return e.value===i.form.extra.template_style})))||void 0===a?void 0:a.count)&&void 0!==t?t:1},customerId:function(){return this.$store.state.user.u_info.site.extra.bigdata_settings.customer_id||"1"},product_id_dsj:function(){return this.$store.state.user.u_info.site.extra.bigdata_settings.product_id||"1"}},methods:{handleReset:function(){this.createDate="",Object.assign(this.queryParams,{startdate:"",live:"",broadcast_type:"",status:"",keyword:"",enddate:"",page:1})},handleQuery:function(){this.queryParams.page=1,this.getList()},handleAdd:function(){this.liveTime="",Object.assign(this.dialog,{title:"新增",id:"",show:!0,form:{channels:[],extra:{type:"broadcast",title:"",banner:"",allow_comment:"1",allow_share:"1",display_stat:"1",template_style:"240",cover:[],broadcast_type:"1",statement:"none",start_time:"",end_time:"",intro:"",view_base_num:"",praise_base_num:"",robot_settings:{enable:0,view:{min:"",max:""},praise:{min:"",max:""}}}}})},handleEdit:function(e){var t=this,a=e.id;this.liveTime="",Object(n["A"])(a).then((function(e){var i=e.data;t.liveTime=[i.extra.start_time,i.extra.end_time],t.$nextTick((function(){Object.assign(t.dialog,{title:"编辑",show:!0,id:a,form:{channels:i.channel.map((function(e){return e.id})),extra:Object(s["a"])(Object(s["a"])({},i.extra),{},{template_style:i.extra.template_style||"240",broadcast_type:i.extra.broadcast_type})}})}))}))},handleDelete:function(e){var t=this,a=e.id;this.$confirm("此操作将永久删除这条ID为".concat(a,"的直播间, 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(n["r"])(a).then((function(){t.$message({message:"删除成功",type:"success"}),t.getList()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},publishChange:function(e){var t=this,a=e.id,i=e.status;Object(n["u"])(a,{status:i}).then((function(){t.$message.success("修改成功"),t.getList()}))},statementChange:function(e){"3"===e&&(this.dialog.form.extra.statement="broadcast")},handlePublish:function(e){var t,a=e.id,i=e.channel;Object.assign(this.publishDialog,{show:!0,form:{channel_id:i.map((function(e){return e.id})),broadcast_ids:a}}),null===(t=this.$refs.publishForm)||void 0===t||t.clearValidate()},watchConsole:function(e){var t=e.id;this.$emit("watchConsole",t)},handleDateChange:function(e,t){var a=e||["",""];"liveTime"===t?(this.dialog.form.extra.start_time=a[0],this.dialog.form.extra.end_time=a[1]):"createDate"===t&&(this.queryParams.startdate=a[0],this.queryParams.enddate=a[1])},enterChangeDialog:function(){var e,t,a=this,i=this.dialog.id,o={channels:this.dialog.form.channels.join(),extra:Object(s["a"])(Object(s["a"])({},this.dialog.form.extra),{},{cover:this.dialog.form.extra.cover.slice(0,this.imgCount)})};null===(e=this.$refs.dialogForm)||void 0===e||e.validate((function(e){e&&(a.dialogLoading=!0,t=i?Object(n["u"])(i,o):Object(n["f"])(o),t.then((function(){a.$message.success("".concat(a.dialog.title,"成功!")),a.dialog.show=!1,a.getList()})).finally((function(){a.dialogLoading=!1})))}))},enterPublishDialog:function(){var e,t=this;null===(e=this.$refs.publishForm)||void 0===e||e.validate((function(e){e&&Object(n["u"])(t.publishDialog.form.broadcast_ids,{channels:t.publishDialog.form.channel_id.join()}).then((function(){t.$message.success("发布成功"),t.publishDialog.show=!1,t.getList()}))}))},getList:function(){var e=this;this.loading=!0;var t=Object(s["a"])({},this.queryParams);Object(n["B"])(this.removePropertyOfNullFor0(t)).then((function(t){e.tableData=(t.data||[]).map((function(t){var a,i,o,r,l;return Object(s["a"])(Object(s["a"])({},t),{},{newsId:(null===(a=t.news[0])||void 0===a?void 0:a.id)||0,broadcast_typeLabel:null!==(i=null===(o=e.broadcast_typeOptions.find((function(e){return e.value===t.broadcast_type})))||void 0===o?void 0:o.label)&&void 0!==i?i:"",liveLabel:null!==(r=null===(l=e.liveOptions.find((function(e){return e.value===t.live})))||void 0===l?void 0:l.label)&&void 0!==r?r:""})})),e.total=t.total;var a=(e.tableData||[]).map((function(e){var t;return(null===(t=e.news[0])||void 0===t?void 0:t.id)||0})),i={customer_id:e.customerId,product_id:e.product_id_dsj,itemIds:a};0!=a.length&&Object(d["h"])(i).then((function(t){var a=t.data;e.tableData.forEach((function(t,i,o){a.forEach((function(a,o,r){t.newsId==a.item_id&&(e.tableData[i].hits=parseInt(a.hits)||0)}))})),e.tablekey=!e.tablekey}))})).finally((function(){e.loading=!1}))},getChannels:function(){var e=this;Object(c["Ib"])({with_special_channels:"topic"}).then((function(t){e.channelsList=t.map((function(e){return Object(s["a"])(Object(s["a"])({},e),{},{disabled:!0})})),e.changeChannelName(e.channelsList)}))}},created:function(){var e,t;this.queryParams.keyword=(null===(e=this.$route.query)||void 0===e?void 0:e.title)||"",this.queryParams.keyword=(null===(t=this.$route.query)||void 0===t?void 0:t.id)||"",this.getChannels()},activated:function(){this.getList()}},g=m,h=(a("269d"),a("2877")),f=Object(h["a"])(g,r,l,!1,null,"8ef29a8a",null),v=f.exports,b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticClass:"xl-watch-console-header",attrs:{height:"120px"}},[a("div",{staticClass:"header--left"},[a("el-image",{staticStyle:{width:"140px",height:"100px"},attrs:{lazy:"",src:e.detail.cover,fit:"contain"}}),a("div",{staticClass:"header--left-detail"},[a("el-row",{staticStyle:{"margin-bottom":"20px"}},[a("el-col",{staticStyle:{"font-weight":"500"},attrs:{span:24}},[e._v(e._s(e.detail.title)+" "),a("span",{staticStyle:{"margin-left":"20px"}},[e._v("(当前状态: "+e._s(e.detail.label)+")")])])],1),a("el-row",{staticStyle:{"margin-bottom":"10px","font-size":"12px"}},[a("el-col",{attrs:{span:24}},[a("span",[e._v(" 开播时间: "+e._s(e.detail.extra.start_time)+" "),0===e.detail.live?a("span",{staticStyle:{"margin-left":"10px"}},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"text",size:"small"},on:{click:e.handleStart}},[e._v("提前开播(点击立即开播)")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"text",size:"small"},on:{click:e.handleDelayStart}},[e._v("调整开播时间")])],1):e._e()])])],1),a("el-row",{staticStyle:{"font-size":"12px"}},[a("el-col",{attrs:{span:24}},[a("span",[e._v(" 结束时间: "+e._s(e.detail.extra.end_time)+" "),0===e.detail.live?a("span",{staticStyle:{"margin-left":"10px"}},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"text",size:"small"},on:{click:e.handleSetEnd}},[e._v("调整直播结束时间")])],1):e._e(),1===e.detail.live?a("span",{staticStyle:{"margin-left":"10px"}},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"text",size:"small"},on:{click:e.handleEnd}},[e._v("提前停播(点击立即停播)")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"text",size:"small"},on:{click:e.handleSetEnd}},[e._v("调整直播结束时间")])],1):e._e(),2===e.detail.live?a("span",{staticStyle:{"margin-left":"10px"}},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"text",size:"small"},on:{click:e.handleStartLive}},[e._v("重新开始")])],1):e._e()])])],1)],1)],1),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"success",size:"mini"},on:{click:e.handleReturn}},[e._v(" 返回上一级 ")])],1),a("el-container",[a("el-aside",{staticStyle:{"background-color":"#fff"},attrs:{width:"145px"}},[a("el-tabs",{staticStyle:{height:"100%"},attrs:{"tab-position":"left"},model:{value:e.currentView,callback:function(t){e.currentView=t},expression:"currentView"}},e._l(e.lists,(function(e){return a("el-tab-pane",{key:e.name,attrs:{label:e.label,name:e.name}})})),1)],1),a("el-main",{staticStyle:{position:"relative"}},[a(e.currentView,e._b({tag:"component"},"component",[e.$props,{newId:e.detail.news_id,uuid:e.detail.extra.comment_uuid}],!1))],1)],1),a("el-dialog",{attrs:{width:"600px",title:e.dialogStart.title,visible:e.dialogStart.show},on:{"update:visible":function(t){return e.$set(e.dialogStart,"show",t)}}},[a("el-form",{ref:"startForm",attrs:{model:e.dialogStart.form,rules:e.dialogStart.rules}},[a("el-form-item",{attrs:{"label-width":"120px",label:"当前开播时间",prop:"old"}},[a("el-date-picker",{attrs:{disabled:"",type:"datetime",align:"right",size:"small","unlink-panels":"","range-separator":"~","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.dialogStart.form.old,callback:function(t){e.$set(e.dialogStart.form,"old",t)},expression:"dialogStart.form.old"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"调整到",prop:"now"}},[a("el-date-picker",{attrs:{type:"datetime",align:"right",size:"small","unlink-panels":"","range-separator":"~","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.dialogStart.form.now,callback:function(t){e.$set(e.dialogStart.form,"now",t)},expression:"dialogStart.form.now"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:function(t){e.dialogStart.show=!1}}},[e._v(" 取 消 ")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:e.enterStartDialog}},[e._v(" 确 定 ")])],1)],1),a("el-dialog",{attrs:{width:"600px",title:e.dialogEnd.title,visible:e.dialogEnd.show},on:{"update:visible":function(t){return e.$set(e.dialogEnd,"show",t)}}},[a("el-form",{ref:"endForm",attrs:{model:e.dialogEnd.form,rules:e.dialogEnd.rules}},[a("el-form-item",{attrs:{"label-width":"120px",label:"当前结束时间",prop:"old"}},[a("el-date-picker",{attrs:{disabled:"",type:"datetime",align:"right",size:"small","unlink-panels":"","range-separator":"~","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.dialogEnd.form.old,callback:function(t){e.$set(e.dialogEnd.form,"old",t)},expression:"dialogEnd.form.old"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"调整到",prop:"now"}},[a("el-date-picker",{attrs:{type:"datetime",align:"right",size:"small","unlink-panels":"","range-separator":"~","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.dialogEnd.form.now,callback:function(t){e.$set(e.dialogEnd.form,"now",t)},expression:"dialogEnd.form.now"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:function(t){e.dialogEnd.show=!1}}},[e._v(" 取 消 ")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:e.enterEndDialog}},[e._v(" 确 定 ")])],1)],1),a("el-dialog",{attrs:{width:"600px",title:e.dialogStartLive.title,visible:e.dialogStartLive.show},on:{"update:visible":function(t){return e.$set(e.dialogStartLive,"show",t)}}},[a("el-form",{ref:"startLiveForm",attrs:{model:e.dialogStartLive.form,rules:e.dialogStartLive.rules}},[a("el-form-item",{attrs:{"label-width":"120px",label:"开始时间",prop:"old"}},[a("el-date-picker",{attrs:{type:"datetime",align:"right",size:"small","unlink-panels":"","range-separator":"~","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.dialogStartLive.form.old,callback:function(t){e.$set(e.dialogStartLive.form,"old",t)},expression:"dialogStartLive.form.old"}})],1),a("el-form-item",{attrs:{"label-width":"120px",label:"结束时间",prop:"now"}},[a("el-date-picker",{attrs:{type:"datetime",align:"right",size:"small","unlink-panels":"","range-separator":"~","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.dialogStartLive.form.now,callback:function(t){e.$set(e.dialogStartLive.form,"now",t)},expression:"dialogStartLive.form.now"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:function(t){e.dialogStartLive.show=!1}}},[e._v(" 取 消 ")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:e.enterStartLiveDialog}},[e._v(" 确 定 ")])],1)],1)],1)},x=[],_=(a("a9e3"),a("b0c0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"xl-reservation"},[a("div",{staticClass:"xl-reservation-add"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:e.handleAdd}},[e._v(" 新增机位 ")])],1),a("el-tabs",{attrs:{closable:""},on:{"tab-remove":e.handleDelete},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("div",{staticClass:"xl-reservation-save"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary",size:"mini"},on:{click:e.handleSave}},[e._v(" 保存 ")])],1),e._l(e.lists,(function(t){return a("el-tab-pane",{key:t.extra.sort,attrs:{label:t.oldName,name:""+t.extra.sort}},[a("el-form",{ref:"form",refInFor:!0,attrs:{model:t,rules:e.rules,"label-width":"120px",size:"small"}},[a("el-form-item",{attrs:{label:"机位状态"}},[a("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:t.extra.is_valid,callback:function(a){e.$set(t.extra,"is_valid",a)},expression:"item.extra.is_valid"}})],1),a("el-form-item",{attrs:{label:"机位名称",prop:"extra.name"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入机位名称",clearable:"",size:"small"},model:{value:t.extra.name,callback:function(a){e.$set(t.extra,"name",a)},expression:"item.extra.name"}})],1),a("el-form-item",{attrs:{label:"机位头图",prop:"extra.cover"}},[a("upload-single",{model:{value:t.extra.cover,callback:function(a){e.$set(t.extra,"cover",a)},expression:"item.extra.cover"}})],1),a("el-form-item",{attrs:{label:"机位流地址",prop:"extra.stream_url"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入机位流地址",clearable:"",size:"small"},model:{value:t.extra.stream_url,callback:function(a){e.$set(t.extra,"stream_url",a)},expression:"item.extra.stream_url"}})],1),a("el-form-item",{attrs:{label:"备用流地址",prop:"extra.stream_url_backup"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入备用流地址",clearable:"",size:"small"},model:{value:t.extra.stream_url_backup,callback:function(a){e.$set(t.extra,"stream_url_backup",a)},expression:"item.extra.stream_url_backup"}})],1),a("el-form-item",{attrs:{label:"支持回看:",prop:"extra.allow_replay"}},[a("el-radio-group",{model:{value:t.extra.allow_replay,callback:function(a){e.$set(t.extra,"allow_replay",a)},expression:"item.extra.allow_replay"}},e._l(e.replayOptions,(function(t){return a("el-radio",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1),"1"===t.extra.allow_replay?a("el-form-item",{attrs:{label:"回放流地址",prop:"extra.replay_stream"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入回放流地址",clearable:"",size:"small"},model:{value:t.extra.replay_stream,callback:function(a){e.$set(t.extra,"replay_stream",a)},expression:"item.extra.replay_stream"}})],1):e._e(),a("el-form-item",{attrs:{label:"直播引导片"}},[a("el-switch",{model:{value:t.guide,callback:function(a){e.$set(t,"guide",a)},expression:"item.guide"}})],1),t.guide?a("el-form-item",{attrs:{label:"播放时间",prop:"extra.guide_play_time"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择日期时间"},model:{value:t.extra.guide_play_time,callback:function(a){e.$set(t.extra,"guide_play_time",a)},expression:"item.extra.guide_play_time"}})],1):e._e(),t.guide?a("el-form-item",{attrs:{label:"上传引导片",prop:"extra.guide_video"}},[a("upload-video",{model:{value:t.extra.guide_video,callback:function(a){e.$set(t.extra,"guide_video",a)},expression:"item.extra.guide_video"}})],1):e._e()],1)],1)}))],2)],1)}),w=[],y=a("1da1"),k=a("2909"),$=(a("96cf"),a("4e82"),a("498a"),a("c740"),a("a434"),a("25f0"),a("9fd7")),C={components:{uploadSingle:u["a"],uploadVideo:$["a"]},props:{id:Number},data:function(){return{activeName:"",lists:[],replayOptions:[{label:"是",value:"1"},{label:"否",value:"0"}],rules:{"extra.name":[{required:!0,message:"请输入机位名称",trigger:"blur"}],"extra.cover":[{required:!0,message:"请上传机位头图",trigger:"change"}],"extra.replay_stream":[{required:!0,message:"请输入回放流地址",trigger:"blur"}],"extra.guide_play_time":[{required:!0,message:"请选择引导片播放时间",trigger:"change"}],"extra.guide_video":[{required:!0,message:"请上传引导片",trigger:"change"}]}}},methods:{handleAdd:function(){var e,t=this,a=((null===(e=Object(k["a"])(this.lists).pop())||void 0===e?void 0:e.extra.sort)||0)+1;this.$prompt("请输入机位名","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputErrorMessage:"请输入机位名",inputValidator:function(e){return null!=e&&""!==e.trim()}}).then((function(e){var i=e.value;t.lists.push({broadcast_id:t.id,oldName:i,extra:{sort:a,name:i,oldName:i,cover:"",is_valid:"1",stream_url:"",guide_video:"",allow_replay:"0",replay_stream:"",guide_play_time:"",stream_url_backup:""}}),t.activeName="".concat(a)})).catch((function(){t.$message({type:"info",message:"取消输入"})}))},handleDelete:function(e){var t=this,a=this.lists.findIndex((function(t){return t.extra.sort==e}));if(a){var i=this.lists[a],o=i.extra,r=i.id;this.$confirm("此操作将永久删除这条名称为".concat(o.name,"的机位, 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e,i=(null===(e=t.lists[a+1]||t.lists[a-1])||void 0===e?void 0:e.extra.sort)||"";null==r?(t.lists.splice(a,1),i&&(t.activeName="".concat(i))):Object(n["q"])(r).then(Object(y["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.$message({message:"删除成功",type:"success"}),e.next=3,t.getList();case 3:i&&(t.activeName="".concat(i));case 4:case"end":return e.stop()}}),e)}))))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))}},handleSave:function(){var e,t=this,a=this.lists.findIndex((function(e){return e.extra.sort==t.activeName}));null===(e=this.$refs.form[a])||void 0===e||e.validate((function(e){if(e){var i,o=t.lists[a],r=o.id,l=o.extra,c={broadcast_id:t.id,extra:Object(s["a"])({},l)};i=null!=r?Object(n["t"])(r,c):Object(n["e"])(c),i.then((function(){t.$message.success("保存成功!"),t.getList()}))}}))},getList:function(){var e=this;return Object(n["A"])(this.id).then((function(t){var a=t.data;e.lists=(a.extra.stream||[]).sort((function(e,t){return e.extra.sort-t.extra.sort})).map((function(e){return Object(s["a"])(Object(s["a"])({},e),{},{oldName:e.extra.name.toString(),guide:!(!e.extra.guide_video||!e.extra.guide_play_time)})}))}))}},created:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getList();case 2:i=null===(a=e.lists[0])||void 0===a?void 0:a.extra.sort,e.activeName=null!=i?"".concat(i):"";case 4:case"end":return t.stop()}}),t)})))()}},S=C,L=(a("d556"),Object(h["a"])(S,_,w,!1,null,"bbbbf6e8",null)),O=L.exports,D=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"xl-direct-seeding"},["none"!=e.statement?a("div",[a("el-tabs",{staticStyle:{width:"100%"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.streamlist,(function(t,i){return a("el-tab-pane",{key:i,attrs:{label:"stream"==e.statement?t.extra.name:"",name:t.extra.name}},[a("div",{staticStyle:{height:"400px","margin-bottom":"30px"}},[a("el-table",{ref:"tableList",refInFor:!0,staticStyle:{width:"100%"},attrs:{data:e.dataList,height:"400"}},[a("el-table-column",{attrs:{prop:"created_at",label:"时间"}}),a("el-table-column",{attrs:{label:"内容"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.extra.text))]),t.row.extra.img_list.length>0?a("div",{staticStyle:{display:"flex","margin-bottom":"10px"}},e._l(t.row.extra.img_list,(function(e,i){return a("el-image",{key:i,staticStyle:{width:"100px",height:"100px","margin-right":"10px"},attrs:{src:e.path,"preview-src-list":t.row.img_lists}})})),1):e._e(),t.row.extra.video_list[0].path?a("video",{attrs:{height:"100",controls:"",preload:"metadata"}},[a("source",{attrs:{src:t.row.extra.video_list[0].path}}),e._v(" 您的浏览器不支持 HTML5 video 标签。 ")]):e._e()]}}],null,!0)}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"260"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("Iconbutton",{attrs:{icontype:"xg",label:"修改"},on:{fatherMethod:function(a){return e.handleEdit(t.row)}}}),a("Iconbutton",{attrs:{icontype:"sc",label:"删除"},on:{fatherMethod:function(a){return e.handleDelete(t.row)}}})]}}],null,!0)})],1)],1)])})),1),a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"文字：",prop:"text"}},[a("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入文字内容",clearable:""},model:{value:e.ruleForm.extra.text,callback:function(t){e.$set(e.ruleForm.extra,"text",t)},expression:"ruleForm.extra.text"}})],1),a("el-form-item",{attrs:{label:"图片：",prop:"text"}},[e.broadcastId?a("cropper",{ref:"cropper",attrs:{count:e.count,lists:e.imgLists},model:{value:e.path_list,callback:function(t){e.path_list=t},expression:"path_list"}}):a("cropper-add",{ref:"cropper",attrs:{count:e.count,lists:e.imgLists},model:{value:e.path_list,callback:function(t){e.path_list=t},expression:"path_list"}})],1),a("el-form-item",{attrs:{label:"视频：",prop:"text"}},[a("upload-video",{ref:"UploadVideo",model:{value:e.extra_video,callback:function(t){e.extra_video=t},expression:"extra_video"}})],1),a("el-form-item",[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("发送")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)],1):e._e()])},N=[],j=(a("4de4"),a("469d")),F=a("156b"),z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"xl-cropper"},[a("ul",{staticClass:"xl-cropper-ul"},e._l(e.imgList,(function(t,i){return a("li",{key:i,staticClass:"xl-cropper-li"},[a("el-upload",{directives:[{name:"show",rawName:"v-show",value:e.count>=i+1,expression:"count >= index + 1"}],ref:"uploader",refInFor:!0,staticClass:"xl-cropper-uploader",attrs:{disabled:e.disabled,action:e.actionUrl,"show-file-list":!1,name:"image",accept:"image/jpeg,image/png,image/gif",headers:e.uploadHeader,"on-success":e.handleUploadImageSuccess(i),"on-error":e.handleUploadImageError,"before-upload":e.beforeUpload,"on-exceed":e.handleOnExceed}},[a("i",{directives:[{name:"show",rawName:"v-show",value:""===t.path,expression:"list.path === ''"}],staticClass:"el-icon-plus"}),a("div",{directives:[{name:"show",rawName:"v-show",value:t.path,expression:"list.path"}],staticStyle:{"line-height":"98px",height:"100%"},on:{click:function(e){e.stopPropagation()}}},[a("el-image",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:t.path}}),a("span",{directives:[{name:"show",rawName:"v-show",value:"success"===t.status,expression:"list.status === 'success'"}],staticClass:"el-upload-list__item-actions"},[a("span",{staticClass:"xl-cropper-icon",on:{click:function(a){return e.handlePictureCardPreview(t)}}},[a("i",{staticClass:"el-icon-zoom-in"})]),a("span",{directives:[{name:"show",rawName:"v-show",value:!e.disabled&&e.hasUploadAgain,expression:"!disabled && hasUploadAgain"}],staticClass:"xl-cropper-icon",on:{click:function(t){return e.handleUpload(i)}}},[a("i",{staticClass:"el-icon-upload"})]),a("span",{directives:[{name:"show",rawName:"v-show",value:!e.disabled,expression:"!disabled"}],staticClass:"xl-cropper-icon",on:{click:function(a){return e.handleShear(t,i)}}},[a("i",{staticClass:"el-icon-scissors"})]),a("span",{directives:[{name:"show",rawName:"v-show",value:!e.disabled&&e.hasRemove,expression:"!disabled && hasRemove"}],staticClass:"xl-cropper-icon",on:{click:function(t){return e.handleRemove(i)}}},[a("i",{staticClass:"el-icon-delete"})])])],1)])],1)})),0),e.showTip?a("div",{staticClass:"xl-cropper-tip"},[e._v("上传封面,建议比例16:9（最佳尺寸750*420）,单个图片不超过10M!")]):e._e(),a("el-dialog",{attrs:{width:"600px",title:e.dialog.title,visible:e.dialog.show,"append-to-body":""},on:{"update:visible":function(t){return e.$set(e.dialog,"show",t)}}},[a("div",{staticClass:"xl-cropper-box"},[a("div",{staticClass:"xl-cropper-box-left"},[a("vueCropper",{ref:"cropper",attrs:{img:e.option.img,"output-size":e.option.size,"output-type":e.option.outputType,info:!0,full:e.option.full,"can-move":e.option.canMove,"can-move-box":e.option.canMoveBox,original:e.option.original,"auto-crop":e.option.autoCrop,"auto-crop-width":e.option.autoCropWidth,"auto-crop-height":e.option.autoCropHeight,"fixed-box":e.option.fixedBox,"fixed-number":e.option.fixedNumber,fixed:e.option.fixed,"info-true":e.option.infoTrue}})],1),a("div",{staticClass:"xl-cropper-box-right"},[a("el-radio-group",{staticClass:"radio-select",on:{change:e.proportionChange},model:{value:e.proportionVal,callback:function(t){e.proportionVal=t},expression:"proportionVal"}},e._l(e.proportion,(function(t,i){return a("el-radio",{key:i,staticClass:"radio-select-item",attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1)]),a("div",{staticClass:"xl-cropper-footer"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:e.closeDialog}},[e._v("取 消")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:e.enterDialog}},[e._v("确 定")])],1)]),a("el-dialog",{attrs:{visible:e.bigImgDialog.show,"append-to-body":""},on:{"update:visible":function(t){return e.$set(e.bigImgDialog,"show",t)}}},[a("img",{attrs:{width:"100%",src:e.bigImgDialog.path,alt:""}})])],1)},q=[],E=(a("caad"),a("2532"),a("7e79")),I=a("cc48"),T={components:{VueCropper:E["VueCropper"]},props:{value:{type:Array,default:function(){return[]}},disabled:{type:Boolean,default:!1},count:{type:[Number,String],default:1},lists:{type:Array,default:[]},showTip:{type:Boolean,default:!0},hasRemove:{type:Boolean,default:!0},hasUploadAgain:{type:Boolean,default:!0}},data:function(){return{fileLists:[{path:""}],dialog:{title:"裁剪",show:!1},bigImgDialog:{show:!1,path:""},option:{img:a("3f1e"),outputSize:1,outputType:"png",full:!1,canMove:!1,original:!1,canMoveBox:!0,autoCrop:!0,fixedBox:!1,autoCropWidth:686,autoCropHeight:180,maxImgSize:"2000",fixed:!0,fixedNumber:[16,9],infoTrue:!0,mode:"contain"},proportion:[{label:"16:9",value:1,option:{fixed:!0,full:!1,fixedBox:!1,fixedNumber:[16,9]}},{label:"4:3",value:2,option:{fixed:!0,full:!1,fixedBox:!1,fixedNumber:[4,3]}},{label:"10:14.2",value:3,option:{fixed:!0,full:!1,fixedBox:!1,fixedNumber:[10,14.269]}},{label:"蓝媒视频竖屏",value:4,option:{fixed:!0,full:!1,fixedBox:!1,fixedNumber:[10,15.5]}},{label:"自定义",value:5,option:{fixed:!1,fixedBox:!0,full:!1}},{label:"不剪切",value:6,option:{fixedBox:!1,full:!0}}],proportionVal:1}},computed:{imgList:{get:function(){return this.lists.length?this.lists:this.fileLists},set:function(){}},actionUrl:function(){return this.imgurl},uploadHeader:function(){var e=sessionStorage.getItem("token");return{Authorization:e}}},methods:{handleUpload:function(e){this.$refs.uploader[e].$refs["upload-inner"].$refs.input.click()},rest:function(){this.imgList=[{path:""}],this.$forceUpdate()},uploadImgFn:function(e){var t=new FormData;return t.append(e.filename,e.file,e.file.name),Object(I["X"])({url:e.action,method:"post",data:t})},handleOnExceed:function(){this.$message.warning("图片上传超出限制!")},beforeUpload:function(e){var t=e.size/1024/1024<=10,a=["jpeg","gif","png"],i=a.find((function(t){return e.type.includes(t)}));i||this.$message.error("上传图片只能是 ".concat(a.join()," 格式!")),t||this.$message.error("上传图片大小不能超过 10MB!");var o=i&&t;return o},handleUploadImageSuccess:function(e){var t=this;return function(a,i,o){a.status_code>=200&&a.status_code<300?(t.$message.success("图片上传成功!"),Object.assign(t.imgList[e],{intro:"",status:"success",path:a.path}),t.imgList.length<10?t.imgList.push({path:""}):t.$message("最多只能上传9张图片")):(t.$message.error("图片上传失败!"),Object.assign(t.imgList[e],{intro:"",path:""}),o.length=0),t.$emit("input",t.imgList)}},handleUploadImageError:function(){this.$message.error("图片上传失败!")},handleRemove:function(e){this.imgList[e].path="",this.imgList.splice(e,1),this.$emit("input",this.imgList)},handlePictureCardPreview:function(e){this.bigImgDialog={show:!0,path:e.path}},imgToBase64:function(e){return new Promise((function(t,a){var i=new Image;i.crossOrigin="anonymous",i.src=e,i.onload=function(){var e=document.createElement("canvas");e.width=i.width,e.height=i.height;var a=e.getContext("2d");a.drawImage(i,0,0,i.width,i.height);var o=i.src.substring(i.src.lastIndexOf(".")+1).toLowerCase(),r=e.toDataURL("image/"+o);t(r)},i.onerror=function(){a()}}))},handleShear:function(e,t){this.option.img=e.path,Object.assign(this.dialog,{show:!0,index:t})},proportionChange:function(e){var t=this.proportion.find((function(t){return e===t.value}));this.option.autoCropWidth=Math.random()+686,this.$set(this,"option",Object(s["a"])(Object(s["a"])({},this.option),t.option))},closeDialog:function(){this.dialog.show=!1},enterDialog:function(){var e=this;this.$refs.cropper.getCropBlob((function(t){var a=new File([t],"".concat((new Date).getTime(),".png"),{type:t.type});e.uploadImgFn({action:"/api/upload/image",filename:"image",file:a}).then((function(t){t.status_code>=200&&t.status_code<300&&(e.imgList[e.dialog.index].path=t.path,e.$emit("changeCropper",t.path),e.dialog.show=!1)}))}))}}},B=T,U=(a("7d85"),Object(h["a"])(B,z,q,!1,null,null,null)),P=U.exports,M=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"xl-upload-video"},[a("el-upload",{attrs:{name:"file",accept:"video/*",action:e.actionUrl,headers:e.uploadHeader,"show-file-list":!1,"on-success":e.handleUploadSuccess,"before-upload":e.beforeUploadVideo,"on-progress":e.handleProgress,"on-error":e.handleUploadError}},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}]},[e._v("上传视频"),a("i",{staticClass:"el-icon-upload el-icon--right",staticStyle:{"font-size":"14px"}})])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.value,expression:"value"}],staticClass:"xl-upload-video--play",on:{click:e.play}},[e._v(e._s(e.value)+" "),a("i",{staticClass:"el-icon-video-play"})]),a("el-progress",{directives:[{name:"show",rawName:"v-show",value:e.percentage,expression:"percentage"}],attrs:{percentage:e.percentage}}),e.dialog.show?a("el-dialog",{attrs:{width:"640px",title:"视频",visible:e.dialog.show},on:{"update:visible":function(t){return e.$set(e.dialog,"show",t)}}},[a("video",{attrs:{height:"400",width:"600",controls:""}},[a("source",{attrs:{src:e.dialog.url}}),e._v(" 您的浏览器不支持 video 标签。 ")])]):e._e()],1)},H=[],R=(a("ac1f"),a("1276"),{props:{value:String},data:function(){return{percentage:0,dialog:{show:!1,url:""}}},computed:{actionUrl:function(){return this.videourl},uploadHeader:function(){var e=sessionStorage.getItem("token");return{Authorization:e}},type:function(){var e=this.value&&this.value.split(".");return(null===e||void 0===e?void 0:e[e.length-1])||""}},methods:{beforeUploadVideo:function(e){var t=e.size/1024/1024<=300,a=["video/mp4","video/ogg","video/flv","video/avi","video/wmv","video/rmvb","video/mov"];return-1==a.indexOf(e.type)?(this.$message.warning("请上传正确的视频格式: ".concat(a.join())),!1):t?(this.percentage=0,!0):(this.$message.warning("视频大小不能超过300MB"),!1)},handleProgress:function(){this.percentage=90},handleUploadSuccess:function(e,t,a){e.status_code>=200&&e.status_code<300?(this.percentage=100,this.$message.success("视频上传成功!"),this.$emit("input",e.path)):(this.$message.error("视频上传失败!"),this.percentage=0,a.length=0)},handleUploadError:function(){this.$message.error("上传失败, 请重新上传!"),this.percentage=0},rest:function(){this.percentage=0},play:function(){this.dialog={show:!0,url:this.value}}}}),V=R,A=(a("a255"),Object(h["a"])(V,M,H,!1,null,"6586b86c",null)),W=A.exports,Q=a("ed08"),J=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"xl-cropper"},[a("ul",{staticClass:"xl-cropper-ul"},e._l(e.fileLists,(function(t,i){return a("li",{key:i,staticClass:"xl-cropper-li"},[a("el-upload",{directives:[{name:"show",rawName:"v-show",value:e.count>=i+1,expression:"count >= index + 1"}],ref:"uploader",refInFor:!0,staticClass:"xl-cropper-uploader",attrs:{disabled:e.disabled,action:e.actionUrl,"show-file-list":!1,name:"image",accept:"image/jpeg,image/png,image/gif",headers:e.uploadHeader,"on-success":e.handleUploadImageSuccess(i),"on-error":e.handleUploadImageError,"before-upload":e.beforeUpload,"on-exceed":e.handleOnExceed}},[a("i",{directives:[{name:"show",rawName:"v-show",value:""===t.path,expression:"list.path === ''"}],staticClass:"el-icon-plus"}),a("div",{directives:[{name:"show",rawName:"v-show",value:t.path,expression:"list.path"}],staticStyle:{"line-height":"98px",height:"100%"},on:{click:function(e){e.stopPropagation()}}},[a("el-image",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:t.path,fit:"contain"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:"success"===t.status,expression:"list.status === 'success'"}],staticClass:"el-upload-list__item-actions"},[a("span",{staticClass:"xl-cropper-icon",on:{click:function(a){return e.handlePictureCardPreview(t)}}},[a("i",{staticClass:"el-icon-zoom-in"})]),a("span",{directives:[{name:"show",rawName:"v-show",value:!e.disabled&&e.hasUploadAgain,expression:"!disabled && hasUploadAgain"}],staticClass:"xl-cropper-icon",on:{click:function(t){return e.handleUpload(i)}}},[a("i",{staticClass:"el-icon-upload"})]),a("span",{directives:[{name:"show",rawName:"v-show",value:!e.disabled,expression:"!disabled"}],staticClass:"xl-cropper-icon",on:{click:function(a){return e.handleShear(t,i)}}},[a("i",{staticClass:"el-icon-scissors"})]),a("span",{directives:[{name:"show",rawName:"v-show",value:!e.disabled&&e.hasRemove,expression:"!disabled && hasRemove"}],staticClass:"xl-cropper-icon",on:{click:function(t){return e.handleRemove(i)}}},[a("i",{staticClass:"el-icon-delete"})])])],1)])],1)})),0),e.showTip?a("div",{staticClass:"xl-cropper-tip"},[e._v("上传封面,建议比例16:9（最佳尺寸750*420）,单个图片不超过10M!")]):e._e(),a("el-dialog",{attrs:{width:"600px",title:e.dialog.title,visible:e.dialog.show,"append-to-body":""},on:{"update:visible":function(t){return e.$set(e.dialog,"show",t)}}},[a("div",{staticClass:"xl-cropper-box"},[a("div",{staticClass:"xl-cropper-box-left"},[a("vueCropper",{ref:"cropper",attrs:{img:e.option.img,"output-size":e.option.size,"output-type":e.option.outputType,info:!0,full:e.option.full,"can-move":e.option.canMove,"can-move-box":e.option.canMoveBox,original:e.option.original,"auto-crop":e.option.autoCrop,"auto-crop-width":e.option.autoCropWidth,"auto-crop-height":e.option.autoCropHeight,"fixed-box":e.option.fixedBox,"fixed-number":e.option.fixedNumber,fixed:e.option.fixed,"info-true":e.option.infoTrue}})],1),a("div",{staticClass:"xl-cropper-box-right"},[a("el-radio-group",{staticClass:"radio-select",on:{change:e.proportionChange},model:{value:e.proportionVal,callback:function(t){e.proportionVal=t},expression:"proportionVal"}},e._l(e.proportion,(function(t,i){return a("el-radio",{key:i,staticClass:"radio-select-item",attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1)]),a("div",{staticClass:"xl-cropper-footer"},[a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:e.closeDialog}},[e._v("取 消")]),a("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:e.enterDialog}},[e._v("确 定")])],1)]),a("el-dialog",{attrs:{visible:e.bigImgDialog.show,"append-to-body":""},on:{"update:visible":function(t){return e.$set(e.bigImgDialog,"show",t)}}},[a("img",{attrs:{width:"100%",src:e.bigImgDialog.path,alt:""}})])],1)},X=[],G={components:{VueCropper:E["VueCropper"]},props:{value:{type:Array,default:function(){return[]}},disabled:{type:Boolean,default:!1},count:{type:[Number,String],default:1},showTip:{type:Boolean,default:!0},hasRemove:{type:Boolean,default:!0},hasUploadAgain:{type:Boolean,default:!0}},data:function(){return{fileLists:[{path:""}],dialog:{title:"裁剪",show:!1},bigImgDialog:{show:!1,path:""},option:{img:a("3f1e"),outputSize:1,outputType:"png",full:!1,canMove:!1,original:!1,canMoveBox:!0,autoCrop:!0,fixedBox:!1,autoCropWidth:686,autoCropHeight:180,maxImgSize:"2000",fixed:!0,fixedNumber:[16,9],infoTrue:!0,mode:"contain"},proportion:[{label:"16:9",value:1,option:{fixed:!0,full:!1,fixedBox:!1,fixedNumber:[16,9]}},{label:"4:3",value:2,option:{fixed:!0,full:!1,fixedBox:!1,fixedNumber:[4,3]}},{label:"10:14.2",value:3,option:{fixed:!0,full:!1,fixedBox:!1,fixedNumber:[10,14.269]}},{label:"蓝媒视频竖屏",value:4,option:{fixed:!0,full:!1,fixedBox:!1,fixedNumber:[10,15.5]}},{label:"自定义",value:5,option:{fixed:!1,fixedBox:!0,full:!1}},{label:"不剪切",value:6,option:{fixedBox:!1,full:!0}}],proportionVal:1}},computed:{actionUrl:function(){return this.imgurl},uploadHeader:function(){var e=sessionStorage.getItem("token");return{Authorization:e}}},methods:{handleUpload:function(e){this.$refs.uploader[e].$refs["upload-inner"].$refs.input.click()},rest:function(){this.fileLists=[{path:""}]},uploadImgFn:function(e){var t=new FormData;return t.append(e.filename,e.file,e.file.name),Object(I["X"])({url:e.action,method:"post",data:t})},handleOnExceed:function(){this.$message.warning("图片上传超出限制!")},beforeUpload:function(e){var t=e.size/1024/1024<=10,a=["jpeg","gif","png"],i=a.find((function(t){return e.type.includes(t)}));i||this.$message.error("上传图片只能是 ".concat(a.join()," 格式!")),t||this.$message.error("上传图片大小不能超过 10MB!");var o=i&&t;return o},handleUploadImageSuccess:function(e){var t=this;return function(a,i,o){a.status_code>=200&&a.status_code<300?(t.$message.success("图片上传成功!"),Object.assign(t.fileLists[e],{intro:"",status:"success",path:a.path}),t.fileLists.length<10?t.fileLists.push({path:""}):t.$message("最多只能上传9张图片")):(t.$message.error("图片上传失败!"),Object.assign(t.fileLists[e],{intro:"",path:""}),o.length=0),t.$emit("input",t.fileLists)}},handleUploadImageError:function(){this.$message.error("图片上传失败!")},handleRemove:function(e){this.fileLists[e].path="",this.fileLists.splice(e,1),this.$emit("input",this.fileLists)},handlePictureCardPreview:function(e){this.bigImgDialog={show:!0,path:e.path}},imgToBase64:function(e){return new Promise((function(t,a){var i=new Image;i.crossOrigin="anonymous",i.src=e,i.onload=function(){var e=document.createElement("canvas");e.width=i.width,e.height=i.height;var a=e.getContext("2d");a.drawImage(i,0,0,i.width,i.height);var o=i.src.substring(i.src.lastIndexOf(".")+1).toLowerCase(),r=e.toDataURL("image/"+o);t(r)},i.onerror=function(){a()}}))},handleShear:function(e,t){this.option.img=e.path,Object.assign(this.dialog,{show:!0,index:t})},proportionChange:function(e){var t=this.proportion.find((function(t){return e===t.value}));this.option.autoCropWidth=Math.random()+686,this.$set(this,"option",Object(s["a"])(Object(s["a"])({},this.option),t.option))},closeDialog:function(){this.dialog.show=!1},enterDialog:function(){var e=this;this.$refs.cropper.getCropBlob((function(t){var a=new File([t],"".concat((new Date).getTime(),".png"),{type:t.type});e.uploadImgFn({action:"/api/upload/image",filename:"image",file:a}).then((function(t){t.status_code>=200&&t.status_code<300&&(e.fileLists[e.dialog.index].path=t.path,e.$emit("changeCropper",t.path),e.dialog.show=!1)}))}))}}},K=G,Y=(a("3b32"),Object(h["a"])(K,J,X,!1,null,null,null)),Z=Y.exports,ee={data:function(){return{activeName:"",statement:"",path_list:[],imgLists:[],broadcastId:"",extra_video:"",count:9,ruleForm:{broadcast_id:"",host_name:"",content:"",stream_id:"",time:"",file:"",extra:{text:"",img_list:[],video_list:[{path:""}]}},rules:{content:[{required:!0,message:"请填写文字",trigger:"blur"}]},statementquery:{id:"",stream_id:"",pageSize:9999},dataList:[],streamlist:[]}},components:{Editor:F["a"],Cropper:P,uploadVideo:W,CropperAdd:Z},props:{id:Number},created:function(){this.statementquery.id=this.id,this.getbroadcastStatement()},updated:function(){this.downscroll()},methods:{handleAvatarSuccess:function(e,t){this.ruleForm[e]=t.path},beforeAvatarUpload:function(e){var t=e.size/1024/1024<20;return t||this.$message.error("上传头像图片大小不能超过 20MB!"),t},downscroll:function(){try{this.$refs.tableList.forEach((function(e){e.bodyWrapper.scrollTop=e.bodyWrapper.scrollHeight}))}catch(e){}},getbroadcastStatement:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getbroadcasts();case 2:t.sent,e.getdatalist();case 4:case"end":return t.stop()}}),t)})))()},getdatalist:function(){var e=this;this.dataList=[],Object(c["ic"])(this.statementquery.id,this.statementquery.stream_id,this.statementquery.pageSize).then((function(t){e.dataList=t.data.reverse();var a=(t.data||[]).map((function(e){if(null==e.extra){delete e.extra;var t={text:"",img_list:[],video_list:[{path:""}]};e.extra=t,e.img_lists=[]}return Object(s["a"])({},e)}));e.dataList=a.map((function(e){var t=(e.extra.img_list||[]).map((function(e){return e.path}));return Object(s["a"])({img_lists:t},e)}))}))},handleEdit:function(e){this.broadcastId=e.id,this.ruleForm.extra.text=e.extra.text||"",this.extra_video=e.extra.video_list[0].path||"",this.path_list=e.extra.img_list||[],this.imgLists=Object(Q["c"])(e.extra.img_list)||[],this.imgLists.map((function(e){return e.status="success",e})),this.imgLists.push({path:""})},handleDelete:function(e){var t=this,a=e.id;this.$confirm("此操作将永久删除这条ID为".concat(a,"的直播间发言, 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(c["O"])(a).then((function(){t.$message({message:"删除成功",type:"success"}),t.getdatalist()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},getbroadcasts:function(){var e=this;return new Promise((function(t,a){Object(c["jc"])(e.id).then((function(a){console.log(a),e.streamlist=a.data.extra.stream,e.streamlist&&e.streamlist.length>0?(e.activeName=e.streamlist[0].extra.name,e.statementquery.stream_id=e.streamlist[0].id,e.statement=a.data.extra.statement):e.streamlist=[{extra:{name:""}}],t(e.streamlist)}))}))},handleClick:function(e,t){var a=parseInt(e.index);this.statementquery.stream_id=this.streamlist[a].id,this.getdatalist()},broadcastRest:function(){this.resetForm("ruleForm"),this.$refs.cropper.rest(),this.path_list=[],this.extra_video="",this.$refs.UploadVideo.rest(),this.ruleForm.extra.text="",this.ruleForm.extra.video_list[0].path="",this.getdatalist(),this.downscroll(),this.$forceUpdate()},submitForm:function(e){var t=this,a=this.path_list.filter((function(e){return e.path})).map((function(e){var t={path:e.path};return t}));this.extra_video&&(this.ruleForm.extra.video_list[0].path=this.extra_video),this.ruleForm.extra.img_list=a.length>0?a:[],this.ruleForm.extra.text||this.extra_video||a.length>0?(console.log("extra",this.ruleForm.extra),this.ruleForm.broadcast_id=this.statementquery.id,this.ruleForm.stream_id=this.statementquery.stream_id,this.ruleForm.host_name="测试",this.ruleForm.time=Object(j["b"])(new Date),this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;t.broadcastId?Object(c["rb"])(t.broadcastId,t.ruleForm).then((function(e){t.$message({message:"修改成功",type:"success"}),t.broadcastRest(),t.broadcastId="",t.imgLists=[]})):Object(c["m"])(t.ruleForm).then((function(e){t.$message({message:"发送成功",type:"success"}),t.broadcastRest()}))}))):this.$message("文字、图片、视频三者不同都为空")},resetForm:function(e){this.$refs[e].resetFields()}}},te=ee,ae=(a("3bbb"),a("1a3b"),Object(h["a"])(te,D,N,!1,null,"a757246c",null)),ie=ae.exports,oe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("comment-verify",{attrs:{"news-id":""+e.uuid}})},re=[],le=a("7d9b"),se={components:{commentVerify:le["default"]},props:{uuid:String}},ne=se,ce=Object(h["a"])(ne,oe,re,!1,null,null,null),de=ce.exports,ue=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"interactive"},[i("div",{staticClass:"list"},[i("div",{staticClass:"item"},[i("img",{attrs:{src:a("99fc"),alt:""}}),i("i",{staticClass:"el-icon-setting bg",on:{click:function(t){return e.configDialog("lucky_draw")}}}),i("div",{staticClass:"title"},[e._v("抽奖")]),i("div",{staticClass:"status"},[e._v(e._s(1==e.interaction_settings.lucky_draw.enable?"已启用":"未启用"))])]),i("div",{staticClass:"item"},[i("img",{attrs:{src:a("5038"),alt:""}}),i("i",{staticClass:"el-icon-setting bg",on:{click:function(t){return e.configDialog("vote")}}}),i("div",{staticClass:"title"},[e._v("投票")]),i("div",{staticClass:"status"},[e._v(e._s(1==e.interaction_settings.vote.enable?"已启用":"未启用"))])]),i("div",{staticClass:"item"},[i("img",{attrs:{src:a("6cdc"),alt:""}}),i("i",{staticClass:"el-icon-setting bg",on:{click:function(t){return e.configDialog("quiz")}}}),i("div",{staticClass:"title"},[e._v("答题")]),i("div",{staticClass:"status"},[e._v(e._s(1==e.interaction_settings.quiz.enable?"已启用":"未启用"))])]),i("div",{staticClass:"item"},[i("img",{attrs:{src:a("e5af"),alt:""}}),i("i",{staticClass:"el-icon-setting bg",on:{click:function(t){return e.configDialog("enroll")}}}),i("div",{staticClass:"title"},[e._v("报名")]),i("div",{staticClass:"status"},[e._v(e._s(1==e.interaction_settings.enroll.enable?"已启用":"未启用"))])]),i("div",{staticClass:"item"},[i("img",{attrs:{src:a("588d"),alt:""}}),i("i",{staticClass:"el-icon-setting bg",on:{click:function(t){return e.configDialog("draw_lots")}}}),i("div",{staticClass:"title"},[e._v("抽签")]),i("div",{staticClass:"status"},[e._v(e._s(1==e.interaction_settings.draw_lots.enable?"已启用":"未启用"))])])]),i("el-dialog",{attrs:{width:"600px",title:e.dialog.title,visible:e.dialog.show},on:{"update:visible":function(t){return e.$set(e.dialog,"show",t)}}},[i("el-form",{ref:"dialogForm",attrs:{model:e.dialogForm,size:"small","label-width":"120px"}},[i("el-form-item",{attrs:{label:"状态",prop:"enable"}},[i("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:e.dialogForm.enable,callback:function(t){e.$set(e.dialogForm,"enable",t)},expression:"dialogForm.enable"}})],1),i("el-form-item",{attrs:{label:"互动地址",prop:"url",rules:{required:1==e.dialogForm.enable,message:"请输入链接地址",trigger:"blur"}}},[i("el-input",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入链接地址"},model:{value:e.dialogForm.url,callback:function(t){e.$set(e.dialogForm,"url",t)},expression:"dialogForm.url"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],on:{click:function(t){e.dialog.show=!1}}},[e._v(" 取 消 ")]),i("el-button",{directives:[{name:"points",rawName:"v-points",value:1500,expression:"1500"}],attrs:{type:"primary"},on:{click:e.enterDialog}},[e._v(" 确 定 ")])],1)],1)],1)},pe=[],me={props:{id:Number},data:function(){return{type:"",interaction_settings:{lucky_draw:{enable:0,url:""},vote:{enable:0,url:""},quiz:{enable:0,url:""},enroll:{enable:0,url:""},draw_lots:{enable:0,url:""}},dialogForm:{url:"",enable:0},dialog:{title:"互动配置",show:!1}}},created:function(){this.getDetails()},methods:{getDetails:function(){var e=this;Object(n["A"])(this.id).then((function(t){var a;e.interaction_settings=(null===(a=t.data.extra)||void 0===a?void 0:a.interaction_settings)||e.interaction_settings}))},configDialog:function(e){this.type=e,this.dialog={title:"互动配置",show:!0},this.dialogForm={url:this.interaction_settings[e].url,enable:this.interaction_settings[e].enable}},enterDialog:function(){var e=this;this.$refs.dialogForm.validate((function(t){var a=function(e,t){var a={};return a[t]=e,a},i=function(t,a){return e.interaction_settings[t][a]};if(t){var o={lucky_draw:{enable:i("lucky_draw","enable"),url:i("lucky_draw","url")},vote:{enable:i("vote","enable"),url:i("vote","url")},quiz:{enable:i("quiz","enable"),url:i("quiz","url")},enroll:{enable:i("enroll","enable"),url:i("enroll","url")},draw_lots:{enable:i("draw_lots","enable"),url:i("draw_lots","url")}};o[e.type].enable=e.dialogForm.enable,o[e.type].url=e.dialogForm.url;var r=a(o,"interaction_settings"),l=a(r,"extra");Object(n["u"])(e.id,l).then((function(){e.$message.success("".concat(e.dialog.title,"成功!")),e.dialog.show=!1,e.getDetails()}))}}))}}},ge=me,he=(a("a7cb"),Object(h["a"])(ge,ue,pe,!1,null,"7bc70b41",null)),fe=he.exports,ve={props:{id:Number},components:{reservation:O,directSeeding:ie,comment:de,interactive:fe},data:function(){var e=this,t=function(t,a,i){var o=new Date(a),r=new Date(e.detail.extra.end_time).getTime();o.getTime()>r?i(new Error("开播时间必须小于现结束时间")):o.getTime()>new Date?i():i(new Error("开播时间必须大于当前时间"))},a=function(e,t,a){var i=new Date(t);i.getTime()>new Date?a():a(new Error("结束时间必须大于当前时间"))};return{detail:{cover:"",extra:{}},currentView:"reservation",dialogStart:{title:"调整开播时间",show:!1,form:{old:"",now:""},rules:{now:[{required:!0,message:"请选择开播时间",trigger:"change"},{validator:t,trigger:"change"}]}},dialogEnd:{title:"调整结束时间",show:!1,form:{old:"",now:""},rules:{now:[{required:!0,message:"请选择结束时间",trigger:"change"},{validator:a,trigger:"change"}]}},dialogStartLive:{title:"重新开始",show:!1,form:{old:"",now:""},rules:{old:[{required:!0,message:"请选择开播时间",trigger:"change"}],now:[{required:!0,message:"请选择结束时间",trigger:"change"}]}}}},computed:{lists:function(){var e=[];return"3"!==this.detail.extra.broadcast_type&&e.push({label:"机位管理",name:"reservation"}),"none"!==this.detail.extra.statement&&e.push({label:"图文直播",name:"directSeeding"}),e.push({label:"评论审核",name:"comment"},{label:"互动配置",name:"interactive"}),e}},methods:{handleReturn:function(){this.$emit("handleReturn")},getList:function(){var e=this;Object(n["A"])(this.id).then((function(t){var a,i=t.data,o={0:"未开始",1:"进行中",2:"已结束"};e.detail=Object(s["a"])(Object(s["a"])({},i),{},{label:o[i.live],cover:null===(a=i.extra.cover[0])||void 0===a?void 0:a.path}),e.currentView=e.lists[0].name,console.log("this.detail",e.detail)}))},handleStart:function(){var e=this;this.$confirm("确认提前开播?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(n["k"])(e.id,{extra:{start_time:e.parseTime(new Date)},live:1}).then((function(){e.$message.success("修改成功!"),e.getList()}))})).catch((function(){}))},handleDelayStart:function(){var e=this;Object.assign(this.dialogStart,{show:!0,form:{old:this.detail.extra.start_time,now:""}}),this.$nextTick((function(){var t;null===(t=e.$refs.startForm)||void 0===t||t.resetFields()}))},enterStartDialog:function(){var e,t=this;null===(e=this.$refs.startForm)||void 0===e||e.validate((function(e){e&&Object(n["k"])(t.id,{extra:{start_time:t.dialogStart.form.now}}).then((function(){t.$message.success("修改成功!"),t.getList()})).finally((function(){t.dialogStart.show=!1}))}))},handleSetEnd:function(){var e=this;Object.assign(this.dialogEnd,{show:!0,form:{old:this.detail.extra.end_time,now:""}}),this.$nextTick((function(){var t;null===(t=e.$refs.endForm)||void 0===t||t.resetFields()}))},handleStartLive:function(){var e=this;Object.assign(this.dialogStartLive,{show:!0,form:{old:this.detail.extra.start_time,now:this.detail.extra.end_time}}),this.$nextTick((function(){var t;null===(t=e.$refs.startLiveForm)||void 0===t||t.resetFields()}))},enterEndDialog:function(){var e,t=this;null===(e=this.$refs.endForm)||void 0===e||e.validate((function(e){e&&Object(n["k"])(t.id,{extra:{end_time:t.dialogEnd.form.now}}).then((function(){t.$message.success("修改成功!"),t.getList()})).finally((function(){t.dialogEnd.show=!1}))}))},enterStartLiveDialog:function(){var e,t=this;null===(e=this.$refs.startLiveForm)||void 0===e||e.validate((function(e){if(e){var a=new Date(t.dialogStartLive.form.old).getTime(),i=new Date(t.dialogStartLive.form.now).getTime();a<i?Object(n["k"])(t.id,{extra:{start_time:t.dialogStartLive.form.old,end_time:t.dialogStartLive.form.now}}).then((function(){t.$message.success("修改成功!"),t.getList()})).finally((function(){t.dialogStartLive.show=!1})):t.$message("开播时间必须小于现结束时间")}}))},handleEnd:function(){var e=this;this.$confirm("确认提前停播?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(n["k"])(e.id,{extra:{end_time:e.parseTime(new Date)},live:2}).then((function(){e.$message.success("修改成功!"),e.getList()}))})).catch((function(){}))}},created:function(){this.getList()}},be=ve,xe=(a("17d0"),Object(h["a"])(be,b,x,!1,null,"f8d66478",null)),_e=xe.exports,we={components:{studioList:v,watchConsole:_e},data:function(){return{component:"studioList",id:0}},computed:{exclude:function(){return["watchConsole"]}},methods:{watchConsole:function(e){this.id=e,this.component="watchConsole"},handleReturn:function(){this.component="studioList"}}},ye=we,ke=Object(h["a"])(ye,i,o,!1,null,"c7ece384",null);t["default"]=ke.exports},d556:function(e,t,a){"use strict";a("57b6")},e5af:function(e,t,a){e.exports=a.p+"static/img/bm.114fcd83.png"},ef21:function(e,t,a){}}]);