(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c1f96428"],{"129f":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"2b19":function(e,t,a){var n=a("23e7"),r=a("129f");n({target:"Object",stat:!0},{is:r})},3908:function(e,t,a){"use strict";a("8ce1")},"48b0":function(e,t,a){},6363:function(e,t,a){"use strict";a("ed88")},"8c22":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"xl-statistics"},[a("transition",{attrs:{name:"fade-transform",mode:"out-in"}},[a("keep-alive",{attrs:{exclude:e.exclude}},[a(e.component,{tag:"component",attrs:{id:e.id},on:{"watch-detail":e.watchDetail,handleReturn:e.handleReturn}})],1)],1)],1)},r=[],i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"xl-statistics-lists"},[a("el-tabs",{staticStyle:{height:"100%"},attrs:{"tab-position":"left"}},[a("el-tab-pane",{attrs:{label:"按部门查看"}},[a("el-form",{ref:"department",attrs:{model:e.department.queryParams,inline:!0}},[a("el-form-item",{attrs:{label:"时间区间:",prop:"Date"}},[a("el-date-picker",{attrs:{type:"daterange",align:"right",size:"small","unlink-panels":"","range-separator":"~","value-format":"yyyy-MM-dd HH:mm:ss","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:function(t){return e.handleDateChange(t,"department")}},model:{value:e.department.queryParams.Date,callback:function(t){e.$set(e.department.queryParams,"Date",t)},expression:"department.queryParams.Date"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleReset("department")}}},[e._v(" 重置 ")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleQuery("department")}}},[e._v(" 搜索 ")]),a("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(t){return e.handleImport("department")}}},[e._v(" 导出 ")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.department.loading,expression:"department.loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},data:e.department.tableData,border:"","tooltip-effect":"dark"},on:{"selection-change":function(t){return e.handleSelectionChange(t,"department")}}},[a("el-table-column",{attrs:{label:"部门名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{color:"#409EFF",cursor:"pointer"},on:{click:function(a){return e.watchDetail(t.row)}}},[e._v(e._s(t.row.department_name))])]}}])}),a("el-table-column",{attrs:{label:"发稿量",align:"center",prop:"num"}}),a("el-table-column",{attrs:{label:"截止昨日点击量",align:"center",prop:"real_view"}})],1)],1),a("el-tab-pane",{attrs:{label:"按人员查看"}},[a("el-form",{ref:"person",attrs:{model:e.person.queryParams,inline:!0}},[a("el-form-item",{attrs:{label:"时间区间:",prop:"Date"}},[a("el-date-picker",{attrs:{type:"daterange",align:"right",size:"small","unlink-panels":"","range-separator":"~","value-format":"yyyy-MM-dd HH:mm:ss","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:function(t){return e.handleDateChange(t,"person")}},model:{value:e.person.queryParams.Date,callback:function(t){e.$set(e.person.queryParams,"Date",t)},expression:"person.queryParams.Date"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleReset("person")}}},[e._v(" 重置 ")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleQuery("person")}}},[e._v(" 搜索 ")]),a("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(t){return e.handleImport("person")}}},[e._v(" 导出 ")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.person.loading,expression:"person.loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},data:e.person.tableData,border:"","tooltip-effect":"dark"},on:{"selection-change":function(t){return e.handleSelectionChange(t,"person")}}},[a("el-table-column",{attrs:{label:"人员",align:"center",prop:"auhtor_name"}}),a("el-table-column",{attrs:{label:"部门名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{color:"#409EFF",cursor:"pointer"}},[e._v(e._s(t.row.department_name))])]}}])}),a("el-table-column",{attrs:{label:"发稿量",align:"center",prop:"num"}}),a("el-table-column",{attrs:{label:"截止昨日点击量",align:"center",prop:"real_view"}})],1)],1)],1)],1)},s=[],o=a("5530"),l=(a("d3b7"),a("159b"),a("b64b"),a("2b19"),a("2b3d"),a("3ca3"),a("ddb0"),a("bc3a")),c=a.n(l),u=a("5c96"),d=a("a18c"),m=a("5041"),p=c.a.create({baseURL:m["e"],timeout:6e4});function h(e){var t="";return Object.keys(e).forEach((function(a){Object.is(e[a],void 0)||Object.is(e[a],null)||Object.is(JSON.stringify(e[a]),"{}")||(t+=encodeURIComponent(a)+"="+encodeURIComponent(e[a])+"&")})),t}function b(e,t,a){return p.post(e,t,{transformRequest:[function(e){return h(e)}],headers:{"Content-Type":"application/x-www-form-urlencoded"},responseType:"blob"}).then((function(e){var t=e,n=new Blob([t]);if("download"in document.createElement("a")){var r=document.createElement("a");r.download=a,r.style.display="none",r.href=URL.createObjectURL(n),document.body.appendChild(r),r.click(),URL.revokeObjectURL(r.href),document.body.removeChild(r)}else navigator.msSaveBlob(n,a)})).catch((function(e){console.error(e)}))}p.interceptors.request.use((function(e){return e.headers.Authorization=sessionStorage.getItem("token"),e}),(function(e){return Object(u["Message"])({showClose:!0,message:e,duration:5e3,type:"error.data.error.message"}),Promise.reject(e.data.error.message)})),p.interceptors.response.use((function(e){return 200==e.data.code||"true"===e.headers.success||e.data instanceof Blob?e.data:(Object(u["Message"])({showClose:!0,message:e.data.msg||decodeURI(e.headers.msg),type:"error"}),e.data.data&&e.data.data.reload&&(sessionStorage.removeItem("token"),d["c"].push("/login")),Promise.reject(e.data.msg))}),(function(e){return Object(u["Message"])({showClose:!0,message:e,type:"error"}),Promise.reject(e)}));var f=p;function g(e){return f({url:"/api/statistics/items/kpiStatistics",method:"post",data:e})}function y(e){return f({url:"/api/statistics/items/kpiStatisticsByAuthor",method:"post",data:e})}function v(e){return f({url:"/api/statistics/items/pageKpiStatistics",method:"post",data:e})}function k(e,t){return b(e,t,"statistics_kpi.xlsx")}var w={data:function(){return{department:{queryParams:{beginTime:"",endTime:"",Date:""},loading:!1,tableData:[],selection:[]},person:{queryParams:{beginTime:"",endTime:"",Date:""},loading:!1,tableData:[],selection:[]}}},computed:{site:function(e){var t,a,n=e.$store.state.user.u_info,r=(null===n||void 0===n||null===(t=n.site)||void 0===t||null===(a=t.extra)||void 0===a?void 0:a.bigdata_settings)||{};return{productId:r.product_id||"",customerId:r.customer_id||""}}},methods:{handleDateChange:function(e,t){var a=e||["",""];this[t].queryParams.beginTime=a[0],this[t].queryParams.endTime=a[1]},handleReset:function(e){this.resetForm(e)},handleQuery:function(e){this["department"===e?"getDepartmentList":"getPersonLists"]()},handleImport:function(){k("/api/statistics/items/kpiStatistics/export",{customerId:this.site.customerId,productId:this.site.productId})},getDepartmentList:function(){var e=this.department;e.loading=!0,e.tableData=[],e.selection=[];var t=Object(o["a"])(Object(o["a"])({},e.queryParams),{},{customerId:this.site.customerId,productId:this.site.productId});delete t.Date,g(this.removePropertyOfNullFor0(t)).then((function(t){e.loading=!1,e.tableData=t.data}))},getPersonLists:function(){var e=this.person;e.loading=!0,e.tableData=[],e.selection=[];var t=Object(o["a"])(Object(o["a"])({},e.queryParams),{},{customerId:this.site.customerId,productId:this.site.productId});delete t.Date,y(this.removePropertyOfNullFor0(t)).then((function(t){e.loading=!1,e.tableData=t.data}))},watchDetail:function(e){this.$emit("watch-detail",e.department_id)}},created:function(){this.getDepartmentList(),this.getPersonLists()}},D=w,P=(a("6363"),a("2877")),_=Object(P["a"])(D,i,s,!1,null,"5895e841",null),I=_.exports,q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"xl-statistics-detail"},[a("el-form",{ref:"queryForm",attrs:{model:e.queryParams,inline:!0}},[a("el-form-item",{attrs:{label:"时间区间:",prop:"dateValue"}},[a("el-date-picker",{attrs:{size:"small",type:"daterange",align:"right","unlink-panels":"","range-separator":"~","value-format":"yyyy-MM-dd HH:mm:ss","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.handleDateChange},model:{value:e.queryParams.dateValue,callback:function(t){e.$set(e.queryParams,"dateValue",t)},expression:"queryParams.dateValue"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.handleReset}},[e._v(" 重置 ")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.handleQuery}},[e._v(" 搜索 ")]),a("el-button",{attrs:{type:"warning",size:"mini"},on:{click:e.handleImport}},[e._v(" 导出 ")]),a("el-button",{attrs:{type:"success",size:"mini"},on:{click:e.handleReturn}},[e._v(" 返回上一级 ")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"header-cell-style":{background:"#eef1f6",color:"#606266"},data:e.tableData,border:"","tooltip-effect":"dark"}},[a("el-table-column",{attrs:{label:"稿件名称",align:"center",prop:"title"}}),a("el-table-column",{attrs:{label:"发稿人",align:"center",prop:"authName"}}),a("el-table-column",{attrs:{label:"原作者",align:"center",prop:"extra.author"}}),a("el-table-column",{attrs:{label:"所属部门",align:"center",prop:"departmentName"}}),a("el-table-column",{attrs:{label:"创建时间",align:"center",prop:"createdAt"}}),a("el-table-column",{attrs:{label:"发稿时间",align:"center",prop:"publishedAt"}}),a("el-table-column",{attrs:{label:"阅读量（真实）",align:"center",prop:"realView"}}),a("el-table-column",{attrs:{label:"阅读量（修正）",align:"center",prop:"baseView"}}),a("el-table-column",{attrs:{label:"链接",align:"center",prop:"link"}})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}})],1)},O=[],j=(a("a9e3"),{props:{id:[Number,String]},data:function(){return{queryParams:{departmentId:this.id,beginTime:"",endTime:"",dateValue:"",pageSize:10,pageNum:1},loading:!1,tableData:[],total:0}},computed:{site:function(e){var t,a,n=e.$store.state.user.u_info,r=(null===n||void 0===n||null===(t=n.site)||void 0===t||null===(a=t.extra)||void 0===a?void 0:a.bigdata_settings)||{};return{productId:r.product_id||"",customerId:r.customer_id||""}}},methods:{handleDateChange:function(e){var t=e||["",""];this.queryParams.beginTime=t[0],this.queryParams.endTime=t[1]},handleReset:function(){Object.assign(this.queryParams,{beginTime:"",endTime:"",page:1}),this.resetForm("queryForm")},handleQuery:function(){this.queryParams.pageNum=1,this.getList()},handleReturn:function(){this.$emit("handleReturn")},handleImport:function(){var e=Object(o["a"])(Object(o["a"])({},this.queryParams),{},{customerId:this.site.customerId,productId:this.site.productId});delete e.dateValue,k("/api/statistics/items/pageKpiStatistics/export",this.removePropertyOfNullFor0(e))},getList:function(){var e=this;this.loading=!0,this.tableData=[];var t=Object(o["a"])(Object(o["a"])({},this.queryParams),{},{customerId:this.site.customerId,productId:this.site.productId});delete t.dateValue,v(this.removePropertyOfNullFor0(t)).then((function(t){e.loading=!1,e.tableData=t.data}))}},created:function(){this.getList()}}),x=j,S=(a("d747"),Object(P["a"])(x,q,O,!1,null,null,null)),R=S.exports,C={name:"Statistics",components:{Lists:I,Detail:R},data:function(){return{exclude:["Detail"],component:"Lists",id:""}},methods:{handleReturn:function(){this.component="Lists"},watchDetail:function(e){this.id=e,this.component="Detail"}}},L=C,z=(a("3908"),Object(P["a"])(L,n,r,!1,null,"2ef53403",null));t["default"]=z.exports},"8ce1":function(e,t,a){},d747:function(e,t,a){"use strict";a("48b0")},ed88:function(e,t,a){}}]);